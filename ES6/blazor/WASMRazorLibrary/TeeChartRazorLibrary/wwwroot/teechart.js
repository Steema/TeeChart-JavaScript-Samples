import{DateFormat}from"./date.format.js";
/**
 * @preserve TeeChart(tm) for JavaScript(tm)
 * @fileOverview TeeChart for JavaScript(tm)
 * v2.8 Mar 2022 2022.04.01.2.8
 * Copyright(c) 2012-2022 by Steema Software SL. All Rights Reserved.
 * http://www.steema.com
 *
 * Licensed with commercial and non-commercial attributes,
 * specifically: http://www.steema.com/licensing/html5
 *
 * JavaScript is a trademark of Oracle Corporation.
 */class Point{constructor(t,i){this.x=t;this.y=i}static Point(t,i){return new Point(t,i)}static pointInLine(t,i,s,e){return t.x==i.x&&t.y==i.y||t.x==s.x&&t.y==s.y||Math.abs(function(){var e,r;if(s.x==i.x&&s.y==i.y){e=t.x-i.x;r=t.y-i.y}else{e=s.x-i.x;r=s.y-i.y;var h=((t.x-i.x)*e+(t.y-i.y)*r)/(e*e+r*r);if(h<0){e=t.x-i.x;r=t.y-i.y}else if(h>1){e=t.x-s.x;r=t.y-s.y}else{e=t.x-(i.x+h*e);r=t.y-(i.y+h*r)}}return Math.sqrt(e*e+r*r)}())<=e+1}}class Rectangle{constructor(t,i,s,e){this.x=t;this.y=i;this.width=s;this.height=e}set(t,i,s,e){this.x=t;this.y=i;this.width=s;this.height=e}setFrom(t){this.x=t.x;this.y=t.y;this.width=t.width;this.height=t.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setTop(t){this.height-=t-this.y;this.y=t}setBottom(t){this.height=t-this.y}setLeft(t){this.width-=t-this.x;this.x=t}setRight(t){this.width=t-this.x}contains(t){return t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height}offset(t,i){this.x+=t;this.y+=i}static Rectangle(t,i,s,e){return new Rectangle(t,i,s,e)}}class Margins{constructor(){this.left=this.right=this.top=this.bottom=2}apply(t){var i=t.width,s=t.height;t.x+=i*this.left*.01;t.width-=i*Math.min(100,this.left+this.right)*.01;t.y+=s*this.top*.01;t.height-=s*Math.min(100,this.top+this.bottom)*.01}}class Tool{constructor(t){this.chart=t;this.active=!0}mousedown(){}mousemove(){}mouseout(){}clicked(){return!1}draw(){}}class Animation extends Tool{constructor(t,i){super(t);this.active=!0;this.mode="linear";this.duration=500;this.items=[];this.autoDraw=!0;this.loop=!1;this.running=!1;this.onstart=null;this.onstop=null;this.onstep=i;if(t)if(t instanceof Chart)this.chart=t;else if(t instanceof Animation){this.chart=t.chart;t.items.push(this)}}_dostart(){this.init=(new Date).getTime();this.start();for(var t,i=0;t=this.items[i++];)if(t.active){t.chart=this.chart;t.start()}this.chart.draw();requestAnimationFrame(this.step.bind(this))}animate(t){if(!this.running){this.running=!0;t&&(this.chart=t);this._dostart()}}start(){this.onstart&&this.onstart()}stop(){this.onstop&&this.onstop()}doStep(t){this.onstep&&this.onstep(t)}step(){var t,i,s=((new Date).getTime()-this.init)/this.duration,e="linear"==this.mode?s:Math.pow(2,10*(s-1));if(e>=0&&e<1){if(this.running){this.doStep(e);for(t=0;i=this.items[t++];)if(i.active){i.chart=this.chart;i.doStep(e)}this.autoDraw&&this.chart.draw();requestAnimationFrame(this.step.bind(this))}}else{this.stop();for(t=0;i=this.items[t++];)if(i.active){i.chart=this.chart;i.stop()}this.onstop&&this.onstop();if(this.loop)this._dostart();else{this.running=!1;this.chart.draw()}}}}class AnimateHover{constructor(t,i,s){this.format=s;this.bounds=i;var e=this,r=s.shadow;this.old=new Shadow;this.old.set(r);r.visible=!0;r.color="rgba(0,255,0,0.1)";r.blur=10;r.width=0;r.height=0;this.enabled=!0;var h=new Animation(s.chart,(function(t){e.enabled&&(t<1?e.format.shadow.color="rgba(0,255,0,"+t.toString()+")":e.autoHide&&e.restore())}));h.duration=t;h.animate()}restore(){this.format.shadow.set(this.old);this.enabled=!1}}class Gradient{constructor(t){this.chart=t;this.visible=!1;this.colors=["white","silver"];this.direction="topbottom";this.stops=null;this.offset={x:0,y:0}}create(t,i){return this.rect(t.x,t.y,t.width,t.height,i)}rect(t,i,s,e,r){var h,a=this.chart.ctx,o=a.createLinearGradient;if("topbottom"==this.direction)h=o.call(a,t,i,t,i+e);else if("bottomtop"==this.direction)h=o.call(a,t,i+e,t,i);else if("leftright"==this.direction)h=o.call(a,t,i,t+s,i);else if("rightleft"==this.direction)h=o.call(a,t+s,i,t,i);else if("radial"==this.direction){var n=t+.5*s+this.offset.x,l=i+.5*e+this.offset.y,c=Math.max(s,e);h=a.createRadialGradient(n,l,0,n,l,c)}else h="diagonalup"==this.direction?o.call(a,t,i+e,t+s,i):o.call(a,t,i,t+s,i+e);r&&this.setEndColor(r);var d,u=this.colors,m=u.length,f=this.stops,g=f?f.length:0;if(m>1)for(d=0;d<m;d++)h.addColorStop(g<=d?d/(m-1):f[d],u[d]);else h.addColorStop(0,m>0?u[0]:"white");return h}setEndColor(t){if(t&&""!==t)for(var i=1,s=this.colors.length;i<s;i++)this.colors[i]=t}}class Shadow{constructor(t){this.chart=t;this.visible=!1;this.blur=4;this.color="rgba(80,80,80,0.75)";this.width=4;this.height=4}prepare(t){if(this.visible){t.shadowBlur=this.blur;t.shadowColor=this.color;t.shadowOffsetX=this.width;t.shadowOffsetY=this.chart.isAndroid?-this.height:this.height}else t.shadowColor="transparent"}set(t){this.visible=t.visible;this.color=t.color;this.blur=t.blur;this.width=t.width;this.height=t.height}}class ChartImage{constructor(t){this.url="";this.repeat="no-repeat";this.backFill=!1;this.chart=t;this.visible=!0}tryDraw(t,i,s,e){if(!this.image){this.image=new Image;this.image.onload=()=>{this.chart.draw()}}if(""===this.image.src)this.image.src=this.url;else if(this.chart.ctx.drawImage)if("repeat"==this.repeat){var r=this.chart.ctx.createPattern(this.image,"repeat");this.chart.ctx.fillStyle=r;this.chart.ctx.fillRect(t,i,s,e)}else this.chart.ctx.drawImage(this.image,t,i,s,e)}}class Stroke{constructor(t){this.chart=t;this.fill="black";this.size=1;this.join="round";this.cap="square";this.dash=null;this._g=null;this._g=this.gradient=new Gradient(t)}prepare(t,i){i=i||this.chart.ctx;var s=this._g;i.strokeStyle=s&&s.visible?s.create(this.chart.bounds):t||this.fill;i.lineWidth=this.size;i.lineJoin=this.join;i.lineCap=this.cap;i.shadowColor="transparent";i.setLineDash?i.setLineDash(this.dash||[]):i.mozCurrentTransform?i.mozDash=this.dash:this.chart.isChrome&&(i.webkitLineDash=this.dash)}setChart(t){this.chart=t;this._g&&(this._g.chart=t)}}class Font{constructor(t){this.chart=t;this.style="11px Tahoma";this._g=null;this._g=this.gradient=new Gradient(t);this.fill="black";this._sh=null;this._sh=this.shadow=new Shadow(t);this._s=null;this._s=this.stroke=new Stroke(t);this._s.fill="";this.textAlign="center";this.baseLine="alphabetic"}getSize(){var t,i,s=this.style.split(" ");for(t=0;t<s.length;t++)if(i=parseFloat(s[t]))return i;return 20}setSize(t){var i,s="",e=this.style.split(" ");for(i=0;i<e.length;i++)parseFloat(e[i])?s+=t.toString()+"px ":s+=e[i]+" ";this.style=s}prepare(){var t=this.chart.ctx;t.textAlign=this.textAlign;t.textBaseline=this.baseLine;this._sh&&this._sh.prepare(t);t.font!=this.style&&(t.font=this.style)}setChart(t){this.chart=t;this._g&&(this._g.chart=t);this._sh&&(this._sh.chart=t);this._s&&this._s.setChart(t)}}function dashedLine(t,i,s,e,r,h){h||(h=[10,5]);t.save();var a=e-i,o=r-s,n=Math.sqrt(a*a+o*o),l=Math.atan2(o,a);t.translate(i,s);t.moveTo(0,0);t.rotate(l);var c=h.length,d=0,u=!0;i=0;for(;n>i;){(i+=h[d++%c])>n&&(i=n);u?t.lineTo(i,0):t.moveTo(i,0);u=!u}t.restore()}class Format{constructor(t){this.chart=t;this.gradient=new Gradient(t);this.fill="rgb(200,200,200)";this.stroke=new Stroke(t);this.round={x:0,y:0};this.transparency=0;this.doSuperNums=!1;this.doSubNums=!1;this.font=new Font(t);this.image=new ChartImage(this.chart);this.shadow=new Shadow(t)}roundRect(t,i,s,e,r){if(t.roundRect)t.roundRect(i,s,e,r,this.round.x,this.round.y);else{var h=i+e,a=s+r,o=this.round.x,n=this.round.y,l=this.round.corners;r<0&&(a=(s=a)-r);e<0&&(h=(i=h)-e);2*o>e&&(o=.5*e);2*n>r&&(n=.5*r);!l||l[0]?t.moveTo(i+o,s):t.moveTo(i,s);if(!l||l[1]){t.lineTo(h-o,s);t.quadraticCurveTo(h,s,h,s+n)}else t.lineTo(h,s);if(!l||l[2]){t.lineTo(h,a-n);t.quadraticCurveTo(h,a,h-o,a)}else t.lineTo(h,a);if(!l||l[3]){t.lineTo(i+o,a);t.quadraticCurveTo(i,a,i,a-n)}else t.lineTo(i,a);if(!l||l[0]){t.lineTo(i,s+n);t.quadraticCurveTo(i,s,i+o,s)}else t.lineTo(i,s);t.closePath()}}textHeight(){return 1.3*this.font.getSize()}textWidth(t){return this.chart.ctx.measureText(t).width}fillBack(t,i,s,e,r,h){if(this.gradient.visible){t.fillStyle=i?this.gradient.create(i()):this.gradient.rect(s,e,r,h);t.fill()}else if(""!==this.fill){t.fillStyle=this.fill;t.fill()}}draw(t,i,s,e,r,h){var a,o=this.image;if("object"==typeof s){e=s.y;r=s.width;h=s.height;s=s.x}if(this.transparency>0){a=t.globalAlpha;t.globalAlpha=(1-this.transparency)*a}this.shadow.prepare(t);if(o&&o.visible&&""!==o.url){t.save();t.clip();1==o.backFill&&this.fillBack(t,i,s,e,r,h);if(i){var n=i();o.tryDraw(n.x,n.y,n.width,n.height)}else o.tryDraw(s,e,r,h);t.restore()}else this.fillBack(t,i,s,e,r,h);if(""!==this.stroke.fill){this.stroke.prepare();t.stroke()}this.transparency>0&&(t.globalAlpha=a)}subNums(t){for(var i="",s=0;s<t.length;s++){var e=t.charCodeAt(s);i+=e>=48&&e<=57?String.fromCharCode(e+8272):t[s]}return i}superNums(t){for(var i="",s=0;s<t.length;s++){var e=t.charCodeAt(s);i+=48==e||e>=52&&e<=57?String.fromCharCode(e+8256):49==e?String.fromCharCode(185):50==e?String.fromCharCode(178):51==e?String.fromCharCode(179):t[s]}return i}drawText(t,i){var s=this.font._g,e=this.chart.ctx,r=this.font._s,h=this.font.textAlign,a=t.x,o=t.y;function n(t){e.fillText(t,a,o);if(r&&""!==r.fill){r.prepare();e.strokeText(t,a,o)}}e.fillStyle=s&&s.visible&&t?s.create(t):this.font.fill;"center"==h?a+=.5*t.width:"right"!=h&&"end"!=h||(a+=t.width);var l=(i+"").split("\n"),c=l.length;if(c>1)for(var d=this.textHeight(l[0]),u=0;u<c;u++){this.doSuperNums?n(this.superNums(l[u])):this.doSubNums?n(this.subNums(l[u])):n(l[u]);o+=d}else this.doSuperNums?n(this.superNums(i)):this.doSubNums?n(this.subNums(i)):n(i)}rectangle(t,i,s,e){if(this.transparency<1)if("object"==typeof t)this.rectangle(t.x,t.y,t.width,t.height);else{this.rectPath(t,i,s,e);this.draw(this.chart.ctx,null,t,i,s,e)}}polygonBounds(t,i){var s,e,r=0,h=0,a=0,o=0,n=t.length;if(n>0){r=a=t[0].x;h=o=t[0].y;for(e=1;e<n;e++){(s=t[e].x)<r?r=s:s>a&&(a=s);(s=t[e].y)<h?h=s:s>o&&(o=s)}}i.x=r;i.y=h;i.width=a-r;i.height=o-h}polygon(t){var i,s=new Rectangle,e=this.chart.ctx,r=t.length;e.beginPath();e.moveTo(t[0].x,t[0].y);for(i=1;i<r;i++)e.lineTo(t[i].x,t[i].y);e.closePath();var h=this;this.draw(e,(function(){h.polygonBounds(t,s);return s}))}ellipsePath(t,i,s,e,r){if(this.chart.__webgl){t.z=this.z;t.depth=this.depth;t.ellipsePath(i,s,e,r)}else{t.save();t.translate(i,s);t.scale(.5*e,.5*r);t.beginPath();t.arc(0,0,1,0,2*Math.PI,!1);t.restore()}}ellipse(t,i,s,e){var r=this.chart.ctx;this.ellipsePath(r,t,i,s,e);this.draw(r,null,t-.5*s,i-.5*e,s,e)}sphere(t,i,s,e){if(this.chart.__webgl){var r=this.chart.ctx;r.depth=this.depth;r.z=this.z;this.gradient.visible&&(r.fillStyle=this.gradient.colors[this.gradient.colors.length-1]);r.sphere(t,i,s,e)}else this.ellipse(t,i,s,e)}cylinder(t,i,s,e){if(this.chart.__webgl){var r=this.chart.ctx;r.depth=this.depth;r.z=this.z;r.image=this.image;r.cylinder(t,i,s,e)}else if(1==i)this.cube(t);else{var h=t.width,a=t.height;s?this.polygon([new Point(t.x+.5*h,t.y),new Point(t.x,t.y+a),new Point(t.x+h,t.y+a)]):this.polygon([new Point(t.x+h,t.y+.5*a),new Point(t.x,t.y),new Point(t.x,t.y+a)])}}cube(t){var i,s,e,r=this.chart.aspect,h=r.view3d,a=0,o=0;if(h){if(this.chart.__webgl){var n=this.chart.ctx;n.depth=this.depth;n.z=this.z;n.cube(t,this.round.x);return}var l=this.z,c=this.depth;a=l*r._orthox,o=-l*r._orthoy;i=t.x+t.width;s=t.y+t.height;var d=c*r._orthox,u=-c*r._orthoy;e=this.shadow.visible;this.shadow.visible=!1;var m=i+d,f=t.y+u;if(c>0){this.polygon([{x:i,y:t.y},{x:m,y:f},{x:m,y:s+u},{x:i,y:s}]);t.width>0&&this.polygon([{x:t.x,y:t.y},{x:t.x+d,y:f},{x:m,y:f},{x:i,y:t.y}])}}this.rectPath(t.x+a,t.y+o,t.width,t.height);h&&(this.shadow.visible=e)}rectPath(t,i,s,e){var r=this.chart.ctx;r.beginPath();this.round.x>0&&this.round.y>0?this.roundRect(r,t,i,s,e):r.rect(t,i,s,e)}setChart(t){this.chart=t;this.shadow.chart=t;this.gradient.chart=t;this.font.setChart(t);this.image&&(this.image.chart=t);this.stroke.setChart(t)}}class Annotation extends Tool{constructor(t,i,s,e){super(t);this.position=new Point(s||10,e||10);this.margins=new Margins;this.items=[];this.bounds=new Rectangle;this.visible=!0;this.transparent=!1;this.text=i||"";this.isDom=!1;this.domElement=null;this.domStyle="border-radius: 5px;border: 2px solid #faad44;background: #FFF;padding:5px;";this.format=new Format(t);this.format.font.textAlign="center";this.format.font.baseLine="top";this.format.fill="beige";this.format.round={x:4,y:4};this.format.stroke.fill="silver";this.format.shadow.visible=!0;this.format.depth=.05;this.format.z=.5;this.fontH,this.thisH,this.over}getDOMHeight(){return null==this.domElement?0:this.domElement.offsetHeight}getDOMWidth(){return null==this.domElement?0:this.domElement.offsetWidth}moveTo(t,i){this.position.x=t;this.position.y=i;this.resize()}isEmpty(t){return!t||0===t.length}shouldDraw(){return this.visible&&!this.isEmpty(this.text)}resize(){if(!this.isEmpty(this.text)){this.format.font.prepare();this.rows=this.text.split("\n");this.fontH=this.format.textHeight(this.text);var t=this.rows.length;this.thisH=this.fontH*t+this.margins.top;var i,s=this.thisH+this.margins.bottom;if(t>1){i=0;for(;t--;)i=Math.max(i,this.format.textWidth(this.rows[t]+"W"))}else i=this.format.textWidth(this.text+"W");i+=this.margins.left+this.margins.right;var e=this.position;e.y,this.thisH;this.bounds.set(e.x,e.y,i,s)}}add(t){var i=new Annotation(this.chart,t);this.items.push(i);i.transparent=!0;return i}doDraw(){if(!this.isEmpty(this.text))if(this.isDom)this.drawDOMText();else{if(this.transparent)this.chart.ctx.z=this.format.z;else if(this.chart.aspect.view3d&&this.format.depth>0){var t=this.format.z;this.format.z-=.5*this.format.depth;this.format.cube(this.bounds);this.format.draw(this.chart.ctx,null,b);this.format.z=t}else{this.chart.ctx.z=this.format.z;this.format.rectangle(this.bounds)}var i,s=this.format.transparency,e=this.chart?this.chart.ctx:null;if(s>0){i=e.globalAlpha;e.globalAlpha=(1-s)*i}this.format.font.prepare();this.bounds.y+=this.margins.top+.1*this.fontH;this.bounds.x+=this.margins.left;var r=this.bounds.width;this.bounds.width-=this.margins.right;this.format.drawText(this.bounds,this.text);this.bounds.x=this.position.x;this.bounds.y=this.position.y;this.bounds.width=r;s>0&&(e.globalAlpha=i)}}clicked(t){return this.visible&&this.bounds.contains(t)}doMouseMove(t){this.mouseinside=this.clicked(t);if(this.mouseinside){this.cursor&&(this.chart.newCursor=this.cursor);this.wasinside||(over=new AnimateHover(250,this.bounds,this.format))}else if(this.wasinside){over.restore();this.chart.draw()}this.wasinside=this.mouseinside}mousemove(t){this.cursor&&"default"!=this.cursor&&this.doMouseMove(t)}forceDraw(){this.resize();this.doDraw()}setChart(t){this.chart=t;this.format.setChart(t)}drawDOMText(){this.domElement&&this.resize();var t=this.chart.canvas.getBoundingClientRect(),i=this.transparent?"opacity:0;":"opacity:1;";if(!this.domElement){this.domElement=document.createElement("div");document.body.appendChild(this.domElement)}this.chart.canvas.setAttribute("style","z-index:1;");0==this.visible?this.domElement.setAttribute("style","visibility:hidden; position:absolute;top:"+(this.position.y+t.top)+"px;left:"+(this.position.x+t.left)+"px;display:block;z-index:10000;"+this.domStyle+i):this.domElement.setAttribute("style","visibility:visible; position:absolute;top:"+(this.position.y+t.top)+"px;left:"+(this.position.x+t.left)+"px;display:block;z-index:10000;"+this.domStyle+i);this.domElement.innerHTML!=this.text&&(this.domElement.innerHTML=this.text)}draw(){this.isDom?this.drawDOMText():this.visible&&this.forceDraw()}}class DragTool extends Tool{constructor(t){super(t);this.series=null;this.target={series:null,index:-1};this._point=new Point(0,0)}clicked(){this.target.series=null;this.target.index=-1}setPoint(t){this._point=t}getPoint(){return _point}mousedown(t){var i,s=this.chart.series.items,e=s.length;this.chart.calcMouse(t,this._point);this.target.series=null;this.target.index=-1;if(this.series&&this.series.visible){this.target.index=this.series.clicked(p);-1!=this.target.index&&(this.target.series=this.series)}else for(i=0;i<e;i++)if(s[i].visible){this.target.index=s[i].clicked(this._point);if(-1!=this.target.index){this.target.series=s[i];break}}return-1!=this.target.index}mousemove(t){if(-1!=this.target.index){var i=this.target.series,s=i.mandatoryAxis.fromPos(i.yMandatory?t.y:t.x);this.onchanging&&(s=this.onchanging(this,s));i.data.values[this.target.index]=s;this.onchanged&&this.onchanged(this,s);this.chart.draw()}}}class CursorTool extends Tool{constructor(t){super(t);this.direction="both";this.size=new Point(0,0);this.followMouse=!0;this.dragging=-1;this.format=new Format(t);this.horizAxis=t?t.axes.bottom:null;this.vertAxis=t?t.axes.left:null;this.old,this.r=new Rectangle;this.pp=new Point(0,0);this.render="copy";this.canvasCopy;this.ctxCopy}over(t){var i=-1;if(this.r.contains(t)){var s=Math.abs(this.old.x-t.x)<3,e=Math.abs(this.old.y-t.y)<3,r=this.direction;"both"==r&&s&&e?i=0:!s||"both"!=r&&"vertical"!=r?!e||"both"!=r&&"horizontal"!=r||(i=2):i=1}return i}calcRect(){var t=this.chart.chartRect,i=this.horizAxis,s=this.vertAxis;this.r.x=i?i.startPos:t.x;this.r.width=i?i.endPos-this.r.x:t.width;this.r.y=s?s.startPos:t.y;this.r.height=s?s.endPos-this.r.y:t.height}mousedown(t){this.chart.calcMouse(t,pp);this.dragging=this.followMouse?-1:this.over(pp);return this.dragging>-1}clicked(){this.dragging=-1}mousemove(t){var i=this.dragging,s=this.followMouse;if(s||i>-1){this.old||(this.old=new Point);if(this.old.x!=t.x||this.old.y!=t.y){this.calcRect();if(this.r.contains(t)){(s||0===i||1===i)&&(this.old.x=t.x);(s||0===i||2===i)&&(this.old.y=t.y);if("full"==this.render)this.chart.draw();else{if(this.canvasCopy)if("copy"==this.render)this.chart.ctx.drawImage(this.canvasCopy,0,0);else{var e=this.chart.bounds;this.ctxCopy.clearRect(e.x,e.y,e.width,e.height)}this.dodraw("copy"==this.render?this.chart.ctx:this.ctxCopy)}this.onchange&&this.onchange(t);return}}}var r=this.over(t);this.old&&r>-1?this.chart.newCursor=0===r?"move":1===r?"e-resize":"n-resize":this.chart.newCursor="default"}setRender(t){this.render=t;if(this.canvasCopy){this.resetCopy();this.chart.draw()}}resetCopy(){var t=this.chart.canvas;if("layer"==this.render){this.canvasCopy.style.position="absolute";t.parentNode.appendChild(canvasCopy);cthis.anvasCopy.setAttribute("left",t.offsetLeft+"px");canvasCopy.setAttribute("top",t.offsetTop+"px");this.canvasCopy.style.left=t.offsetLeft;this.canvasCopy.style.top=t.offsetTop;this.canvasCopy.style.zIndex=10;this.canvasCopy.style.pointerEvents="none"}else this.canvasCopy.parentNode&&this.canvasCopy.parentNode.removeChild(canvasCopy)}draw(){if("full"==this.render)this.dodraw(this.chart.ctx);else{if(!this.canvasCopy){this.canvasCopy=this.chart.canvas.cloneNode();this.resetCopy();this.ctxCopy=this.canvasCopy.getContext("2d")}if("copy"==this.render){this.ctxCopy.drawImage(this.chart.canvas,0,0);this.dodraw(this.chart.ctx)}else this.dodraw(this.ctxCopy)}}dodraw(t){var i,s=this.direction,e="both"==s;this.calcRect();this.old||(this.old=new Point(this.r.x+.5*this.r.width,this.r.y+.5*this.r.height));t.beginPath();if(e||"vertical"==s){i=.5*this.size.y;t.moveTo(this.old.x,0===i?this.r.y:this.old.y-i);t.lineTo(this.old.x,0===i?this.r.y+this.r.height:this.old.y+i)}if(e||"horizontal"==s){i=.5*this.size.x;t.moveTo(0===i?this.r.x:this.old.x-i,this.old.y);t.lineTo(0===i?this.r.x+this.r.width:this.old.x+i,this.old.y)}this.format.stroke.prepare(this.format.stroke.fill,t);t.stroke()}}class ToolTip extends Annotation{constructor(t){super(t);this.pointer={fill:"Green",firstCircleRadius:"2",secondCircleRadius:"5",visible:!1,firstCircleOpacity:"1",secondCircleOpacity:"0.4",animationVisible:!0,animationDuration:200};this.visible=!1;this.findPoint=!1;this.currentSeries=null;this.currentIndex=-1;this.timID=null;this.autoHide=!1;this.delay=1e3;this.animated=100;this.autoRedraw=!0;this.render="dom";this.domStyle="padding:5px; margin-left:5px; background-color:#666; border-radius:4px 4px; color:#FFF; z-index:1000;";this.o=null}hide(){var t="dom"===this.render;if(this.visible||t){this.onhide&&this.onhide(this);this.visible=!1;this.autoRedraw&&(t?DOMTip.hide():this.chart.draw());this.currentIndex=-1;this.currentSeries=null}}redraw(t){t&&t[0].hide()}mousemove(t){var i=this.chart.series,s=i.count(),e=null,r=-1;if(this.chart.chartRect.contains(t))for(var h=s-1;h>=0;h--){var a=i.items[h];if(a.visible){if(-1==(r=a.clicked(t))&&a.continuous){r=Math.round(this.chart.axes.bottom.fromSizeCalcIndex(t.x-this.chart.axes.bottom.startPos));for(var o,n,l=0;l<s;l++){o=Math.abs(i.items[l].data.values[r]-this.chart.axes.left.fromPos(t.y));if(0==l){n=o;a=i.items[l]}else o<n&&(a=i.items[l])}}if(-1!=r){e=a;break}}}else r=-1;if(-1==r){this.hide();this.currentIndex=-1;this.currentSeries=null}else if(r!=this.currentIndex||e!=this.currentSeries){this.currentIndex=r;this.currentSeries=e;if(e){this.refresh(e,r);if(this.autoHide&&this.delay>0){clearTimeout(this.timID);this.timID=window.setTimeout(this.redraw,this.delay,[this])}}}}step(){function t(t){o.moveTo(o.oldX+t*o.deltaX,o.oldY+t*o.deltaY);o.autoRedraw&&o.chart.draw()}var i=((new Date).getTime()-o.init)/o.animated;if(i<1){t(i);window.requestAnimationFrame(step,o)}else t(1)}refresh(t,i){var s="dom"===this.render;this.visible=!s;this.text=t.markText(i);this.ongettext&&(this.text=this.ongettext(this,this.text,t,i));if(""!==this.text){this.resize();var e=new Point;t.calc(i,e);e.x-=.5*this.bounds.width;e.y-=1.5*this.bounds.height;e.x<0&&(e.x=0);e.y<0&&(e.y=0);if(s||this.autoHide||!(this.animated>0)||isNaN(this.position.x)||isNaN(this.position.y)){this.moveTo(e.x,e.y);this.autoRedraw&&(s?DOMTip.show(this.text,"auto",this.chart.canvas,this.domStyle,this):this.chart.draw())}else{this.oldX=this.position.x;this.oldY=this.position.y;this.deltaX=e.x-this.oldX;this.deltaY=e.y-this.oldY;this.init=(new Date).getTime();o=this;window.requestAnimationFrame(step,this)}this.onshow&&this.onshow(this,t,i)}}}class Tools{constructor(t){this.chart=t;this.items=[]}draw(){for(var t,i=0;t=this.items[i++];)t.active&&t.draw()}mousemove(t){for(var i,s=0;i=this.items[s++];)i.active&&i.mousemove(t)}mousedown(t){for(var i,s=0,e=!1;i=this.items[s++];)i.active&&i.mousedown(t)&&(e=!0);return e}mouseout(){for(var t,i=0;t=this.items[i++];)t.active&&t.mouseout()}clicked(t){for(var i,s=this.items.length,e=!1;i=this.items[--s];)if(i.active&&i.clicked(t)){e=!0;i.onclick&&(e=i.onclick(i,t.x,t.y))}return e}add(t){this.items.push(t);return t}}class Palette{constructor(t){this.colors=t}static RainbowPalette(){return["#FF0000","#FF7F00","#FFFF00","#00FF00","#0000FF","#6600FF","#8B00FF"]}get(t){return this.colors[-1==t?0:t%this.colors.length]}}class Zoom{constructor(t){this.chart=t;this.active=!1;this.enabled=!0;this.done=!1;this.direction="both";this.keepAspect=!1;this.mouseButton=0;this.wheel={enabled:!1,factor:1};this.format=new Format(t);this.format.fill="rgba(255,255,255,0.5)";this.format.stroke.fill="darkgray";this.format.stroke.size=2;this.old=new Point;this.r=new Rectangle}change(t){this.old||(this.old=new Point);var i=this.chart.oldPos;this.old.x=t.x-i.x;if(this.keepAspect){var s=this.chart.chartRect;this.old.y=this.old.x*(s.height/s.width)}else this.old.y=t.y-i.y}check(t){var i=t.chart.chartRect,s=t.direction,e="both"===s;this.r.set(i.x,i.y,i.width,i.height);if(t.old){if(e||"horizontal"===s)if(t.old.x<0){this.r.x=t.chart.oldPos.x+t.old.x;this.r.width=-t.old.x}else{this.r.x=t.chart.oldPos.x;this.r.width=t.old.x}if(e||"vertical"===s)if(t.old.y<0){this.r.y=t.chart.oldPos.y+t.old.y;this.r.height=-t.old.y}else{this.r.y=t.chart.oldPos.y;this.r.height=t.old.y}}return this.r}draw(){this.format.rectangle(this.check(this))}apply(){if(this.old.x<0||this.old.y<0){this.reset();this.onreset&&this.onreset()}else{this.check(this);if(this.r.width>3&&this.r.height>3){var t=this.direction,i="both"===t,s=this.r.x+this.r.width,e=this.r.y+this.r.height,r=this.r.x,h=this.r.y;this.chart.axes.each((function(){this.horizontal?(i||"horizontal"===t)&&this.calcMinMax(r,s):(i||"vertical"===t)&&this.calcMinMax(e,h)}));return!0}}return!1}reset(){this.chart.axes.each((function(){this.automatic=!0}))}}class Scroll{constructor(t){this.chart=t;this.active=!1;this.enabled=!0;this.done=!1;this.mouseButton=2;this.direction="both";this.position=new Point(0,0)}}class ChartTitle extends Annotation{constructor(t,i){super(t);this.transparent=!0;this._expand=!1;this._expand=this.expand=!1;this.f=this.format.font,this.s=this.f.shadow,this.p=this.position;this.s.visible=!0;this.s.width=2;this.s.height=2;this.s.blur=8;this.f.style="18px Tahoma";this.f.fill=i;this.padding=4}calcRect(t){this.resize();var i=this.transparent?1:2,s=this.bounds,e=s.height+i*this.padding,r=this.chart.chartRect;if(t){this.p.y=r.y;r.automatic&&r.setTop(r.y+e)}else{this.p.y=r.y+r.height-s.height-this.padding;r.automatic&&(r.height-=e)}r.height<0&&(r.height=0);this.p.x=.5*(this.chart.canvas.width-s.width)}tryDraw(t){if(this.shouldDraw()){this.calcRect(t);var i=this.bounds,s=this.chart.ctx,e=s.beginParent;this.visual=e?s.beginParent():null;if(this._expand){var r=chart.panel.format;p.x=""!==r.stroke.fill?r.stroke.size:0;p.y=t?p.x:chart.canvas.height-(r.shadow.visible?r.shadow.height:0)-p.x-i.height;i.width=chart.canvas.width-(r.shadow.visible?r.shadow.width:0)-2*p.x;var h=this.format;h.round.x=r.round.x;h.round.y=r.round.y;h.round.corners=[t,t,!t,!t];h.stroke.fill="";this.transparent=!1}i.x=this.p.x;i.y=this.p.y;this.doDraw();e&&s.endParent()}}}class Panel{constructor(t){this.chart=t;this.f=this.format=new Format(this.chart);this.f.round.x=12;this.f.round.y=12;this.f.stroke.size=3;this.f.gradient.visible=!0;this.f.gradient.direction="bottomtop";this.f.shadow.visible=!0;this.f.stroke.fill="#606060";this.transparent=!!this.chart.__webgl;this.margins=new Margins}clear(){var t=this.chart.bounds;this.chart.ctx.clearRect(t.x,t.y,t.width,t.height)}draw(){if(this.transparent||this.chart.__webgl)this.clear();else{var t=this.chart.chartRect,i=this.f.shadow;if(i.visible){t.width-=.5*Math.abs(i.width)+2;t.height-=.5*Math.abs(i.height)+2;i.width<0&&(t.x-=i.width);i.height<0&&(t.y-=i.height)}var s=0;if(""!==this.f.stroke.fill&&(s=this.f.stroke.size)>1){s*=.5;t.x+=s;t.y+=s;t.width-=2*s;t.height-=2*s}(i.visible||this.f.round.x>0||this.f.round.y>0)&&this.clear();this.f.rectangle(t);if(s>0){t.x+=s;t.y+=s;t.width-=2*s;t.height-=2*s}}}}class Wall{constructor(t){this.chart=t;this.format=new Format(t);this.format.fill="#E6E6E6";this.format.stroke.fill="black";this.format.z=0;this.format.depth=0;this.visible=!0;this.bounds=new Rectangle;this.size=0}draw(){this.format.cube(this.bounds);this.format.draw(this.chart.ctx,null,this.bounds)}}function trunc(t){return 0|t}class Labels{constructor(t,i){this.chart=t;this.axis=i;this.format=new Format(t);this.decimals=2;this.fixedDecimals=!1;this.padding=4;this.separation=10;this.visible=!0;this.rotation=0;this.alternate=!1;this.maxWidth=0;this.wordWrap="no";this.roundFirst=!0;this.labelStyle="auto";this.dateFormat="shortDate"}checkStyle(){var t=this.labelStyle,i=this.axis.firstSeries;this._text=null;this._textlabels=null;"auto"==t?i.data.labels.length>0&&i.associatedToAxis(this.axis)&&this.axis.horizontal==i.notmandatory.horizontal&&(this._text=i):"mark"!=t&&"text"!=t||(this._text=i)}formatValueString(t){if(this.valueFormat){var i=Number("1.2").toLocaleString().substr(1,1),s=(1*t).toLocaleString(),e=String(s).split(i),r=e[0],h="";if(this.decimals>0)for(var a=0;a<this.decimals;a++)h+="0";var o=e.length>1?e[1]:"";return(o=(o+h).substr(0,this.decimals)).length>0?r+i+o:r}return t.toFixed(this.decimals)}getLabel(t){var i,s,e=trunc(t);if(this._text&&e==t){(s=this._text.data).x&&(e=s.x.indexOf(e));var r,h,a=this.chart.series.items;if(!(i=a.length>0&&a[0]instanceof Bar&&"sideAll"==a[0].stacked?s.labels[t]:s.labels[e])){for(r=0;(h=a[r++])&&!(h!=this._text&&h.visible&&h.associatedToAxis(this.axis)&&(i=h.data.labels[e])););void 0===i&&(i="")}}else i=this.axis.dateTime?DateFormat.format?DateFormat.format(new Date(t),this.dateFormat):new Date(t).toDateString():this.formatValueString(t);if(this.ongetlabel){i=this.ongetlabel(t,i);this.format.font.prepare()}return""+i}width(t){var i=this.fixedDecimals;this.fixedDecimals=!0;var s=this.format.textWidth(this.getLabel(t));this.fixedDecimals=i;return s}}class Grid{constructor(t){this.chart=t;this.f=this.format=new Format(t);this.f.stroke.fill="silver";this.f.stroke.cap="butt";this.f.fill="";this.visible=!0;this.lineDash=!1}}class Ticks{constructor(t){this.chart=t;this.stroke=new Stroke(t);this.stroke.cap="butt";this.visible=!0;this.length=4}}class AxisTitle extends Annotation{constructor(t){super(t);this.padding=4;this.transparent=!0;this.rotation=0;this.format.font.textAlign="center"}drawIt(t,i,s,e){this.format.font.textAlign=t;if(0===e){this.position.x=i;this.position.y=s;this.forceDraw()}else{var r=this.chart.ctx;r.save();r.translate(i,s);r.rotate(-e*Math.PI/180);this.position.x=0;this.position.y=0;this.forceDraw();r.restore()}}}class Axis{constructor(t,i,s){this.chart=t;this.visible=!0;this.inverted=!1;this.horizontal=i;this.otherSide=s;this.bounds=new Rectangle;this.position=0;this.format=new Format(t);this.format.stroke.size=2;this.format.depth=.2;this.custom=!1;this.z=s?1:0;this.maxLabelDepth=0;this.labels=new Labels(t,this);this.f=this.labels.format.font;if(i){this.f.textAlign="center";this.f.baseLine=s?"bottom":"top"}else{this.f.textAlign=s?"left":"right";this.f.baseLine="middle"}this.grid=new Grid(t);this.ticks=new Ticks(t);this.innerTicks=new Ticks(t);this.innerTicks.visible=!1;this.minorTicks=new Ticks(t);this.minorTicks.visible=!1;this.minorTicks.length=2;this.minorTicks.count=3;this.title=new AxisTitle(t);i||(this.title.rotation=s?270:90);this.automatic=!0;this.minimum=0;this.maximum=0;this.increment=0;this.log=!1;this.startPos=0;this.endPos=0;this.start=0;this.end=100;this.axisSize=0;this.scale=0;this.increm=0;this.minAxisRange=1e-10}scroll(t){this.automatic=!1;this.inverted&&(t=-t);this.minimum+=t;this.maximum+=t}calcWordWrap(t,i){var s,e,r=0,h=i.split(" ");for(e=0;e<h.length;e++)(s=t.textWidth(h[e]))>r&&(r=s);return r}toRadians(t){return t*(Math.PI/180)}minmaxLabelWidth(t){var i,s,e,r=(e=this.labels)._text,h=0,a=this.labels;if(null!==r){s="auto"==e.wordWrap||"yes"==e.wordWrap;a.format.font.prepare();for(var o=0,n=r.data.labels.length;o<n;o++){i=r.data.labels[o];e.ongetlabel&&(i=e.ongetlabel(o,i));i&&(h=Math.max(h,s?calcWordWrap(e.format,i):e.format.textWidth(i)))}}else{var l=this.roundMin(),c=this.maximum;h=Math.max(e.width(l),e.width(.5*(l+c)));h=Math.max(h,e.width(1e-7));h=Math.max(h,e.width(c))}0==e.rotation?(this.horizontal&&t||!this.horizontal&&!t)&&(h=a.format.textHeight("Wj")):h=this.horizontal?t?Math.abs(Math.sin(toRadians(e.rotation))*h):Math.abs(Math.cos(toRadians(e.rotation))*h):t?Math.abs(Math.cos(toRadians(e.rotation))*h):Math.abs(Math.sin(toRadians(e.rotation))*h);h<a.format.textHeight("Wj")&&(h=a.format.textHeight("Wj"));return h}checkRange(){this.maximum-this.minimum<this.minAxisRange&&(this.maximum=this.minimum+this.minAxisRange)}checkMinMax(){var t=this.chart.series,i=this.horizontal;if(this.automatic){this.minimum=i?t.minXValue(this):t.minYValue(this);this.maximum=i?t.maxXValue(this):t.maxYValue(this);this.checkRange()}}anySeriesHasLessThan(t,i){var s,e,r;for(s=0;e=t.chart.series.items[s++];)if(e.visible&&e.sequential&&((r=e.yMandatory)&&t.horizontal||!r&&!t.horizontal)&&e.associatedToAxis(t)&&e.count()<=i)return!0;return!1}nextStep(t){return isFinite(t)?t>=10?10*this.nextStep(.1*t):t<1?.1*this.nextStep(10*t):t<2?2:t<5?5:10:1}calcIncrement(t,i){if(t.maximum==t.minimum)return 1;var s=t.axisSize/i,e=this.anySeriesHasLessThan(t,s);s=Math.abs(t.maximum-t.minimum)/(s+1);return e?Math.max(1,s):this.nextStep(s)}calcAxisScale(){var t=this.maximum-this.minimum;0===t?t=1:this.log&&(t=Math.log(t));this.scale=this.axisSize/t}calcScale(){var t,i=this.labels;i.format.font.prepare();t=this.minmaxLabelWidth(!1);i.alternate&&(t*=.5);t*=1+.02*i.separation;this.increm=0===this.increment?this.calcIncrement(this,t):this.increment;this.increm<=0?this.increm=.1:this.increm>0&&this.increm<=1e-8&&(this.increm=1e-8)}hasAnySeries(){var t,i,s,e,r=this.chart.series.items;for(t=0;i=r[t++];)if(i.visible&&i.associatedToAxis(this)&&(i.__alwaysDraw||i.count()>0)){e=this.horizontal;i.yMandatory&&(e=!e);s=e?i.data.values:i.data.x;this.dateTime=s&&s.length>0&&s[0]instanceof Date;return i}return null}drawAxis(){var t,i=this,s=i.format,e=i.chart.ctx,r=i.axisPos,h=i.startPos,a=i.endPos,o=20*s.depth;if(this.chart.aspect.view3d&&o>0){t=this.horizontal?{x:h,y:r-.5*o,width:a-h,height:o}:{x:r-.5*o,y:h,width:o,height:a-h};var n=this.z;s.z=n-.5*s.depth;s.cylinder(t,1,!this.horizontal);s.draw(e,null,t);s.z=n}else{e.z=this.z;e.beginPath();if(this.horizontal){e.moveTo(h,r);e.lineTo(a,r)}else{e.moveTo(r,h);e.lineTo(r,a)}s.stroke.prepare();e.stroke()}}drawGrids(){var t,i,s,e,r,h,a=this.chart.ctx,o=this.chart.chartRect,n=this.grid.format,l=this.roundMin();if(this.grid.centered){var c=.5*this.increm;l-c>=this.minimum?l-=c:l+=c}var d=this.chart.aspect,u=d.view3d,m=u&&d.orthogonal,f=u?1:0;a.beginPath();if(this.horizontal){s=this.bounds.y-f;r=this.otherSide?o.getBottom()-1:o.y+1}else{i=this.bounds.x+f;e=this.otherSide?o.x+1:o.getRight()-1}var g,v=-1;if(""!==n.fill){h=l;var x=n.stroke.fill;n.stroke.fill="";for(;h<=this.maximum;){t=this.calc(h);v%2==0&&(horizontal?n.rectangle(g,r,t-g,s-r):n.rectangle(i,g,e-i,t-g));g=t;h+=this.increm;v++}n.stroke.fill=x;a.fillStyle=""}h=l;if(m)if(horizontal){s-=d._orthoy;r-=d._orthoy}else{i+=d._orthox;e+=d._orthox}var p=n.stroke.dash&&!a.setLineDash&&!a.mozCurrentTransform;a.z=u?this.chart.walls.back.format.z-.01:0;for(;h<=this.maximum;){v=this.calc(h);this.horizontal?i=e=v:s=r=v;if(m)if(this.horizontal){i+=d._orthox;e+=d._orthox}else{s-=d._orthoy;r-=d._orthoy}u&&!this.otherSide&&a.lineZ&&a.lineZ(i,s,0,a.z);if(p)dashedLine(a,i,s,e,r);else{a.moveTo(i,s);a.lineTo(e,r)}h+=this.increm}n.stroke.prepare();n.shadow.prepare(a);a.stroke()}truncFloat(t){return t-t%1}roundMin(){if(0!==this.increm&&this.labels.roundFirst){var t=this.truncFloat(this.minimum/this.increm);return this.increm*(this.minimum<=0?t:1+t)}return this.minimum}drawTicks(t,i,s){var e=this.roundMin(),r=1+t.length,h=1;if(this.horizontal&&this.otherSide||!this.horizontal&&!this.otherSide){r=-r;h=-1}r*=i;h*=i;r+=this.axisPos;h+=this.axisPos;var a,o,n=1,l=0;if(0===s)o=this.increm;else{n+=s;o=this.increm/n}var c=this.chart.ctx;c.beginPath();for(;e<=this.maximum;){if(0===s||l++%n!=0){a=this.calc(e);if(this.horizontal){c.moveTo(a,h);c.lineTo(a,r)}else{c.moveTo(h,a);c.lineTo(r,a)}}e+=o}t.stroke.prepare();t.z=this.z;c.z=t.z;c.stroke()}drawTitle(){var t,i,s=this.labels,e=this.title.bounds,r=this.title.rotation,h="center";if(""!==this.title.text){if(this.horizontal){i=this.title.padding;this.ticks.visible&&(i+=this.ticks.length);if(s.visible){s.format.font.prepare();var a=this.maxLabelDepth;s.alternate&&(a*=2);i+=a}t=this.startPos+.5*this.axisSize;this.otherSide&&(i=-i-e.height);i=this.axisPos+i;if(0===r)t-=.5*e.width;else{t+=e.height*(this.otherSide?-.5:.5);this.otherSide||(i+=1.5*e.height);h=this.otherSide||270===r?"near":"far"}}else{t=this.title.padding;this.ticks.visible&&(t+=this.ticks.length);if(s.visible){var o=s.maxWidth;s.alternate&&(o*=2);t+=o}i=this.startPos+.5*this.axisSize;if(0===r){t=this.axisPos+(this.otherSide?t:-t);i-=.5*e.height;h=this.otherSide?"near":"far"}else{t+=e.height;t=this.axisPos+(this.otherSide?t:-t);i+=e.width*(this.otherSide?-.5:.5)}}this.title.drawIt(h,t,i,r)}}rotatedWidth(t,i){return Math.abs(Math.sin(toRadians(t.rotation))*i)}drawLabel(t,i){var s=this.labels,e=s.getLabel(t);i.width=s.format.textWidth(e);i.width>s.maxWidth&&(s.maxWidth=i.width);if(0==s.rotation)this.horizontal?i.x-=.5*i.width:i.y+=.5*i.height;else{var r=this.chart.ctx;r.save();r.translate(i.x,i.y);r.rotate(-Math.PI*s.rotation/180);r.textAlign="right";if(this.horizontal){i.x=.5*-this.rotatedWidth(s,i.width);i.y=-.5*this.rotatedWidth(s,i.height)+3}else{i.x=-2;i.y=-8}}"right"==s.format.font.textAlign&&(i.x-=i.width);s.format.z=this.z*this.chart.walls.back.format.z;s.format.drawText(i,e);0!==s.rotation&&this.chart.ctx.restore()}drawLabels(){var t=this.roundMin(),i=new Rectangle,s=this.axisPos,e=this.labels;e.maxWidth=0;e.format.font.prepare();var r=this.ticks.visible?this.ticks.length:0;r+=e.padding;this.horizontal?this.otherSide?s-=r:s+=r:this.otherSide?s+=r:s-=r;var h=s;i.height=e.format.textHeight("Wj");for(var a,o=e.alternate,n=o?this.horizontal?-this.minmaxLabelWidth(!0):this.minmaxLabelWidth(!0):0;t<=this.maximum;){a=this.calc(t);if(this.horizontal){i.x=a;i.y=s}else{i.x=s;i.y=a-.5*i.height}o&&(s=s==h?this.otherSide?h+n:h-n:h);this.drawLabel(t,i);t+=this.increm}}calc(t){var i;i=t!=t?0:this.log?(t-=this.minimum)<=0?0:Math.log(t)*this.scale:(t-this.minimum)*this.scale;return this.horizontal?this.inverted?this.endPos-i:this.startPos+i:this.inverted?this.startPos+i:this.endPos-i}fromPos(t){var i=this.horizontal;this.inverted&&(i=!i);return this.minimum+(i?t-this.startPos:this.endPos-t)/this.scale}fromSize(t){return t/this.scale}fromSizeCalcIndex(t){var i=-1;if(1==this.dateTime){var s=0,e=0,r=(this.maximum-this.minimum)/this.axisSize*t+this.minimum;this.chart.series.items[0].data.x.length>1&&(e=this.chart.series.items[0].data.x[1].getTime()-this.chart.series.items[0].data.x[0].getTime());for(;-1==i&&s<this.chart.series.items[0].data.x.length;)this.chart.series.items[0].data.x[s].getTime()+e/2>r&&r+e/2>this.chart.series.items[0].data.x[s].getTime()?i=s:s++}else{i=t/this.scale+this.minimum;(this.chart.series.items[0].data.values.length<i||i<-.5)&&(i=-1)}return i}calcSize(t){return Math.abs(this.calc(t)-this.calc(0))}calcMinMax(t,i){this.automatic=!1;var s,e=this.fromPos(t),r=this.fromPos(i);if(e>r){s=e;e=r;r=s}this.minimum=e;this.maximum=r;this.checkRange()}setMinMax(t,i){this.automatic=!1;this.minimum=t;this.maximum=i;this.checkRange()}static adjustRect(){var t,i=0,s=this.labels,e=this.chart.chartRect,r=this.title;this.firstSeries=this.hasAnySeries();if(this.visible&&this.firstSeries&&this.visible){this.checkMinMax();s.checkStyle();(t=r.shouldDraw())&&r.resize();if(e.automatic&&!this.custom){if(s.visible){s.format.font.prepare();i=this.minmaxLabelWidth(!0);this.maxLabelDepth=i;s.alternate&&(i*=2);i+=s.padding}this.ticks.visible&&(i+=this.ticks.length);t&&(i+=r.bounds.height);this.horizontal?this.otherSide?e.setTop(e.y+i):e.height-=i:this.otherSide?e.width-=i:e.setLeft(e.x+i)}}}setPos(t,i){this.startPos=t+this.start*i*.01;this.endPos=t+this.end*i*.01;this.axisSize=this.endPos-this.startPos}static calcRect(){if(this.firstSeries){this.checkMinMax();var t=this.chart.chartRect,i=this.bounds,s=this.horizontal;if(s){i.y=this.otherSide?t.y:t.y+t.height;i.width=t.width;this.setPos(t.x,t.width)}else{i.x=this.otherSide?t.x+t.width:t.x;i.height=t.height;this.setPos(t.y,t.height)}this.calcAxisScale();var e=this.chart.series;if(e.items.length>0&&this.automatic){if((r=e.items[0])instanceof Bar&&r.notmandatory==this&&"sideAll"==r.stacked){r.notmandatory.minimum=-.5;r.notmandatory.maximum=r.countAll(!1)-.5}}if(this.automatic){var r=this.chart.series,h=s?r.horizMargins():r.vertMargins(),a=h.x>0,o=h.y>0;a&&(this.minimum-=this.fromSize(h.x));o&&(this.maximum+=this.fromSize(h.y));(a||o)&&this.calcAxisScale()}this.calcScale();var n=(s?t.height:t.width)*this.position*.01,l=this.chart.walls,c=0,d=l.visible&&this.chart.aspect.view3d;if(s){d&&l.bottom.visible&&(c=l.bottom.size);this.axisPos=this.otherSide?t.y+n:t.getBottom()+c-n}else{d&&l.left.visible&&(c=l.left.size);this.axisPos=this.otherSide?t.getRight()-n:t.x-c+n}}}static draw(){if(this.visible&&this.firstSeries){this.z=this.otherSide?this.chart.walls.back.format.z:0;if(Math.abs(this.maximum-this.minimum)<=1e-9){var t=Math.abs(this.minimum)<1e-9?1e-8:this.minimum/1e7;if(this.minimum!=this.minimum-t||this.maximum!=this.minimum+t){this.setMinMax(this.minimum-t,this.maximum+t);null!=this.chart&&this.chart.draw()}}""!==this.format.stroke.fill&&this.drawAxis();if(this.roundMin()+1e3*this.increm>this.maximum){this.grid.visible&&this.drawGrids();this.ticks.visible&&this.drawTicks(this.ticks,1,0);this.innerTicks.visible&&this.drawTicks(this.innerTicks,-1,0);this.minorTicks.visible&&this.drawTicks(this.minorTicks,1,Math.max(0,this.minorTicks.count));this.labels.visible&&this.drawLabels()}this.title.shouldDraw()&&this.drawTitle()}}}class Symbol{constructor(t){this.chart=t;this.format=new Format(t),this.s=this.format.shadow;this.s.visible=!0;this.s.color="silver";this.s.width=2;this.s.height=2;this.format.depth=.01;this.width=8;this.height=8;this.padding=8;this.style="rectangle";this.visible=!0}tryHover(t,i){if(t.hover.enabled){var s=this.chart.legend.showValues();if(s&&t.over==i||!s&&t.over>=0)return t.hover}return null}draw(t,i,s,e){var r=this.chart.ctx,h=this.tryHover(t,i),a=this.format.fill,o=this.format.stroke;this.format.fill=t.legendColor(i);r.z=-.01;switch(this.style){case"rectangle":h&&(this.format.stroke=h.stroke);if(this.chart.aspect.view3d){var n={x:s,y:e-.5*this.height-1,width:this.width,height:this.height};a=this.format.z;var l=r.z;this.format.z=r.z-this.format.depth;this.format.cube(n);this.format.draw(r,null,n);this.format.z=a;r.z=l}else this.format.rectangle(s,e-.5*this.height-1,this.width,this.height);break;case"triangle":h&&(this.format.stroke=h.stroke);this.format.polygon([new Point(s+.5*this.width,e-.5*this.height),new Point(s+this.width,e+.5*this.height),new Point(s,e+.5*this.height)]);break;case"ellipse":h&&(this.format.stroke=h.stroke);this.format.ellipse(s+.5*this.width,e,this.width,this.height);break;default:r.beginPath();r.moveTo(s,e);r.lineTo(s+this.width,e);h?h.stroke.prepare():this.format.stroke.prepare(this.format.fill);r.stroke()}this.format.fill=a;this.format.stroke=o}}class Legend{constructor(t){this.chart=t;this.transparent=!1;this.useStrokeColor=!1;this.format=new Format(t);this.format.fill="white";this.format.round.x=8;this.format.round.y=8;this.format.font.baseLine="top";this.format.shadow.visible=!0;this.format.z=0;this.format.depth=.05;this.title=new Annotation(t);this.title.transparent=!0;this.bounds=new Rectangle;this.position="right";this.visible=!0;this.inverted=!1;this.padding=5;this.margin=5;this.align=0;this.fontColor=!1;this.dividing=new Stroke(t);this.dividing.fill="";this.dividing.cap="butt";this.over=-1;this.symbol=new Symbol(t);this.itemHeight=10;this.innerOff=0;this.legendStyle="auto";this.textStyle="auto";this.hover=new Format(t);this.hover.enabled=!0;this.hover.font.fill="red";this.titleHeight=0;this.rMouse=new Rectangle;this.itemPos={x:0,y:0};this.r=new Rectangle;this.aligns;this.itemWidth;this.itemWidths}totalWidth(){var t=this.itemWidth+8,i=this.symbol;i.visible&&(t+=i.width+i.padding);return t}_space(){return this.bounds.y+this.titleHeight+this.margin*this.chart.bounds.height*.01}availRows(){var t=this._space()+.5*this.itemHeight;t||(t=0);return trunc((this.chart.bounds.getBottom()-t)/this.itemHeight)}seriesCount(t){var i=this.chart.series;return t.showHidden?i.items.length:i.visibleCount()}itemsCount(){var t=this.chart.series,i=this.seriesCount(this),s=this.chart.bounds;if(0===i)return 0;var e=this.legendStyle;if("values"===e&&i>0)i=t.firstVisible().legendCount();else if("auto"===e&&i>1||"series"===e){var r;for(r=0;r<t.items.length;r++)t.items[r].legend.visible||i--}else 1==i&&(i=t.firstVisible().legendCount());if(this.isVertical())(.5+i)*this.itemHeight>s.height-this._space()&&(i=this.availRows());else{this.rows=1;var h=this.totalWidth(),a=this.calcPadding(s),o=s.width-2*a;if(i*h>o){var n=s.x+a;n||(n=0);this.perRow=trunc(o/h);if(i>this.perRow){this.rows=1+trunc(i/this.perRow);if(this.rows*this.itemHeight>s.height-this.bounds.y){this.rows=this.availRows();i=this.rows*this.perRow}}}else this.perRow=i}return i}showValues(){var t=this.legendStyle;return"values"==t||"auto"==t&&1==this.seriesCount(this)}itemText(t,i){var s=t.legendText(i,this.textStyle,!1,!0);return this.ongettext?this.ongettext(this,t,i,s):s}calcItemPos(t,i){var s=this.itemHeight,e=this.bounds;i.x=e.x;i.y=e.y+this.innerOff;if(this.isVertical()){i.x+=e.width-6-this.innerOff;i.y+=.4*s+t*s+this.titleHeight}else{i.x+=this.innerOff+(1+t%this.perRow)*this.totalWidth();i.y+=s*(trunc(t/this.perRow)+.25)}}calcItemRect(t,i){var s=this.itemHeight,e=this.bounds;i.height=s;i.x=e.x;i.y=e.y;if(this.isVertical()){i.width=e.width;i.y+=.4*s+t*s+this.titleHeight}else{i.width=this.totalWidth();i.x+=this.innerOff+t%this.perRow*i.width;i.y+=s*(trunc(t/this.perRow)+.25)}}mousedown(t){if(this.onclick&&-1!==this.over){if(this.showValues())this.onclick(chart.series.firstVisible(),this.over);else for(var i=chart.series.items,s=i.length,e=0,r=0;r<s;r++)if(this.showHidden||i[r].visible){if(e==this.over){this.onclick(i[r],-1);break}e++}return!0}return!1}mousemove(t){var i=this.over;if(this.bounds.contains(t))for(var s=this.itemsCount(),e=0;e<s;e++){this.calcItemRect(e,this.rMouse);if(this.rMouse.contains(t)){i=e;break}}else i=-1;if(i!=this.over){this.onhover&&this.onhover(this.over,i);this.over=i;var r=this.chart;window.requestAnimationFrame((function(){r.draw()}))}this.onclick&&(this.chart.newCursor=-1===i?"default":"pointer")}drawSymbol(t,i,s){var e=this.symbol;e.draw(t,i,s.x-this.itemWidth-e.width-e.padding,s.y+.4*this.itemHeight)}drawItem(t,i,s,e){var h=!1,a=this.isVertical();this.calcItemPos(s,this.itemPos);this.r.x=this.itemPos.x;this.r.y=this.itemPos.y;a?this.r.y-=this.chart.isMozilla?0:2:this.chart.isMozilla?this.r.y++:this.r.y--;var o=this.format.font.fill;this.over==s?this.format.font.fill=this.hover.enabled?this.hover.font.fill:o:this.fontColor?this.format.font.fill=this.showValues()?i.legendColor(s):i.format.fill:i.visible||(this.format.font.fill="silver");var n=this.chart.ctx;if(e){this.format.font.textAlign="start";this.r.x-=this.itemWidths[0];n.textAlign=this.format.font.textAlign;var l=this.symbol.width,c={text:t,index:s,r:this.r,symbolWidth:l,stopLegend:!1};this.onbeforedrawLegendItem&&this.onbeforedrawLegendItem(c);c.stopLegend&&(h=!0);t=c.text;h||this.format.drawText(this.r,t)}else{t instanceof Array||(t=[t]);if(a){for(var d=t.length,u=this.r.width,m=this.format.textWidth(" ");d--;){this.format.font.textAlign=this.aligns[d]?"start":"end";this.r.x-=this.itemWidths[d];n.textAlign=this.format.font.textAlign;l=this.symbol.width,c={text:t,index:s,r:this.r,symbolWidth:l,stopLegend:!1};this.onbeforedrawLegendItem&&this.onbeforedrawLegendItem(c);c.stopLegend&&(h=!0);t=c.text;h||this.format.drawText(this.r,t[d]);this.r.width-=this.itemWidths[d]+m}this.r.width=u}else{this.format.font.textAlign="start";this.r.x-=this.itemWidth;n.textAlign=this.format.font.textAlign;l=this.symbol.width,c={text:t,index:s,r:r,symbolWidth:l,stopLegend:!1};this.onbeforedrawLegendItem&&this.onbeforedrawLegendItem(c);c.stopLegend&&(h=!0);t=c.text;h||this.format.drawText(r,t.join(" "))}}if(!h){this.format.font.fill=o;var f=!i.isColorEach||this.showValues();this.symbol.visible&&f&&this.drawSymbol(i,s,this.itemPos);if(s>0&&""!==this.dividing.fill){var g=this.bounds;n.beginPath();if(this.isVertical()){n.moveTo(g.x,r.y-2);n.lineTo(g.getRight(),r.y-2)}else{var v=r.x-this.itemWidth-4,x=this.symbol;x.visible&&(v-=x.width+x.padding);n.moveTo(v,g.y);n.lineTo(v,g.getBottom())}this.dividing.prepare();n.stroke()}}}drawSeries(t,i){var s=this.chart.series.items[t];if((this.showHidden||s.visible)&&s.legend.visible){this.drawItem(s.titleText(t),s,i,!0);return!0}return!1}draw(){var t,i,s,e=this.itemsCount(),r=this.title,h=this.chart.ctx,a=this.format.transparency,o=this.isVertical();if(e>0){var n=h.beginParent;this.visual=n?h.beginParent():null;this.format.cube(this.bounds);this.transparent||this.format.draw(h,null,this.bounds);if(a>0){s=h.globalAlpha;h.globalAlpha=(1-a)*s}if(o&&this.titleHeight>0){r.bounds.x=this.bounds.x-4;r.bounds.y=this.bounds.y;r.doDraw()}this.format.font.prepare();this.r.width=this.itemWidth;this.r.height=this.itemHeight;if(this.showValues()){var l=this.chart.series.firstVisible(),c=0;t=e;switch(this.textStyle){case"auto":case"percentlabel":case"valuelabel":this.aligns=[!1,!0];break;case"labelpercent":case"labelvalue":this.aligns=[!0,!1];break;case"label":this.aligns=[!0];break;default:this.aligns=[!1]}if(this.inverted)for(;t--;)this.drawItem(this.itemText(l,t),l,c++);else for(i=0;i<t;i++)this.drawItem(this.itemText(l,i),l,i)}else{t=this.chart.series.count();o&&(t=Math.min(t,this.availRows()));e=0;this.aligns=[!0];if(this.inverted)for(;t--;)this.drawSeries(t,e)&&e++;else for(i=0;i<t;i++)this.drawSeries(i,e)&&e++}a>0&&(h.globalAlpha=s);n&&h.endParent()}}calcWidths(){var t,i,s,e,r,h=this.chart.series;this.itemWidth=0;this.itemWidths=[0,0];if(this.showValues()){t=h.firstVisible();e=this.itemsCount();for(i=0;i<e;i++){(r=this.itemText(t,i))instanceof Array||(r=[r]);if(r.length>0){(s=this.format.textWidth(r[0]))>this.itemWidths[0]&&(this.itemWidths[0]=s);r.length>1&&(s=this.format.textWidth(r[1]))>this.itemWidths[1]&&(this.itemWidths[1]=s)}}}else{e=h.count();for(i=0;i<e;i++){t=h.items[i];(this.showHidden||t.visible)&&(s=this.format.textWidth(t.titleText(i)))>this.itemWidths[0]&&(this.itemWidths[0]=s)}}this.itemWidth=this.itemWidths[0]+this.itemWidths[1]}calcPadding(t){return.01*this.padding*(this.isVertical()?t.width:t.height)}isVertical(){var t=this.position;return"right"===t||"left"===t}calcrect(){var t=0,i=this.title,s=this.chart.chartRect,e=this.align,r=this.bounds,h=this.isVertical();if(i.shouldDraw()){i.resize();this.titleHeight=i.bounds.height;t=i.bounds.width}else this.titleHeight=0;h?r.y=0===e?s.y:this.chart.bounds.height*e*.01:r.x=0===e?s.x:this.chart.bounds.width*e*.01;this.format.font.prepare();this.itemHeight=this.format.textHeight("Wj");this.calcWidths();var a,o=this.calcPadding(s),n=this.itemsCount();if(h){a=this.symbol.visible?this.symbol.width+this.symbol.padding:0;r.width=Math.max(t,12+this.itemWidth+a);r.height=(.5+n)*this.itemHeight+this.titleHeight;r.width-6>t&&(i.bounds.width=r.width-6)}else{r.width=o+this.perRow*this.totalWidth();r.x+=.5*(s.width-r.width);r.height=this.itemHeight*(this.rows+.25)}if(""!==this.format.stroke.fill&&(a=+this.format.stroke.size)>1){r.width+=a;r.height+=a;this.innerOff=.5*a}if(0!==n)if("right"===this.position){r.x=s.getRight()-r.width-this.margin*r.width*.01;s.automatic&&s.setRight(Math.max(s.x,r.x-o))}else if("left"===this.position){r.x=s.x;s.automatic&&s.setLeft(r.x+r.width+o)}else if("top"===this.position){r.y=s.y+o;s.automatic&&s.setTop(r.getBottom()+o)}else{r.y=s.getBottom()-r.height-o;s.automatic&&s.setBottom(r.y-o)}}}class Marks extends Annotation{constructor(t,i){super(i);this.series=t;this.arrow=new Format(this.chart);this.arrow.visible=!0;this.arrow.length=10;this.arrow.underline=!1;this.arrow.z=.5;this.arrow.depth=.1;this.style="auto";this.drawEvery=1;this.visible=!1;this.format.z=.5}setChart(t){this.chart=t;this.format.setChart(t);this.arrow.setChart(t)}drawPolar(t,i,s,e){var r=this.series.markText(e),h=t.x+Math.cos(s)*i,a=t.y+Math.sin(s)*i,o=this.chart.ctx;this.text=r;this.resize();var n,l,c=this.bounds,d=this.position;i+=this.arrow.length;n=t.x+Math.cos(s)*i,l=t.y+Math.sin(s)*i;n-c.width<0&&(n-=n-c.width-4);Math.abs(n-t.x)<c.width?d.x=n-.5*c.width:d.x=n<t.x?n-c.width:n;Math.abs(l-t.y)<c.height?d.y=l-.5*c.height:d.y=l<t.y?l-c.height:l;o.beginPath();o.moveTo(h,a);o.lineTo(n,l);if(this.arrow.underline&&(l<=d.y||l>=d.y+c.height)){o.moveTo(d.x,l);o.lineTo(d.x+c.width,l)}this.arrow.stroke.prepare();o.stroke();this.draw()}canDraw(t,i,s,e){var r=this.series.markText(s);if(r&&""!==r&&(this.showZero||"0"!==r)){this.text=r;this.resize();var h=e?-1:1,a=this.bounds;if(this.series.yMandatory){a.x=t-.5*a.width;a.y=i-h*(this.arrow.length+(e?0:a.height))}else{a.x=t+h*this.arrow.length;e&&(a.x-=a.width);a.y=i-.5*a.height}this.position.x=a.x;this.position.y=a.y;return!0}return!1}drawMark(t,i,s,e){if(this.canDraw(t,i,s,e)){this.draw();if(this.arrow.visible){var r=this.bounds,h=this.series.yMandatory,a=e?r.y:r.getBottom(),o=this.chart.ctx,n=this.chart.aspect.view3d;if(h){if(n){var l={x:t-3,y:a,width:6,height:i-a};this.arrow.z=this.format.z-.5*this.arrow.depth;this.arrow.cylinder(l,1,!0);this.arrow.draw(this.chart.ctx,null,l);return}o.beginPath();o.moveTo(t,a);o.lineTo(t,i);if(this.arrow.underline){o.moveTo(r.x,a);o.lineTo(r.x+r.width,a)}}else{var c=r.y+.5*r.height;o.beginPath();o.moveTo(t,c);e&&(r.x+=r.width);o.lineTo(r.x,c);if(this.arrow.underline){o.moveTo(r.x,r.y+r.height);o.lineTo(r.x+(e?-r.width:r.width),r.y+r.height)}}this.arrow.stroke.prepare();o.stroke()}}}}function ArraySumAbs(t){for(var i=0,s=t.length;s--;)i+=t[s]>0?t[s]:-t[s];return i}"map"in Array.prototype||(Array.prototype.map=function(t,i){for(var s=new Array(this.length),e=0,r=this.length;e<r;e++)e in this&&(s[e]=t.call(i,this[e],e,this));return s});"filter"in Array.prototype||(Array.prototype.filter=function(t,i){for(var s,e=[],r=0,h=this.length;r<h;r++)r in this&&t.call(i,s=this[r],r,this)&&e.push(s);return e});function removeEmptyArrayElements(t){return(i=t)&&i.constructor==Array?t.filter((function(t){return null!==t})).map(removeEmptyArrayElements):t;var i}function ArrayMax(t){var i=removeEmptyArrayElements(t),s=-Number.MAX_VALUE;i.forEach((function(t){s<t&&(s=t)}));"[object Date]"===Object.prototype.toString.call(s)&&(s=s.getTime());return s}function ArrayMin(t){var i=removeEmptyArrayElements(t),s=Number.MAX_VALUE;i.forEach((function(t){s>t&&(s=t)}));"[object Date]"===Object.prototype.toString.call(s)&&(s=s.getTime());return s}class Series{constructor(t,i){this.chart=null;this.data={values:[],labels:[],source:null};this.sortedOptions={sortedDrawAnimation:new Animation,sortedValues:[],sortedValuesIndices:[],originalValues:[],sortedLabels:[],originalLabels:[],sorted:!1,ascending:!0,sorting:!1,sortingAnimationType:"verticalchange"};this.yMandatory=!0;this.horizAxis="bottom";this.vertAxis="left";this.legend={visible:!0};this.legendStrokeColor=!1;this.sequential=!0;this.format=new Format(this.chart);this.hover=new Format(this.chart);this.s=this.hover.shadow;this.sortedOptions.sortedDrawAnimation.duration=500;this.sortedOptions.sortedDrawAnimation.mode="linear";this.format.fill="";this.format.stroke.fill="";this.visible=!0;this.hover.stroke.size=.3;this.hover.fill="";this.hover.stroke.fill="red";this.s.visible=!0;this.s.blur=10;this.s.width=0;this.s.height=0;this.cursor="default";this.over=-1;this.marks=new Marks(this,this.chart);this.palette=new Palette;this.paletteName="opera";this.themeName="default";this.colorEach="auto";this.useAxes=!0;this.decimals=2;this._paintAxes=!0;this._paintWalls=!0;this.init(t,i);this.title=""}cellRect(t,i,s){var e={total:0,index:-1};t.setFrom(this.chart.chartRect);this.chart.series.visibleCount(this,s,e);if(i&&e.total>1){var r=Math.round(Math.sqrt(e.total)),h=Math.round(e.total/r);if(t.width>t.height){var a=r;r=h;h=a}t.width/=r;t.x+=e.index%r*1.03*t.width;t.height/=h;t.y+=1.03*trunc(e.index/r)*t.height;t.width*=.94;t.height*=.94}return t}sortValues(){this.sortedOptions.sorting=!0;var t=[],i=this.data.values,s=this.sortedOptions.ascending;this.sortedOptions.sortedLabels=[];for(var e=0;e<this.data.values.length;e++)t.push(e);t.sort((function(t,e){return s?i[t]-i[e]:i[e]-i[t]}));this.sortedOptions.originalValues=this.data.values.slice();this.sortedOptions.originalLabels=this.data.labels.slice();for(e=0;e<t.length;e++)this.sortedOptions.sortedLabels.push(this.data.labels[t[e]]?this.data.labels[t[e]]:t[e]);this.sortedOptions.sortedValuesIndices=t;this.sortedOptions.sortedValues=this.data.values.slice().sort((function(t,i){return s?t-i:i-t}));this.sortedOptions.sorting=!1;return this.sortedOptions.sortedValues.slice()}drawSortedValues(t){var i=this.sortedOptions.sortedDrawAnimation;if(this.sortedOptions.sorted!=t&&!this.sortedOptions.sorting&&i&&!i.running){this.sortedOptions.sorted=t;this.data;t&&this.sortValues();var s=t?this.sortedOptions.originalValues.slice():this.sortedOptions.sortedValues.slice(),e=this.data.values,r=t?this.sortedOptions.sortedValues.slice():this.sortedOptions.originalValues.slice();if(e.length!=r.length||!e.every((function(t,i){return t===r[i]}))){i.chart=this.chart;i.doStep=function(t){if(t<1)for(var i=0;i<s.length;i++)e[i]=s[i]+(r[i]-s[i])*t};i.onstop=function(){for(var t=0;t<s.length;t++)e[t]=r[t];i.running=!1};i.onstart=function(){i.running=!0};i.animate()}this.data.labels=t?this.sortedOptions.sortedLabels.slice():this.sortedOptions.originalLabels.slice();this.chart.draw()}}init(t,i){if("object"==typeof t&&t)if(t instanceof Array){this.data.values=t;i instanceof Array&&(this.data.labels=i)}else if(t instanceof Chart){this.chart=t;i instanceof Array&&(this.data.values=i)}else{this.data.source=t;this.refresh()}}getFill(t,i){var s=this.palette,e=s&&s.colors?s.get(t):null;return null===e?this.isColorEach||!i?this.chart.palette.get(t):i.fill:e}isNull(t){return null===this.data.values[t]}getFillStyle(t,i){return this.format.gradient.visible?this.format.gradient.create(t,i):i}titleText(t){return this.title||"Series "+t.toString()}refresh(t){if(this.data.source)if(this.data.source instanceof HTMLTextAreaElement){parseText(this.data,this.data.source.value);this.chart&&this.chart.draw()}else this.data.source instanceof HTMLInputElement?doHttpRequest(this,this.data.source.value,(function(t,i){parseText(t.data,i);t.chart.draw()}),(function(i,s){t&&t(this,i,s)})):t&&t(this);else if(this.data.xml){parseXML(this,this.data.xml);this.chart.draw()}else if(this.data.json){parseJSON(this,this.data.json);this.chart.draw()}}valueOrLabel(t){var i=this.data.labels[t];i&&""!==i||(i=this.valueText(t));return i}toPercent(t){var i=this.data.values;return(100*Math.abs(i[t])/ArraySumAbs(i)).toFixed(this.decimals)+" %"}markText(t){var i=this.marks,s=this.dataText(t,i.style,!1);return i.ongettext?i.ongettext(this,t,s):s}associatedToAxis(t){return t.horizontal?"both"==this.horizAxis||this._horizAxis==t:"both"==this.vertAxis||this._vertAxis==t}bounds(t){var i=this._horizAxis,s=this._vertAxis;t.x=i.calc(this.minXValue());t.width=i.calc(this.maxXValue())-t.x;t.y=s.calc(this.maxYValue());t.height=s.calc(this.minYValue())-t.y}calcStack(t,i,s){var e,r=this.pointOrigin(t,!1)+s,h=this.mandatoryAxis;i.x=this.notmandatory.calc(this.data.x?this.data.x[t]:t);if(this.isStack100){e=this.pointOrigin(t,!0);i.y=0===e?h.endPos:h.calc(100*r/e)}else i.y=h.calc(r);if(!this.yMandatory){e=i.x;i.x=i.y;i.y=e}}pointOrigin(t,i){var s,e,r,h,a=0,o=this.chart.series.items;for(s=0;s<o.length;s++){e=o[s];if(!i&&e==this)break;if("no"!=e.stacked){r=e.data.values;e.visible&&e.constructor==this.constructor&&r.length>t&&void 0!==(h=r[t])&&(a+=i&&h<0?-h:h)}}return a}doHover(t){var i=this.chart;if(t!=this.over){i.onhover&&i.onhover(this,t);this.over=t;this.hover.enabled&&window.requestAnimationFrame((function(){i.draw()}))}}initZ(t,i){var s=this.format;s.z=t/i;s.depth=1/i;this.marks.format.z=s.z+.5*s.depth}setChart(t,i){t.chart=i;t.recalcAxes();t.format.setChart(i);t.marks.setChart(i);t.hover.setChart(i)}calc(t,i){var s=this.data,e=this.notmandatory.calc(s.x?s.x[t]:t),r=this.mandatoryAxis.calc(s.values[t]);i.x=this.yMandatory?e:r;i.y=this.yMandatory?r:e}recalcAxes(){var t=this.chart.axes;this.horizAxis instanceof Axis?this._horizAxis=this.horizAxis:this._horizAxis="top"==this.horizAxis?t.top:t.bottom;this.vertAxis instanceof Axis?this._vertAxis=this.vertAxis:this._vertAxis="right"==this.vertAxis?t.right:t.left;this.mandatoryAxis=this.yMandatory?this._vertAxis:this._horizAxis;this.notmandatory=this.yMandatory?this._horizAxis:this._vertAxis}getRect(){return new Rectangle}clicked(){return-1}fixedFloatToLocal(t,i){var s=t.toFixed(i),e=t.toLocaleString(this.chart.language);if(-1!=s.indexOf(".")){var r=1.1;r=r.toLocaleString(this.chart.language).substring(1,2);var h=s.substring(s.indexOf(".")+1);return e.substring(0,-1==e.indexOf(r)?e.length:e.indexOf(r))+r+h}return t}valueText(t){var i=(this.data._old||this.data.values)[t];return i?i instanceof Date?i.format?i.format(this.dateFormat):i.toString():this.valueFormat?i.toLocaleString(this.chart.language):trunc(i)==i?this.fixedFloatToLocal(i,0).toString():this.fixedFloatToLocal(i,this.decimals).toString():"0"}labelOrTitle(t){return this.data.labels[t]||this.title}mousedown(){return!1}mousemove(t){if(this.hover.enabled||"default"!=this.cursor){var i=this.clicked(t);this.doHover(i);if("default"!=this.cursor&&-1!=i){this.chart.newCursor||(this.chart.newCursor=this.cursor);return}}var s=this.marks;if(s.visible){var e,r=this.data.values.length,h=new Point;for(e=0;e<r;e+=s.drawEvery)if(!this.isNull(e)){this.markPos(e,h);if(s.canDraw(h.x,h.y,e)&&s.bounds.contains(t)){this.doHover(e);break}}}}mouseout(){}markPos(t,i){this.calc(t,i);return!1}drawMarks(){var t,i,s=this.data.values.length,e=new Point;for(t=0;t<s;t+=this.marks.drawEvery)if(!this.isNull(t)){i=this.markPos(t,e);this.marks.drawMark(e.x,e.y,t,i)}}horizMargins(){}vertMargins(){}minXValue(){return this.data.x&&this.data.x.length>0?ArrayMin(this.data.x):0}minYValue(){var t=this.data.values;return t.length>0?ArrayMin(t):0}maxXValue(){if(this.data.x)return this.data.x.length>0?ArrayMax(this.data.x):0;var t=this.data.values.length;return 0===t?0:t-1}maxYValue(){var t,i,s,e=this.data.values,r=e.length;if(r>0){if((s=ArrayMax(e))!=s)for(t=0;t<r;t++)void 0!==(i=e[t])&&(s!=s||i>s)&&(s=i);return s==s?s:0}return 0}calcColorEach(){this.isColorEach="yes"==this.colorEach}stackMaxValue(){if("100"==this.stacked)return 100;var t=Series.prototype.maxYValue;if("no"==this.stacked)return t.call(this);for(var i,s=t.call(this),e=this.data.values,r=e.length;r--;){void 0===(i=e[r])&&(i=0);s=Math.max(s,this.pointOrigin(r,!1)+i)}return s}dataText(t,i,s,e){function r(t,i){return e?h?[t,i]:[t,""]:t+(i?" "+i:"")}var h=s?this.labelOrTitle(t):this.data.labels[t];return"value"==i?this.valueText(t):"percent"==i?this.toPercent(t):"percentlabel"==i?r(this.toPercent(t),h):"valuelabel"==i||"auto"==i?r(this.valueText(t),h):"label"==i?h||"":"index"==i?t.toFixed(0):"labelvalue"==i?r(h,this.valueText(t)):"labelpercent"==i?r(h,this.toPercent(t)):this.valueOrLabel(t)}legendText(t,i,s,e){return this.dataText(t,i,s,e)}count(){return this.data.values.length}legendCount(){return this.count()}legendColor(t){return this.isColorEach&&-1!=t?this.getFill(t):this.legendStrokeColor?this.format.stroke.fill:this.format.fill}addRandom(t,i,s){i||(i=1e3);t||(t=5);var e=this.data;e.values.length=t;s&&(e.x=new Array(t));if(t>0){e.values[0]=Math.random()*i;s&&(e.x[0]=Math.random()*i);for(var r=1;r<t;r++){e.values[r]=e.values[r-1]+Math.random()*i-.5*i;s&&(e.x[r]=Math.random()*i)}}return this}doSort(t,i){if("none"==t)return null;for(var s=this.data.values,e=s.length,r=new Array(e),h=0;h<e;h++)r[h]=h;if("labels"==t){s=this.data.labels;var a,o,n=i?-1:1,l=i?1:-1;r.sort((function(t,i){a=s[t].toLowerCase();o=s[i].toLowerCase();return a<o?n:a==o?0:l}))}else r.sort(i?function(t,i){return s[t]-s[i]}:function(t,i){return s[i]-s[t]});return r}}class SeriesList{constructor(t){this.chart=t;this.items=[]}count(){return this.items.length}clicked(t){var i=!1;this.each((function(s){if(s.visible&&s.onclick){var e=s.clicked(t);-1!=e&&(i=s.onclick(s,e,t.x,t.y))}}));return i}mousedown(t){for(var i,s=0,e=!1;i=this.items[s++];)i.visible&&i.mousedown(t)&&(e=!0);return e}mousemove(t){for(var i,s=0;i=this.items[s++];)i.visible&&i.mousemove(t)}mouseout(){this.each((function(t){t.visible&&t.mouseout()}))}visibleCount(t,i,s){for(var e,r=0,h=this.items,a=h.length;e=h[--a];)if(e.visible&&(!i||e instanceof i)){s&&e==t&&(s.index=r);r++}if(s){s.total=r;s.index=r-1-s.index}return r}beforeDraw(){this.each((function(t){t.useAxes&&t.recalcAxes();t.calcColorEach()}))}anyUsesAxes(){for(var t,i=this.items.length;i--;)if((t=this.items[i]).visible&&t.useAxes)return!0;return!1}firstVisible(){for(var t,i=0;t=this.items[i++];)if(t.visible)return t;return null}vertMargins(){var t,i,s,e=this.items,r=e.length;if(r>0){t={x:0,y:0};i={x:0,y:0};e[0].vertMargins(t);for(s=1;s<r;s++)if(e[s].data.values.length>0){i.x=i.y=0;e[s].vertMargins(i);i.x>t.x&&(t.x=i.x);i.y>t.y&&(t.y=i.y)}}return t}horizMargins(){var t,i,s,e=this.items,r=e.length;if(r>0){t={x:0,y:0};i={x:0,y:0};e[0].horizMargins(t);for(s=1;s<r;s++)if(e[s].data.values.length>0){i.x=i.y=0;e[s].horizMargins(i);i.x>t.x&&(t.x=i.x);i.y>t.y&&(t.y=i.y)}}return t}minXValue(t){var i,s=1/0;this.eachAxis(t,(function(t){(i=t.minXValue())<s&&(s=i)}));return s}minYValue(t){var i,s=1/0;this.eachAxis(t,(function(t){(i=t.minYValue())<s&&(s=i)}));return s}maxXValue(t){var i,s=-1/0;this.eachAxis(t,(function(t){(i=t.maxXValue())>s&&(s=i)}));return s}maxYValue(t){var i,s=-1/0;this.eachAxis(t,(function(t){(i=t.maxYValue())>s&&(s=i)}));return s}axisStrokeSize(t){if(t.visible&&t.firstSeries){var i=t.format.stroke;return""===i.fill?0:.5*i.size}return 0}draw(){var t,i,s=this.items.length,e=this.chart,r=e.ctx,h=e.aspect;if(s>0){for(t=0;t<s;t++)(i=this.items[t]).visible&&i.beforeDraw&&i.beforeDraw();var a=h.clip&&this.anyUsesAxes(),o=e.axes;if(a){var n=e.chartRect,l=this.axisStrokeSize(o.left),c=this.axisStrokeSize(o.top),d={x:n.x+l,y:n.y+c,width:n.width-this.axisStrokeSize(o.right),height:n.height-this.axisStrokeSize(o.bottom)};h.clipRect(d)}try{var u=r.beginParent;for(t=0;t<s;t++)if((i=this.items[t]).visible){var m=r.globalAlpha;r.globalAlpha=1-i.format.transparency;if(i.transform){r.save();i.transform()}i.visual=u?r.beginParent():null;i.onbeforedraw&&i.onbeforedraw(i);i.draw();u&&r.endParent();i.ondraw&&i.ondraw(i);i.transform&&r.restore();r.globalAlpha=m}}finally{a&&r.restore()}for(t=0;t<s;t++)if((i=this.items[t]).visible&&i.marks.visible){if(i.transform){r.save();i.transform()}i.drawMarks();i.transform&&r.restore()}}}each(t){for(var i=this.items.length,s=0;s<i;s++)t(this.items[s])}eachAxis(t,i){for(var s,e=this.items.length;e--;)(s=this.items[e]).visible&&(!t||s.associatedToAxis(t))&&(s.__alwaysDraw||s.count()>0)&&i(s)}}class Axes{constructor(t){this.chart=t;this.visible=!0;this.transparency=0;this.left=new Axis(t,!1,!1);this.top=new Axis(t,!0,!0);this.right=new Axis(t,!1,!0);this.bottom=new Axis(t,!0,!1);this.items=[this.left,this.top,this.right,this.bottom]}each(t){for(var i,s=0;i=this.items[s++];)t.call(i)}add(t,i){var s=new Axis(chart,t,i);s.custom=!0;this.items.push(s);return s}}class Chart{constructor(t,i,s){var e="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"";this.isChrome=e.indexOf("chrome")>-1;this.isAndroid=e.indexOf("android")>-1;this.isMozilla="undefined"!=typeof window&&window.mozRequestAnimationFrame;this.language=window.navigator.userLanguage||window.navigator.language;t&&("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement?this.canvas=t:this.canvas="string"==typeof t?document.getElementById(t):t);if(!this.canvas){this.canvas=document.createElement("canvas");this.canvas.width=600;this.canvas.height=400}this.__webgl=this.canvas.__webgl;if(this.canvas.__webgl||0===this.canvas.clientWidth)this.bounds=new Rectangle(0,0,this.canvas.width,this.canvas.height);else{this.bounds=new Rectangle(0,0,this.canvas.clientWidth,this.canvas.clientHeight);this.canvas.width=this.canvas.clientWidth;this.canvas.height=this.canvas.clientHeight}this.chartRect=new Rectangle;this.chartRect.automatic=!0;this.chartRect.setFrom(this.bounds);this.palette=new Palette(["#4466a3","#f39c35","#f14c14","#4e97a8","#2b406b","#1d7b63","#b3080e","#f2c05d","#5db79e","#707070","#f3ea8d","#b4b4b4"]);this.aspect={chart:this,view3d:this.__webgl,ortogonal:!this.__webgl,rotation:0,elevation:315,perspective:50,clip:!0,_orthox:10,_orthoy:8,clipRect:function(t){var i=this.chart.ctx;i.save();i.beginPath();this.view3d?i.rect(t.x,t.y-this._orthoy,t.width+this._orthox,t.height+this._orthoy):i.rect(t.x,t.y,t.width,t.height);i.clip()}};this.panel=new Panel(this);this.walls={chart:this,visible:!0,left:new Wall(this),right:new Wall(this),bottom:new Wall(this),back:new Wall(this),draw:function(t,i){var s,e=this.chart.ctx,r=this.transparency,h=e.beginParent;this.visual=h?e.beginParent():null;if(r>0){s=e.globalAlpha;e.globalAlpha=(1-r)*s}var a=this.back.bounds;a.setFrom(t);if(i.view3d){var o=this.bottom.visible?this.bottom.size:0,n=this.left.size;if(n>0){a.x-=n;a.width+=n}o>0&&(a.height+=o);this.left.bounds.set(t.x-n,t.y,n,t.height+o);this.bottom.bounds.set(t.x,t.getBottom(),t.width,o);this.back.format.depth=this.back.size}!this.back.visible||this.back.draw();if(this.chart.aspect.view3d){this.left.visible&&this.left.draw();this.bottom.visible&&this.bottom.draw();this.right.visible&&this.right.draw()}r>0&&(e.globalAlpha=s);h&&e.endParent()}};var r=this.walls.back.format;r.fill="rgb(240,240,240)";r.shadow.visible=!0;r.z=1;var h=this.walls.left;h.format.fill="#BBAA77";h.format.depth=1;h.size=2;var a=this.walls.bottom;a.format.depth=1;a.size=2;this.walls.right.visible=!1;this.axes=new Axes(this);this.legend=new Legend(this);this.series=new SeriesList(this);this.title=new ChartTitle(this,"blue");this.title.text="TeeChart";this.title.format.z=1;this.subtitle=new ChartTitle(this,"blue");this.subtitle.format.z=1;this.footer=new ChartTitle(this,"red");this.footer.format.z=0;this.subfooter=new ChartTitle(this,"red");this.subfooter.format.z=0;this.zoom=new Zoom(this);this.scroll=new Scroll(this);this.tools=new Tools(this);this.oldPos=new Point;this.pMove=Point.Point(0,0);this.p=new Point(0,0);this.canvas.onpointerdown=this.canvas.ontouchstart=this.domousedown;this.canvas.onpointerup=this.canvas.ontouchend=this.domouseup;this.canvas.onpointermove=this.canvas.ontouchmove=this.domousemove;this.canvas.addEventListener&&this.canvas.addEventListener("DOMMouseScroll",this._doWheel,!1);this.canvas.onmousewheel=this._doWheel;this.canvas.onmouseout=function(t){t&&!t.target.setCapture&&(this.chart.scroll.active=!1);this.chart.series.mouseout();this.chart.tools.mouseout()};this.canvas.chart=this;if(i&&i.length>0)if(i[0]instanceof Array)for(var o=0;o<i.length;o++)newSeries(i[o]);else newSeries(i)}calcMouse(t,i){i.x=t.clientX;i.y=t.clientY;var s,e=this.canvas;if(e.getBoundingClientRect){s=e.getBoundingClientRect();i.x-=s.left;i.y-=s.top}else if(e.offsetParent)do{i.x-=e.offsetLeft;i.y-=e.offsetTop;e=e.offsetParent}while(e)}domousemove(t){var i=this.chart,s=this.chart.pMove;if(!i.ctx)return!1;(t=t||window.event).touches&&(t=t.touches[t.touches.length-1]);i.calcMouse(t,s);if(i.scroll.active){var e,r=i.scroll.direction,h="both"==r;if(h||"horizontal"==r){e=i.axes.bottom.fromSize(i.oldPos.x-s.x);i.axes.top.scroll(e);i.axes.bottom.scroll(e)}if(h||"vertical"==r){e=-i.axes.left.fromSize(i.oldPos.y-s.y);i.axes.left.scroll(e);i.axes.right.scroll(e)}i.oldPos.x=s.x;i.oldPos.y=s.y;i.scroll.done=!0;i.onscroll&&i.onscroll(t);i.scroll.done&&window.requestAnimationFrame((function(){i.draw()}));return!1}if(i.zoom.active){if(s.x!=i.oldPos.x||s.y!=i.oldPos.y){i.zoom.change(s);window.requestAnimationFrame((function(){i.draw()}));i.zoom.done=!0}return!1}i.newCursor=null;i.tools.mousemove(s);i.series.mousemove(s);i.legend.mousemove(s);i.title.mousemove(s);i.mousemove&&i.mousemove(s);var a=this.chart.canvas.style;if(i.newCursor){if(a.cursor!=i.newCursor){i.oldCursor=a.cursor;a.cursor=i.newCursor}}else void 0!==i.oldCursor&&a.cursor!=i.oldCursor&&(a.cursor=i.oldCursor);return!0}domousedown(t){t=t||window.event;var i=!1,s=this.chart,e=this.chart.p;s.calcMouse(t.touches?t.touches[0]:t,e);var r=s.series.anyUsesAxes()&&s.chartRect.contains(e);!function(t){var i,s=t.canvas,e=0;s.addEventListener("touchend",(function(s){var r=(new Date).getTime(),h=r-e;clearTimeout(i);if(h<600&&h>100){t.zoom.reset();t.draw()}else i=setTimeout((function(){clearTimeout(i)}),600);e=r;s.preventDefault()}))}(s);s.zoom.enabled&&function(t,i){var s,e,r,h,a,o,n,l,c,d,u=t.canvas,m=0,f=0,g=0,v=0,x=0,p=0,w=0,b=0,y=0,k=0,S=0,z=0,A=[];e=!1;s=setInterval(M,100);function M(){if(A.length>1){var s=0,u=A[0],M=A[1];if(e){r=u.pageX;a=M.pageX;h=u.pageY;o=M.pageY;if(r>a){s=r;r=a;a=s}if(h>o){s=h;h=o;o=s}f=y-(x=r-n);v=S-(w=h-l);m=k-(p=a-c);g=z-(b=o-d);y=x;S=w;k=p;z=b}else{n=u.pageX;c=M.pageX;l=u.pageY;d=M.pageY;if(n>c){s=n;n=c;c=s}if(l>d){s=l;l=d;d=s}e=!0}"both"!=i.direction&&"horizontal"!=i.direction||T(t.axes.bottom.startPos+f,t.axes.bottom.endPos+m);"both"!=i.direction&&"vertical"!=i.direction||P(t.axes.left.startPos+v,t.axes.left.endPos+g)}}u.addEventListener("touchend",(function(){e&&(e=!1);clearInterval(s)}));u.addEventListener("touchmove",(function(t){t.preventDefault();A=t.touches}));function T(i,s){t.axes.top.calcMinMax(i,s);t.axes.bottom.calcMinMax(i,s);t.draw()}function P(i,s){t.axes.right.calcMinMax(i,s);t.axes.left.calcMinMax(i,s);t.draw()}}(s,s.zoom);r=s.series.anyUsesAxes()&&s.chartRect.contains(e);if(t.touches)if(t.touches.length>1)s.scroll.active=!1;else{s.scroll.active=s.scroll.enabled&&r;s.scroll.active&&(s.zoom.active=!1)}else{s.zoom.active=t.button==s.zoom.mouseButton&&s.zoom.enabled&&r;s.scroll.active=t.button==s.scroll.mouseButton&&s.scroll.enabled&&r}s.zoom.done=!1;s.scroll.done=!1;s.oldPos=e;if(0===t.button){(i=s.tools.mousedown(t))||(i=s.series.mousedown(t))||(i=s.legend.mousedown(t));i||s.mousedown&&(i=s.mousedown(t));s.canvas.oncontextmenu=null}else 2==t.button&&(s.canvas.oncontextmenu=function(){return!1});i?s.zoom.active=s.scroll.active=!1:i=s.zoom.active||s.scroll.active;t.preventDefault?t.preventDefault():t.cancelBubble=!0;if(i){var h=t.target||t.fromElement;h&&h.setPointerCapture&&t.pointerId&&h.setPointerCapture(t.pointerId)}return!i}domouseup(t){t=t||window.event;var i,s=this.chart;s.zoom.active=!1;s.scroll.active=!1;if(s.zoom.done){s.zoom.apply()&&s.onzoom&&s.onzoom();s.draw();i=!0}else if(!(i=s.scroll.done)){(i=s.series.clicked(s.oldPos))||(i=s.tools.clicked(s.oldPos))||(i=s.title.clicked(s.oldPos))&&s.title.onclick&&s.title.onclick(s.title);i||s.mouseup&&(i=s.mouseup(t))}s.zoom.old=null;s.zoom.done=!1;s.scroll.done=!1;i?t.preventDefault?t.preventDefault():t.cancelBubble=!0:s.canvas.oncontextmenu=null;var e=t.target||t.fromElement;e&&e.releasePointerCapture&&t.pointerId&&e.releasePointerCapture(t.pointerId)}_doWheel(t){var i=this.chart;if(i.zoom.wheel.enabled){t=t||window.event;var s=i.zoom.wheel.factor*(t.wheelDelta?t.wheelDelta/120:t.detail?-t.detail/3:0);if(Math.abs(s)>0){var e={x:0,y:0};i.calcMouse(t,e);if(i.chartRect.contains(e)){i.axes.each((function(){!function(t){var i=t.maximum-t.minimum;if(i>0){var e=s*i*.05;t.setMinMax(t.minimum+e,t.maximum-e)}}(this)}));i.draw();t.returnValue=!1;t.preventDefault&&t.preventDefault()}for(h=0;r=i.tools.items[h++];)r instanceof ToolTip&&r.active&&r.mousemove(e)}}else for(var r,h=0;r=i.tools.items[h++];)r instanceof ToolTip&&r.active&&r.hide()}addSeries(t){t.setChart(t,this);null!=t.donutArray&&"undefined"!==t.donutArray&&t.linkDonutsToChart();var i=this.series.items,s=i.indexOf(t);-1==s&&(s=i.push(t)-1);""===t.title&&(t.title="Series"+(1+s).toString());""===t.format.fill&&(t.format.fill=this.palette.get(s));return t}removeSeries(t){var i=this.series.items,s=i.indexOf(t);-1!=i&&i.splice(s,1)}newSeries(t){var i=type||Bar;c.chart.addSeries(new i(c.chart)).data.values=t}getSeries(t){return this.series.items[t]}draw(t){var i=this.series,s=this.chartRect;this.ctx=t||(this.canvas.getContext?this.canvas.getContext("2d"):null);if(!(t=this.ctx))throw"Canvas does not provide Context";Scroller&&this instanceof Scroller&&t.clearRect(0,0,this.canvas.width,this.canvas.height);s.automatic&&s.setFrom(this.bounds);for(var e,r=i.items.length,h=!1,a=!1,o=1,n=i.visibleCount(),l=0;r--;)if((e=i.items[r]).visible){e.initZ(l,n);l++;e._paintAxes&&(h=!0);e._paintWalls&&(a=!0);e.maxZ&&e.maxZ>o&&(o=e.maxZ)}this.walls.left.format.depth=o;this.walls.bottom.format.depth=o;this.walls.back.format.z=o;this.panel.draw();s.automatic&&this.panel.margins.apply(s);this.title.tryDraw(!0);this.subtitle.tryDraw(!0);this.footer.tryDraw(!1);this.subfooter.tryDraw(!1);i.beforeDraw();if(this.legend.visible){this.legend.calcrect();this.legend.draw()}if(this.aspect.view3d&&!this.__webgl){s.y+=this.aspect._orthoy;s.height-=this.aspect._orthoy;s.width-=this.aspect._orthox}var c,d=this.axes;if(this.series.anyUsesAxes()){d.each(Axis.adjustRect);d.each(Axis.calcRect);this.walls.visible&&a&&this.walls.draw(s,this.aspect);if(d.visible&&h){if(d.transparency>0){c=t.globalAlpha;t.globalAlpha=(1-d.transparency)*c}var u=t.beginParent;d.visual=u?t.beginParent():null;d.each(Axis.draw);u&&t.endParent();d.transparency>0&&(t.globalAlpha=c)}}this.series.draw();this.tools.draw();this.zoom.active&&this.zoom.draw();this.ondraw&&this.ondraw(this);if(this.isNLc){var m,f=new Format(this),g="TeeChart Evaluation (c)Steema Software 2018";(t=this.ctx).save();t.font="13px Courier";m=f.textWidth(g);var v={x:this.chartRect.x+this.chartRect.width/2-m/2,y:this.bounds.height/2,width:m,height:f.textHeight("H")};t.translate(this.chartRect.x+this.chartRect.width/2,this.bounds.height/2);t.rotate(-30*Math.PI/180);t.translate(-(this.chartRect.x+this.chartRect.width/2),-this.bounds.height/2);f.font.fill="rgba(64,108,128, 0.55)";f.drawText(v,g);t.restore()}}toImage(t,i,s){var e=document.getElementById(t);e&&(e.src=""!==i?this.canvas.toDataURL(i,s):this.canvas.toDataURL())}}class CustomBar extends Series{constructor(t,i){super(t,i);this.sideMargins=100;this.useOrigin=!0;this.origin=0;this.continuous=!1;this.marks.visible=!0;this.marks.location="end";this.hover.enabled=!0;this.offset=0;this.barSize=70;this.barStyle="bar";this.format.fill="";this.format.stroke.fill="black";this.format.shadow.visible=!0;this.format.round.x=4;this.format.round.y=4;this.format.gradient.visible=!0;this.format.depth=1;this.stacked="no";this.offsetPoint=new Point;this.originPos;this.bar=new Rectangle;this.visibleBar={total:0,index:0};this._margin=0;this.hasPaintedOver=!1}drawBar(t,i){var s=this.format,e=s.depth,r=s.z,h=this.chart.ctx;i||(i=this.barStyle);s.depth=.5*Math.min(this.yMandatory?t.width:t.height,200)/100;if(t.width>0&&t.height>0){"side"!==this.stacked&&(s.z=s.z+.5*(1-s.depth));if("bar"===i)s.cube(t);else if("line"===i){var a;h.beginPath();h.z=s.z+.5*s.depth;if(this.yMandatory){a=t.x+.5*t.width;h.moveTo(a,t.y);h.lineTo(a,t.y+t.height)}else{a=t.y+.5*t.height;h.moveTo(t.x,a);h.lineTo(t.x+t.width,a)}}else if("cylinder"===i)s.cylinder(t,1,this.yMandatory);else if("cone"===i)s.cylinder(t,0,this.yMandatory);else if("ellipsoid"===i&&this.chart.__webgl){h.depth=s.depth;h.z=s.z;h.image=this.image;h.ellipsoid(t,this.yMandatory)}else{s.z+=.5*s.depth;s.ellipsePath(this.chart.ctx,t.x+.5*t.width,t.y+.5*t.height,t.width,t.height)}s.depth=e;s.z=r;return!0}return!1}countAll(t){var i,s,e=this.chart.series.items,r=0,h=e.length;for(i=0;i<h&&((s=e[i])!=this||!t);i++)s.visible&&s.constructor==this.constructor&&(r+=s.data.values.length);return r}calcBarOffset(t){var i=t,s="sideAll"==this.stacked;this.countall=s?this.countAll(!0):0;var e,r=s?this.countAll():this.data.values.length;r>1&&(i/=r);if("no"==this.stacked){i/=this.visibleBar.total;this.offsetPoint.x=i*this.barSize*.01*(1==this.visibleBar.total?-.5:this.visibleBar.index-.5*this.visibleBar.total);e=this.visibleBar.total}else{this.offsetPoint.x=.5*-i;e=1}this.offsetPoint.y=i*this.barSize*.01;this._margin=.5*e*this.offsetPoint.y+this.sideMargins*(e*(i-this.offsetPoint.y))*.005;"no"!=this.stacked&&(this.offsetPoint.x+=this.offset*i*.01+.5*(i-this.offsetPoint.y))}calcStackPos(t,i){var s,e,r;if(this.isStacked){this.calcStack(t,i,this.data.values[t]);s=this.pointOrigin(t,!1),r=this.mandatoryAxis;this.isStack100?0===(e=this.pointOrigin(t,!0))?r.endPos:r.calc(100*s/e):r.calc(s)}else{this.calc(t,i);if("sideAll"==this.stacked){e=this.notmandatory.calc(this.countall+t);this.yMandatory?i.x=e:i.y=e}}}drawSortedValues(t){var i=this.sortedOptions.sortedDrawAnimation;this.format;if(this.sortedOptions.sorted!=t&&!this.sortedOptions.sorting&&i&&!i.running){this.sortedOptions.sorted=t;this.data;this.sortedOptions.sorted&&this.sortValues();var s=this.sortedOptions.sorted?this.sortedOptions.originalValues.slice():this.sortedOptions.sortedValues.slice(),e=this.data.values,r=this.sortedOptions.sorted?this.sortedOptions.sortedValues.slice():this.sortedOptions.originalValues.slice(),h=this,a=this.sortedOptions;i.chart=this.chart;if("horizontalchange"==a.sortingAnimationType){i.doStep=function(t){if(t<1){t;h.draw()}};i.onstop=function(){1;if(a.sorted)for(var t=0;t<s.length;t++)e[t]=r[t]};i.onstart=function(){if(!a.sorted)for(var t=0;t<s.length;t++)e[t]=r[t]}}else{i.doStep=function(t){if(t<1)for(var i=0;i<s.length;i++)e[i]=s[i]+(r[i]-s[i])*t};i.onstop=function(){1;for(var t=0;t<s.length;t++)e[t]=r[t];i.running=!1};i.onstart=function(){i.running=!0}}i.animate();this.data.labels=this.sortedOptions.sorted?this.sortedOptions.sortedLabels.slice():this.sortedOptions.originalLabels.slice();this.chart.draw()}}draw(){var t=this.data.values.length,i=this.format;if(t>0){this.initOffsets();var s=new Point,e=this.chart.ctx;if(!this.hover.enabled){i.stroke.prepare();i.shadow.prepare(e)}var r=this.hover.enabled,h="line"===this.barStyle,a=this.data.styles;if(r&&null!=i.image.url){this.hover.image.url=i.image.url;this.hover.image.repeat=i.image.repeat;this.hover.image.backFill=i.image.backFill}i.z=0;for(var o=0;o<t;o++)if(!this.isNull(o)){this.calcStackPos(o,s);var n=new Point;if(this.percent<1){this.calcStackPos(this.sortedOptions.sortedValuesIndices.findIndex((function(t){return t==o})),n);this.sortedOptions.sorted?s.x=(-s.x+n.x)*percent+s.x:s.x=(s.x-n.x)*percent+n.x}this.calcBarBounds(s,this.bar,this.offsetPoint,this.originPos instanceof Array?this.originPos[o]:this.originPos);var l=this.drawBar(this.bar,a?a[o]:null),c=r&&this.over==o,d=c?this.hover:i;e.fillStyle=this.getFillStyle(this.bar,this.getFill(o,""===d.fill?i:d));i.gradient.visible||(d.fill=e.fillStyle);r&&d.shadow.prepare(e);if(c)if(null==i.image.url||this.hasPaintedOver)e.fill();else{this.hasPaintedOver=!0;i.draw(e,null,this.bar)}if(l){d.draw(e,null,this.bar);if(h||""!==d.stroke.fill){r&&d.stroke.prepare();!c&&h&&(e.strokeStyle=e.fillStyle);e.shadowColor="transparent";e.stroke();d.shadow.visible&&(e.shadowColor=d.shadow.color)}}}}}calcColorEach(){this.chart.series.visibleCount(this,CustomBar,this.visibleBar);this.isColorEach="yes"==this.colorEach||"auto"==this.colorEach&&1==this.visibleBar.total}initOffsets(){var t=this.notmandatory,i=this.mandatoryAxis,s=this.yMandatory?this.maxXValue()-this.minXValue():this.maxYValue()-this.minYValue();"sideAll"==this.stacked?this.calcBarOffset(t.axisSize):this.calcBarOffset(0===s?t.axisSize:t.calcSize(s));if(this.useOrigin)if(this.origin instanceof Array){this.originPos=[];for(var e=0;e<this.origin.length;e++)this.originPos[e]=i.calc(this.origin[e])}else this.originPos=i.calc(this.origin);else this.yMandatory?this.originPos=i.inverted?i.startPos:i.endPos:this.originPos=i.inverted?i.endPos:i.startPos;var r=this.stacked;this.isStacked="no"!==r&&"sideAll"!==r&&"side"!==r;this.isStack100="100"===r}clicked(t){this.initOffsets();var i,s=new Point,e=this.data.values.length;for(i=0;i<e;i++)if(!this.isNull(i)){this.calcStackPos(i,s);this.calcBarBounds(s,this.bar,this.offsetPoint,this.originPos instanceof Array?this.originPos[i]:this.originPos);if(this.bar.contains(t))return i}return-1}markPos(t,i){var s=this.yMandatory,e=this.offsetPoint.x+.5*this.offsetPoint.y,r=this.marks;this.calcStackPos(t,i);if("sideAll"==this.stacked){var h=this.notmandatory.calc(this.countall+t);s?i.x=h:i.y=h}var a=this.useOrigin&&this.data.values[t]<(this.origin instanceof Array?this.origin[t]:this.origin);this.mandatoryAxis.inverted&&(a=!a);if("center"==r.location){this.calcBarBounds(i,bar,this.offsetPoint,originPos instanceof Array?originPos[t]:originPos);r.canDraw(i.x,i.y,t,a)&&(s?i.y=this.bar.y+.5*this.bar.height+.5*r.bounds.height:i.x=this.bar.x+.5*this.bar.width-.5*r.bounds.width)}var o=this.chart.aspect,n=o.view3d,l=0,c=0;if(n&&o.orthogonal){l=.5*o._orthox;c=.5*o._orthoy}if(s){i.x+=n?e+l:e;n&&(i.y-=c)}else{i.y+=n?e-c:e;n&&(i.x+=l)}return a}labelOrTitle(t){var i=this.title,s=this.data.labels[t];return this.visibleBar.total>1?i||s:super.labelOrTitle(t)}initZ(t,i){var s,e=this.format;if("side"!==this.stacked){e.z=0;e.depth=1;for(;t>1;){t--;if((s=this.chart.series.items[t]).visible&&s.constructor==this.constructor){e.z=s.z;e.depth=s.depth;break}}}else Series.prototype.initZ.call(this,t,i);this.marks.format.z=e.z+.5*e.depth}}class Bar extends CustomBar{constructor(t,i){super(t,i)}calc(t,i){this.isStacked?this.calcStack(t,i,this.data.values[t]):super.calc(t,i)}horizMargins(t){this.initOffsets();t.x=this._margin;t.y=this._margin}vertMargins(t){var i=this.marks,s=this.format.stroke,e=this.minYValue()<(this.origin instanceof Array?ArrayMin(this.origin):this.origin);if(i.visible&&"center"!==i.location){t.y=i.arrow.length+i.format.textHeight("Wj")+i.margins.top+i.margins.bottom;s=i.format.stroke}""!==s.fill&&(t.y+=2*s.size+1);e&&(t.x=t.y)}maxXValue(){return"sideAll"===this.stacked?this.countAll()-1:super.maxXValue()}minYValue(){var t=super.minYValue();return this.useOrigin?Math.min(this.origin instanceof Array?ArrayMin(this.origin):this.origin,t):t}maxYValue(){if("sideAll"===this.stacked||"side"===this.stacked){var t,i,s,e=0,r=this.chart.series.items,h=r.length;for(i=0;i<h;i++)(t=r[i]).visible&&t.constructor===this.constructor&&(s=super.maxYValue.call(t))>e&&(e=s);return e}return this.stackMaxValue()}calcBarBounds(t,i,s,e){i.x=t.x+s.x;i.width=s.y;if(this._vertAxis.inverted){i.y=e;i.height=t.y-i.y}else{i.y=t.y;i.height=e-t.y}if(i.height<0){i.y+=i.height;i.height=-i.height}}}class HorizBar extends CustomBar{constructor(t,i){super(t,i);this.yMandatory=!1;this.format.gradient.direction="rightleft"}maxMarkWidth(){var t,i,s,e=0,r=this.marks,h=this.count();if(r.visible){(t=this.marks.format).font.prepare();for(i=0;i<h;i+=r.drawEvery)this.isNull(i)||(s=t.textWidth(this.markText(i)+"W"))>e&&(e=s)}return e}horizMargins(t){var i=this.marks,s=this.format.stroke,e=this.minXValue()<this.origin;if(i.visible&&"center"!==i.location){t.y=i.arrow.length+this.maxMarkWidth()+i.margins.left+i.margins.right;s=i.format.stroke}""!==s.fill&&(t.y+=2*s.size+1);e&&(t.x=t.y)}vertMargins(t){this.initOffsets();t.x+=this._margin;t.y+=this._margin}maxYValue(){return"sideAll"==this.stacked?this.countAll()-1:super.maxXValue.call(this)}minYValue(){return"sideAll"==this.stacked?0:super.minXValue.call(this)}minXValue(){var t=super.minYValue.call(this);return this.useOrigin?Math.min(this.origin,t):t}maxXValue(){return this.stackMaxValue()}calcBarBounds(t,i,s,e){i.y=t.y+s.x;i.height=s.y;if(this._horizAxis.inverted){i.x=t.x;i.width=e-t.x}else{i.x=e;i.width=t.x-i.x}if(i.width<0){i.x+=i.width;i.width=-i.width}}}class Bullet extends HorizBar{constructor(t,i){super([t[0]],i?[i[0]]:[]);this.barSize=25;this.limit={origin:38,width:.2,height:35,color:"red",bar:null};this.marks.visible=!1;this.states={colors:["#111","#444","#777","#BBB","#EEE"],values:[10,10,10,10,10],barStates:[],barSize:50,gradientVisible:!1};this.createStatesBars(this.states,this.origin);this.parentDraw=this.draw}createStatesBars(t,i){var s=0;if(t.values.length>0){t.barStates.push(this.createBarState(t.values[0],s+i,t.barSize,t.colors[0],t.colors[0],t.gradientVisible));s+=t.values[0];for(var e=1;e<t.values.length;e++){t.barStates.push(this.createBarState(t.values[e],s+i,t.barSize,t.colors[(e-1)%t.colors.length],t.colors[e%t.values.length],t.gradientVisible));s+=t.values[e]}}}minValue(){return this.states.barStates.length>=1?this.states.barStates[0].origin:0}maxValue(){return this.states.barStates.length>=1?this.states.barStates[this.states.barStates.length-1].data.values[0]:0}createBarState(t,i,s,e,r,h){var a=new HorizBar([t+i]);a.stacked="side";a.origin=i;a.barSize=s;a.marks.visible=!1;a.format.round.x=0;a.format.round.y=0;a.format.gradient.colors=[e,r];if(h){a.format.gradient.direction="leftright";a.format.gradient.visible=!0}else{a.format.gradient.visible=!1;a.format.fill=r;a.palette.colors=[r]}a.format.shadow.visible=!1;a.format.stroke.fill="rgba(0,0,0,0.0)";return a}draw(){var t,i;t=this.minValue();i=this.maxValue();this.chart.zoom.reset=function(){this.chart.axes.each((function(){this.automatic=!0}));this.chart.axes.bottom.setMinMax(t,i)};this.states.barStates=[];this.createStatesBars(this.states,this.origin);for(var s=0;s<this.states.barStates.length;s++){this.chart&&this.states.barStates[s].setChart(this.states.barStates[s],this.chart);this.states.barStates[s].draw()}this.limit.bar=this.createBarState(this.limit.width,this.limit.origin+this.origin,this.limit.height,this.limit.color,this.limit.color,!1);this.limit.bar.setChart(this.limit.bar,this.chart);this.limit.bar.draw();HorizBar.prototype.draw.call(this)}}class Pointer{constructor(t,i){this.chart=t;this.series=i;this.inflateMargins=!0;this.f=this.format=new Format(t);this.f.shadow.visible=!1;this.f.fill="";this.f.gradient.colors=["white","white","white"];this.f.gradient.visible=!0;this.f.shadow.visible=!0;this.visible=!1;this.colorEach=!1;this.style="rectangle";this.width=12;this.height=12}setChart(t){this.chart=t;this.format.setChart(t)}setSize(t){this.width=t;this.height=t}draw(t,i,s,e){var r=this.chart.ctx;s.z=this.series.format.z;if(this.transform){r.save();this.transform(t.x,t.y,i)}var h,a=.5*this.width,o=.5*this.height;if("cube"==this.style){h={x:t.x-a,y:t.y-o,width:this.width,height:this.height};var n=Math.max(a,o)/50;s.z=.5*(series.format.z+series.format.depth)-.5*n;s.depth=n;s.cube(h);s.draw(r,null,h)}else if("rectangle"==this.style)s.rectangle(t.x-a,t.y-o,this.width,this.height);else if("ellipse"==this.style)s.ellipse(t.x,t.y,this.width,this.height);else if("sphere"==this.style){s.depth=this.series.format.depth;s.sphere(t.x,t.y,this.width,this.height)}else if("cylinder"==this.style){h={x:t.x-a,y:t.y-o,width:this.width,height:this.height};var l=s.gradient,c=l.direction,d=l.colors.slice(0);l.direction="leftright";l.colors=[l.colors[1],l.colors[0],l.colors[1]];s.cylinder(h,1,!0);s.draw(r,null,h);l.direction=c;l.colors=d}else if("cone"==this.style){h={x:t.x-a,y:t.y-o,width:this.width,height:this.height};s.cylinder(h,0,!0);s.draw(r,null,h)}else if("triangle"==this.style)s.polygon([new Point(t.x,t.y-o),new Point(t.x-a,t.y+o),new Point(t.x+a,t.y+o)]);else if("downtriangle"==this.style)s.polygon([new Point(t.x,t.y+o),new Point(t.x-a,t.y-o),new Point(t.x+a,t.y-o)]);else if("diamond"==this.style)s.polygon([new Point(t.x,t.y-o),new Point(t.x-a,t.y),new Point(t.x,t.y+o),new Point(t.x+a,t.y)]);else{r.beginPath();if("cross"==this.style){r.moveTo(t.x-a,t.y);r.lineTo(t.x+a,t.y);r.moveTo(t.x,t.y-o);r.lineTo(t.x,t.y+o)}if("x"==this.style){r.moveTo(t.x-a,t.y-o);r.lineTo(t.x+a,t.y+o);r.moveTo(t.x-a,t.y+o);r.lineTo(t.x+a,t.y-o)}s.stroke.prepare(e);r.stroke()}this.transform&&r.restore()}}class CustomSeries extends Series{constructor(t,i){super(t,i);this.stacked="no";this.stairs=!1;this.invertedStairs=!1;this.continuous=!0;this.hover.enabled=!0;this.hover.line=!1;this.isStacked=!1;this.isStack100=!1;this.smooth=0;this.pointer=new Pointer(this.chart,this)}maxYValue(){return this.stackMaxValue()}calc(t,i){this.isStacked?this.calcStack(t,i,this.data.values[t]):Series.prototype.calc.call(this,t,i)}calcColorEach(){this.isColorEach="yes"==this.colorEach||this.pointer.colorEach}drawSpline(t,i,s,e,r){var h,a=[],o=i.length;function n(t,i,s,e,r,h,a){function o(t){return t*t}var n=Math.sqrt(o(s-t)+o(e-i)),l=a*n/(n+Math.sqrt(o(r-s)+o(h-e))),c=a-l;return[s+l*(t-r),e+l*(i-h),s-c*(t-r),e-c*(i-h)]}if(r){e&&t.moveTo(i[0],i[1]);i.push(i[0],i[1],i[2],i[3]);i.unshift(i[o-1]);i.unshift(i[o-1]);for(h=0;h<o;h+=2)a=a.concat(n(i[h],i[h+1],i[h+2],i[h+3],i[h+4],i[h+5],s));a=a.concat(a[0],a[1]);for(h=2;h<o+2;h+=2)t.bezierCurveTo(a[2*h-2],a[2*h-1],a[2*h],a[2*h+1],i[h+2],i[h+3])}else{for(h=0;h<o-4;h+=2)a=a.concat(n(i[h],i[h+1],i[h+2],i[h+3],i[h+4],i[h+5],s));e&&t.moveTo(i[0],i[1]);t.quadraticCurveTo(a[0],a[1],i[2],i[3]);for(h=2;h<o-5;h+=2)t.bezierCurveTo(a[2*h-2],a[2*h-1],a[2*h],a[2*h+1],i[h+2],i[h+3]);t.quadraticCurveTo(a[2*o-10],a[2*o-9],i[o-2],i[o-1])}}initZ(t,i){var s,e=this.format;if("no"!==this.stacked){e.z=0;e.depth=1;for(;t>1;){t--;if((s=this.chart.series.items[t]).visible&&s.constructor==this.constructor){e.z=s.z;e.depth=s.depth;break}}}else Series.prototype.initZ.call(this,t,i);this.marks.z=e.z+.5*e.depth}drawPointers(){var t=this.data.values.length,i=this.pointer.format,s="yes"==this.colorEach||this.pointer.colorEach;s||""===i.fill&&(i.fill=this.format.fill);var e,r=new Point,h=i.gradient,a=i.fill,o=a;!s&&h.visible&&h.setEndColor(a);for(e=0;e<t;e++)if(!this.isNull(e)){this.calc(e,r);if((a=this.getFill(e,i))!=o){h.visible?h.setEndColor(a):i.fill=a;o=a}this.getSize(e);this.onbeforedrawpointer&&this.onbeforedrawpointer(e,this.pointer);this.pointer.draw(r,e,i,a);this.hover.enabled&&this.over==e&&this.pointer.draw(r,e,this.hover,a)}s&&(i.fill=o)}setChart(t,i){(0,Series.prototype.setChart)(t,i);t.pointer.setChart(i)}clicked(t){var i,s=new Point,e=new Point,r=this.data.values.length;if(this.drawLine&&r>0&&(this.hover.line||!this.pointer.visible)){this.calc(0,s);for(i=1;i<r;i++){this.calc(i,e);if(this.stairs){var h;h=this.invertedStairs?new Point(e.x,s.y):new Point(s.x,e.y);if(Point.pointInLine(t,s,h,3)||Point.pointInLine(t,h,e,3))return i}else if(Point.pointInLine(t,s,e,3))return i;s.x=e.x;s.y=e.y}}if(this.pointer.visible){var a=new Rectangle,o=this.pointer;for(i=r-1;i>=0;i--)if(!this.isNull(i)){this.calc(i,a);this.getSize(i);a.x-=.5*o.width;a.width=o.width;a.y-=.5*o.height;a.height=o.height;if(a.contains(t))return i}}return-1}horizMargins(t){var i=this.pointer,s=i.format.stroke;i.visible&&i.inflateMargins&&(t.x=t.y=(""!==s.fill?s.size:0)+1+.5*i.width)}vertMargins(t){var i=this.pointer,s=i.format.stroke;i.visible&&i.inflateMargins&&(t.x=t.y=(""!==s.fill?s.size:0)+1+.5*i.height)}getSize(){}}class Line extends CustomSeries{constructor(t,i){super(t,i);this.drawLine=!0;this.treatNulls="dontPaint";this.format;this.format.shadow.visible=!0;this.format.shadow.blur=10;this.format.lineCap="round"}doDrawLine(t){var i,s,e,r,h,a=new Point,o=this.data.values.length,n=0,l=o,c=this.notmandatory;if(!this.smooth&&!this.data.x){n=Math.max(0,trunc(c.minimum)-1);l=Math.min(o,trunc(c.maximum)+2)}var d=this.chart.aspect.view3d;t.beginPath();if(this.smooth>0){r=new Array(2*o);for(e=0;e<o;e++){this.calc(e,a);r[2*e]=a.x;r[2*e+1]=a.y}t.spline?t.spline(r):super.drawSpline(t,r,this.smooth,!0)}else{var u="skip"!==this.treatNulls;for(e=n;e<l;e++)if(this.isNull(e))u&&(n=-1);else{this.calc(e,a);if(e==n||-1===n){t.moveTo(a.x,a.y);n=0}else if(this.stairs){this.invertedStairs?t.lineTo(a.x,s):t.lineTo(i,a.y);t.lineTo(a.x,a.y)}else t.lineTo(a.x,a.y);i=a.x;s=a.y}}var m=this.format.stroke;this.chart.isChrome&&this.format.shadow.visible&&(m.size=Math.max(1.1,m.size));t.z=this.format.z;t.depth=this.format.depth;""===(h=m.fill)&&(h=this.format.fill);m.prepare(h);this.format.shadow.prepare(t);if(d){t.fillStyle=this.format.fill;t.fill()}""!==h&&t.stroke()}draw(){if(this.data.values.length>0){this.isStacked="no"!=this.stacked;this.isStack100="100"==this.stacked;this.drawLine&&this.doDrawLine(this.chart.ctx);this.pointer.visible&&this.drawPointers()}}}class PointXY extends Line{constructor(t,i){super(t,i);this.hover.enabled=!0;this.pointer.visible=!0;this.drawLine=!1}}class Pie extends Series{constructor(t,i){super(t,i);this.marks.style="percent";this.donut=0;this.rotation=0;this.colorEach="yes";this.useAxes=!1;this.continuous=!1;this.angleWidth=360;this.maxRadius=100;this.format;this.format.stroke.fill="black";this.format.shadow.visible=!0;this.format.gradient.visible=!0;this.format.gradient.direction="radial";this.format.gradient.colors=["white","white","white"];this.hover.enabled=!0;this.sort="values";this.orderAscending=!1;this.explode=null;this.marks.visible=!0;this.concentric=!1;this.clockwise=!0;this.total,this.piex,this.piey,this.radius,this.donutRadius,this.center={x:0,y:0},this.sorted,this.angle,this.endAngle,this.hoverang;this.r=new Rectangle}getValue(t){return this.data.values[t]}calcCenter(t,i,s,e){if(this.explode){var r=this.explode[t];if(r){r=i*r*.01;e.x+=r*Math.cos(s);e.y+=r*Math.sin(s)}}}clicked(t){var i,s,e=this.chart.ctx,r=this.data.values.length;if(e.isPointInPath){this.endAngle=this.angle=Math.PI*this.rotation/180;for(i=0;i<r;i++){s=this.sorted?this.sorted[i]:i;if(!this.isNull(s)){this.slice(e,s);if(e.isPointInPath(t.x,t.y))return s}}}return-1}calcPos(t,i){i.x=this.center.x+Math.cos(t)*this.donutRadius;i.y=this.center.y+Math.sin(t)*this.donutRadius}getCenter(t){t.x=this.center.x;t.y=this.center.y;return radius}slice(t,i){var s=new Point,e=2*Math.PI*(Math.abs(this.data.values[i])/this.total)/(360/this.angleWidth);this.endAngle+=this.clockwise?e:-e;this.center.x=this.piex;this.center.y=this.piey;this.calcCenter(i,this.radius,.5*(this.angle+this.endAngle),this.center);if(0===this.donut){s.x=this.center.x;s.y=this.center.y}else this.calcPos(this.angle,s);if(this.chart.__webgl){this.calcPos(2*Math.PI-angle,s);t.slice(s,this.center,this.radius,this.angle,this.endAngle,this.donutRadius,this.format.tube,this.format.beveled)}else{t.beginPath();t.moveTo(s.x,s.y);t.arc(this.center.x,this.center.y,this.radius,this.angle,this.endAngle,!this.clockwise);if(0!==this.donut){this.calcPos(this.endAngle,s);t.lineTo(s.x,s.y);t.arc(this.center.x,this.center.y,this.donutRadius,this.endAngle,this.angle,this.clockwise)}t.closePath()}i==this.over&&(this.hoverang=this.angle);this.angle=this.endAngle}fill(t){return this.getFillStyle(new Rectangle(this.center.x-this.radius,this.center.y-this.radius,2*this.radius,2*this.radius),this.getFill(t))}slices(t){var i,s,e=this.chart.ctx,r=this.data.values.length;this.endAngle=this.angle=Math.PI*this.rotation/180;e.z=.5;e.depth=1;for(i=0;i<r;i++){s=this.sorted?this.sorted[i]:i;if(!this.isNull(s)){this.slice(e,s);t?this.format.shadow.prepare(e):e.fillStyle=this.fill(s);e.fill();if(!t){var h=this.format.stroke;if(""!==h.fill){h.prepare();e.stroke()}}}}}draw(){var t=this.data.values.length;let i=new Rectangle;if(t>0){var s=0,e=this.marks;this.format.shadow.visible&&(s+=2*this.format.shadow.height);if(e.visible){e.format.font.prepare();s+=e.format.textHeight("Wj")+.5*e.arrow.length}this.cellRect(i,!this.concentric,Pie);this.piex=i.x+.5*i.width;this.piey=i.y+.5*i.height;this.radius=.5*i.width;var r=.5*(i.height-2*s);r<0&&(r=0);r<this.radius&&(this.radius=r);this.donutRadius=this.radius*this.donut*.01;this.radius=this.radius/(100/this.maxRadius);this.total=ArraySumAbs(this.data.values);this.sorted=this.doSort(this.sort,this.orderAscending);this.chart.__webgl||this.slices(!0);this.slices(!1);if(this.hover.enabled&&-1!=this.over){var h=this.hover;if(""!==h.stroke.fill){this.endAngle=this.angle=this.hoverang;var a=this.chart.ctx;this.slice(a,this.over);a.fillStyle=this.fill(this.over);h.draw(a,null,i)}}}}drawMarks(){Math.PI,this.rotation;var t,i,s,e,r=this.data.values,h=r.length;this.marks.format.z=.5;for(s=0;s<h;s+=this.marks.drawEvery){i=this.sorted?this.sorted[s]:s;if(!this.isNull(i)){e=2*Math.PI*(Math.abs(r[i])/this.total);this.endAngle+=this.clockwise?e:-e;t=.5*(this.angle+this.endAngle);this.center.x=this.piex;this.center.y=this.piey;this.calcCenter(s,this.radius,t,this.center);this.marks.drawPolar(this.center,this.radius,t,i);this.angle=this.endAngle}}}}class Area extends CustomSeries{constructor(t,i){super(t,i);this.useOrigin=!1;this.origin=0;this.drawLine=!0;this.closeArea=!0;this.format.shadow.visible=!0;this.format.lineCap="round";this.format.stroke.fill="black";this.format.fill="";this.format.beveled=!0;this.format.depth=1;this.format.z=.5;this.r=new Rectangle}draw(){var t=this.data.values.length;if(t>0){var i,s=this.mandatoryAxis,e=this.notmandatory,r=this.yMandatory;i=this.useOrigin?s.calc(this.origin):r&&s.inverted||!r&&!s.inverted?s.startPos:s.endPos;this.isStacked="no"!=this.stacked;this.isStack100="100"==this.stacked;var h,a,o,n,l,c=new Point,d=this.chart.ctx,u=this.isStacked,m=0,f=t;if(!this.smooth&&!this.data.x){m=Math.max(0,trunc(e.minimum)-1);f=Math.min(t,trunc(e.maximum)+2)}d.depth=this.format.depth;d.z=this.format.z;d.beginPath();if(this.smooth>0){n=new Array(2*t);for(o=0;o<t;o++){this.calc(o,c);n[2*o]=c.x;n[2*o+1]=c.y}h=r?n[0]:n[1];d.spline?d.spline(n,!0):super.drawSpline(d,n,this.smooth,!0);if(u){var g=0;for(o=t-1;o>=0;o--){this.calcStack(o,c,0);n[g++]=c.x;n[g++]=c.y}d.lineTo(n[0],n[1]);d.spline?d.spline(n,!0):super.drawSpline(d,n,this.smooth,!1)}}else{this.calc(m,c);d.moveTo(c.x,c.y);h=r?c.x:c.y;a=r?c.y:c.x;if(this.stairs)for(o=m+1;o<f;o++){this.calc(o,c);d.lineTo(c.x,a);d.lineTo(c.x,c.y);a=r?c.y:c.x}else for(o=m+1;o<f;o++){this.calc(o,c);d.lineTo(c.x,c.y)}}if(u){if(0===this.smooth)for(o=f-1;o>=m;o--){this.calcStack(o,c,0);if(this.stairs){d.lineTo(c.x,a);d.lineTo(c.x,c.y);a=r?c.y:c.x}else d.lineTo(c.x,c.y)}}else if(r)if(this.closeArea){d.lineTo(c.x,i);d.lineTo(h,i)}else l=c;else{d.lineTo(i,c.y);d.lineTo(i,h)}if(!this.closeArea){var v=this.format.stroke,x=v.fill;v.prepare(x);d.stroke();d.lineTo(l.x,i);d.lineTo(h,i);var p=this.format.stroke.fill;this.format.stroke.fill="#00FF0000"}d.closePath();var w=this.format.gradient;w.visible&&(w.colors[w.colors.length-1]=this.format.fill);this.bounds(this.r);d.__webgl&&(d.beveled=this.format.beveled);this.format.draw(d,null,this.r);this.closeArea||(this.format.stroke.fill=p);this.pointer.visible&&this.drawPointers()}}minYValue(){var t=this.yMandatory?Series.prototype.minYValue.call(this):Series.prototype.minXValue.call(this);return this.yMandatory&&this.useOrigin?Math.min(t,this.origin):t}minXValue(){var t=this.yMandatory?Series.prototype.minXValue.call(this):Series.prototype.minYValue.call(this);return this.yMandatory?t:this.useOrigin?Math.min(t,this.origin):t}maxYValue(){var t=this.yMandatory?this.stackMaxValue():Series.prototype.maxXValue.call(this);return this.yMandatory&&this.useOrigin?Math.max(t,this.origin):t}maxXValue(){var t=this.yMandatory?Series.prototype.maxXValue.call(this):this.stackMaxValue();return this.yMandatory?t:this.useOrigin?Math.max(t,this.origin):t}vertMargins(t){this.yMandatory&&""!==this.format.stroke.fill&&(t.y+=this.format.stroke.size+2)}horizMargins(t){this.yMandatory||""===this.format.stroke.fill||(t.y+=this.format.stroke.size+2)}}class HorizArea extends Area{constructor(t,i){super(t,i);this.yMandatory=!1}}class Donut extends Pie{constructor(t,i){super(t,i);this.lessDonutWidth=100;this.donut=50}refreshWidth(){if(this.concentric){donutArray=this.chart.series.items;for(var t=0,i=0,s=0;s<donutArray.length;s++)donutArray[s].visible&&t++;100==lessDonutWidth&&getLessDonutWidth();for(s=0;s<donutArray.length;s++)if(donutArray[s].visible){donutArray[s].donut=lessDonutWidth+i*((100-lessDonutWidth)/t);i++}}}getLessDonutWidth(){for(var t=0;t<donutArray.length;t++)donutArray[t].donut<lessDonutWidth&&(lessDonutWidth=donutArray[t].donut)}}class ActivityGauge extends Donut{constructor(t,i){super(t,i);this.data={values:null!=t?t:[],labels:null!=i?i:[]};this.donutArray=[];this.maxWidth=230;this.maxDrawWidth=this.maxWidth;if(null!=t)for(var s=0;s<t.length;s++){var e=40+60*s/t.length,r=40+60*(s+1)/t.length,h=Math.abs(this.maxDrawWidth*t[t.length-1-s]/this.maxValue());this.donutArray.push(createDonut(t[t.length-1-s],i[t.length-1-s],e,r,h))}}addRandom(t){for(var i=0;i<t;i++)this.add(Math.floor(20*Math.random()+10),String.fromCharCode(65+i));return this}maxValue(){for(var t=this.data.values[0],i=0;i<this.data.values.length;i++)t<this.data.values[i]&&(t=this.data.values[i]);return t}clicked(t){for(var i=-1,s=0;s<this.donutArray.length&&-1==i;){-1==i&&-1!=this.donutArray[s].clicked(t)&&(i=this.donutArray.length-s-1);s++}return i}createDonut(t,i,s,e,r){var h=new Donut([t],[i]);h.concentric=!0;h.marks.visible=!1;h.format.shadow.visible=!1;h.format.gradient.visible=!1;h.donut=s;h.maxRadius=e;h.angleWidth=r;h.rotation=270;h.visible=!1;return h}copyFormat(t,i,s){var e=t.format,r=i.format;e.fill=i.chart.palette.colors[i.donutArray.length-1-s%i.chart.palette.colors.length];e.font.baseLine=r.font.baseLine;e.font.fill=r.font.fill;e.font.style=r.font.style;e.font.textAlign=r.font.textAlign;e.gradient.colors=[r.gradient.colors[0][s]];e.gradient.direction=r.gradient.direction;e.gradient.offset.x=r.gradient.offset.x;e.gradient.offset.y=r.gradient.offset.y;e.gradient.stops=r.gradient.stops;e.gradient.visible=r.gradient.visible;e.round.x=r.round.x;e.round.y=r.round.y;e.shadow.blur=r.shadow.blur;e.shadow.color=r.shadow.color;e.shadow.height=r.shadow.height;e.shadow.visible=r.shadow.visible;e.shadow.width=r.shadow.width;e.stroke.fill=r.stroke.fill.slice(0);e.stroke.cap=r.stroke.cap;e.stroke.dash=r.stroke.dash;e.stroke.join=r.stroke.join;e.stroke.size=r.stroke.size;e.transparency=r.transparency;t.fill=function(t){return e.gradient.visible?e.gradient.colors:e.fill}}recalcWidth(){for(var t=0;t<this.donutArray.length;t++){this.donutArray[t].donut=40+60*t/this.data.values.length;this.donutArray[t].maxRadius=40+60*(t+1)/this.data.values.length;this.donutArray[t].angleWidth=Math.abs(this.maxDrawWidth*this.data.values[this.data.values.length-1-t]/this.maxValue())}}minValue(){for(var t=this.data.values[0],i=0;i<this.data.values.length;i++)t>this.data.values[i]&&(t=this.data.values[i]);return t}add(t,i){var s=this.createDonut(t,i,0,0,0);this.donutArray.push(s);this.data.values.push(t);this.data.labels.push(i);null!=this.chart&&this.linkDonutsToChart()}draw(){for(var t=0;t<this.donutArray.length;t++){var i=this.donutArray[t].chart.ctx;this.copyFormat(this.donutArray[t],this,t);i.fillStyle=this.donutArray[t].getFillStyle(this.donutArray[t].chart.chartRect,this.donutArray[t].format.fill);this.recalcWidth();this.donutArray[t].draw()}}linkDonutsToChart(){for(var t=0;t<this.donutArray.length;t++)this.donutArray[t].setChart(this.donutArray[t],this.chart)}}class Gantt extends Series{constructor(t,i){super(t,i);this.yMandatory=!1;this.dateFormat="mediumDate";this.hover.enabled=!0;this.hover.round.x=this.hover.round.y=8;this.nextTasks=[];this.nextTasksStrokeStyle="Black";this.nextTasksPosition="back";this.colorEach="yes";this.data.start=this.data.values;this.data.x=[];this.data.end=[];this.height=70;this.margin=new Point(6,6);this.continuous=!1;this.f=this.format;this.f.shadow.visible=!0;this.f.round.x=this.f.round.y=8;this.f.stroke.fill="black";this.f.gradient.visible=!0;this.r=new Rectangle}addNextTask(t,i){this.nextTasks.push([t,i])}addRandom(t){t||(t=5);var i=this.data;i.x.length=t;i.start.length=t;i.end.length=t;if(t>0)for(var s,e,r=0;r<t;r++){i.x[r]=r;s=trunc(12*Math.random());e=trunc(10*Math.random());i.start[r]=new Date(2012,s,e);s<5&&(s=5+trunc(7*Math.random()));i.end[r]=new Date(2012,s,e+10*Math.random())}}bounds(t,i){if(this.isNull(t))return!1;this.calc(t,i);i.y-=.5*this._h;i.width=this.data.end?this.mandatoryAxis.calcSize(this.data.end[t]-this.data.start[t]):0;i.height=this._h;return!0}add(t,i,s,e){var r=this.data;r.labels.push(i);r.x.push(t);r.start.push(s);r.end.push(e)}clicked(t){var i,s=this.data.values.length;for(i=0;i<s;i++)if(this.bounds(i,this.r)&&this.r.contains(t))return i;return-1}draw(){var t,i,s=this.data.values.length,e=this.hover,r=e.fill,h=this.chart.ctx,a=[];"back"==this.nextTasksPosition&&o(this);this._h=this.notmandatory.calcSize(.01*this.height);for(t=0;t<s;t++)if(this.bounds(t,this.r)){(i=e.enabled&&this.over===t?e:this.f).fill=this.getFillStyle(this.r,this.getFill(t,i));i.rectangle(this.r)}e.fill=r;"front"==this.nextTasksPosition&&o(this);function o(t){for(var i=0;i<t.nextTasks.length;i++){h.beginPath();h.strokeStyle=t.nextTasksStrokeStyle;h.lineWidth=2;h.fillStyle="000000";a.push(Math.round(t.chart.axes.bottom.calc(t.data.end[t.nextTasks[i][0]])));a.push(Math.round(t.chart.axes.left.calc(t.data.x[t.nextTasks[i][0]])));a.push(Math.round(t.chart.axes.bottom.calc(t.data.start[t.nextTasks[i][1]])));a.push(Math.round(t.chart.axes.left.calc(t.data.x[t.nextTasks[i][1]])));h.moveTo(a[0],a[1]);h.lineTo(a[0]-(a[0]-a[2])/2,a[1]);h.lineTo(a[0]-(a[0]-a[2])/2,a[3]);h.lineTo(a[2],a[3]);h.stroke();a=[]}}}horizMargins(t){t.x=this.margin.x;t.y=this.margin.y}minYValue(){return super.minXValue.call(this)-.5}maxYValue(){return super.maxXValue.call(this)+.5}minXValue(){return ArrayMin(this.data.start)}maxXValue(){return ArrayMax(this.data.end)}}class Bubble extends PointXY{constructor(t,i){super(t,i);this.p=this.pointer;this.p.colorEach=!0;this.p.style="sphere";this.p.format.gradient.visible=!0;this.p.format.gradient.direction="radial";this.inflate=!0;this.data.radius=[]}initZ(t,i){var s,e=this.format;if("no"!==this.stacked){e.z=0;e.depth=1;for(;t>1;){t--;if((s=this.chart.series.items[t]).visible&&s.constructor==this.constructor){e.z=s.z;e.depth=s.depth;break}}}else Series.prototype.initZ.call(this,t,i);this.marks.z=e.z+.5*e.depth}getSize(t){var i=this.data.radius?this._vertAxis.calcSize(this.data.radius[t]):0;this.pointer.width=i;this.pointer.height=i}horizMargins(t){this.calcWidth=function(t){this.getSize(t);var i=1+.5*this.pointer.width,s=this.pointer.format.stroke;""!==s.fill&&(i+=s.size);return i};if(this.pointer.visible&&this.inflate){t.x=this.calcWidth(0);t.y=this.calcWidth(this.count()-1)}}vertMargins(t){this.calcHeight=function(t){this.getSize(t);var i=1+.5*this.pointer.height,s=this.pointer.format.stroke;""!==s.fill&&(i+=s.size);return i};if(this.pointer.visible&&this.inflate){var i,s,e=0,r=0,h=this.count(),a={x:0,y:0};if(h>0){this.calc(0,a);i=s=a.y;for(var o=1;o<h;o++){this.calc(o,a);a.y<i?e=o:a.y>s&&(r=o)}t.x=this.calcHeight(r);t.y=this.calcHeight(e)}}}addRandom(t){var i=this.data;t||(t=5);i.values.length=t;i.x=null;i.radius=[];i.radius.length=t;if(t>0)for(var s=0;s<t;s++){i.values[s]=1e3*Math.random();i.radius[s]=50+150*Math.random()}}}class Volume extends Bar{constructor(t,i){super(t,i);this.barStyle="line";this.marks.visible=!1;this.colorEach=!1;var s=this.format;s.shadow.visible=!1;s.gradient.visible=!1;s.stroke.fill=""}}class Candle extends PointXY{constructor(t,i){super(t,i);this.f=this.format;this.f.z=.5;this.f.depth=.1;this.pointer.width=7;this.pointer.format.stroke.visible=!1;this.hi=this.higher=this.pointer.format;this.hi.fill="green";this.lo=this.lower=new Format(this.chart);this.lo.fill="red";this.lo.stroke.visible=!1;this.style="candle"}setChart(t,i){(0,PointXY.prototype.setChart)(t,i);this.lo.setChart(i)}draw(){var t,i,s,e,r,h,a,o,n,l=this.data,c=l.values.length,d=new Point,u=this.pointer,m=.5*u.width,f=this.mandatoryAxis,g=this.chart.ctx;g.z=this.f.z+.5*this.f.depth;for(t=0;t<c;t++)if(!this.isNull(t)){this.calc(t,d);o=d.x;i=f.calc(l.open[t]);s=f.calc(l.high[t]);e=f.calc(l.low[t]);if(d.y>i){r=i;h=d.y-i;a=this.lo}else{h=i-(r=d.y);a=this.hi}if("bar"==this.style){g.beginPath();g.moveTo(o,s);g.lineTo(o,e);g.moveTo(o-m,i);g.lineTo(o,i);g.moveTo(o,d.y);g.lineTo(o+m,d.y);a.stroke.prepare(a.fill);g.stroke()}else{a.depth=m/100;a.z=this.f.z+.5*this.f.depth-.5*a.depth;n={x:o-m,y:r,width:u.width,height:h};"cylinder"===this.pointer.style?a.cylinder(n,1,!0):a.cube(n);a.draw(g,null,n);this.hover.enabled&&this.over==t&&this.hover.rectangle(o-m,r,u.width,h)}if("openclose"!=this.style&&(s<r||e>r+h)){g.z=this.f.z+.5*this.f.depth;g.beginPath();g.moveTo(o,r);g.lineTo(o,s);g.moveTo(o,r+h);g.lineTo(o,e);this.hover.enabled&&this.over==t?this.hover.stroke.prepare(a.fill):a.stroke.prepare(a.fill);g.stroke()}}}minYValue(){return this.data.low.length>0?ArrayMin(this.data.low):0}maxYValue(){return this.data.high.length>0?ArrayMax(this.data.high):0}addRandom(t){var i=this.data;t||(t=10);i.values.length=t;i.close=i.values;i.open?i.open.length=t:i.open=new Array(t);i.high?i.high.length=t:i.high=new Array(t);i.low?i.low.length=t:i.low=new Array(t);if(t>0)for(var s,e=25+100*Math.random(),r=0;r<t;r++){s=i.open[r]=e;e=i.close[r]=e+25*Math.random()-12.5;i.high[r]=Math.max(s,e)+15*Math.random();i.low[r]=Math.min(s,e)-15*Math.random()}}clicked(t){var i,s,e,r=this.pointer.width,h=this.mandatoryAxis,a=this.notmandatory,o=this.data,n=o.values.length,l=new Rectangle;l.width=r;for(i=0;i<n;i++)if(!this.isNull(i)){l.x=a.calc(i)-.5*r;s=h.calc(o.open[i]),e=h.calc(o.close[i]);l.y=s>e?e:s;l.height=Math.abs(s-e);if(l.contains(t))return i}return-1}vertMargins(){}}class Polar extends CustomSeries{constructor(t,i){super(t,i);this.pointer.visible=!0;this.rotation=0;this._paintAxes=!1;this._paintWalls=!1;this.continuous=!1;this.useOrigin=!1;this.origin=0;this.p={x:0,y:0};this.pp;this.center={x:0,y:0};this.radius;this.pi180=Math.PI/180;this.format.stroke.fill="black";this.format.z=.5}calc(t,i){var s=this.data,e=s.values[t],r=this.mandatoryAxis,h=s.x?s.x[t]:360*t/s.values.length,a=r.inverted?r.maximum-e:e-r.minimum,o=this.pi180*(this.rotation+h),n=a*this.radius/(r.maximum-r.minimum);i.x=this.center.x+Math.cos(o)*n;i.y=this.center.y+Math.sin(o)*n}tryDrawAxis(t,i,s){if(t.visible){var e=t.axisPos;t.axisPos=i;t.startPos=s-this.radius;t.endPos=s+this.radius;var r=t.z;t.z=1-.5*t.chart.walls.back.size-.1;t.drawAxis();t.axisPos=e;t.z=r}}calcCenter(t,i){var s=t.width,e=t.height;this.center.x=t.x+.5*s;this.center.y=t.y+.5*e;this.radius=.5*Math.min(s,e);if(i.visible&&i.labels.visible){var r=i.labels.format.textHeight("W");this.radius-=r}}beforeDraw(){var t;this.calcCenter(this.chart.chartRect,this.notmandatory);var i=this.chart.walls;if(i.visible){var s=i.back;if(s.visible){var e=s.format;t=e.z;e.z=1;e.ellipse(this.center.x,this.center.y,2*this.radius,2*this.radius);e.z=t}}if(this.chart.axes.visible){var r,h=this.notmandatory,a=h.grid.format.stroke,o=this.mandatoryAxis,n=0,l=this.chart.ctx,c=10,d=h.rotation||0;if(h.visible&&h.labels.visible){var u={x:0,y:0,width:0,height:0},m=h.labels.format,f=m.textHeight("W"),g=this.radius+.8*f;c=Math.max(10,90/trunc(this.radius/f));t=m.z;m.z=.6;n=0;for(;n<360;){r=this.pi180*(n+d);u.x=this.center.x+Math.cos(r)*g;u.y=this.center.y+Math.sin(r)*g-.5*f;m.drawText(u,""+n);n+=c}m.z=t}if(h.visible&&h.grid.visible){var v=h.increment||10;l.z=1-.5*i.back.size-.1;l.beginPath();n=0;for(;n<360;){r=this.pi180*(n+d);l.moveTo(this.center.x,this.center.y);l.lineTo(this.center.x+Math.cos(r)*this.radius,this.center.y+Math.sin(r)*this.radius);n+=v}a.prepare(a.fill,l);l.stroke()}if(o.visible&&o.grid.visible){n=o.roundMin();var x,p=o.grid.format,w=2*this.radius/(o.maximum-o.minimum);t=p.z;p.z=1-.5*i.back.size-.1;l.z=p.z;for(;n<o.maximum;){x=(n-o.minimum)*w;p.ellipse(this.center.x,this.center.y,x,x);n+=o.increm}p.z=t}this.tryDrawAxis(o,this.center.x,this.center.y);this.tryDrawAxis(h,this.center.y,this.center.x)}}draw(){this.calcCenter(this.chart.chartRect,this.notmandatory);var t,i=this.data.values.length;this.pp=[];for(t=0;t<i;t++)if(!this.isNull(t)){this.calc(t,this.p);this.pp.push({x:this.p.x,y:this.p.y})}if((i=this.pp.length)>0){if("bar"==this.style){var s=this.chart.ctx;s.beginPath();for(t=0;t<i;t++){s.moveTo(this.center.x,this.center.y);s.lineTo(this.pp[t].x,this.pp[t].y)}this.format.stroke.prepare(this.format.fill,s);s.stroke()}else this.format.polygon(this.pp);this.pointer.visible&&this.drawPointers()}}minYValue(){var t=Series.prototype.minYValue.call(this);return this.useOrigin?Math.min(t,this.origin):t}maxYValue(){var t=this.stackMaxValue();return this.useOrigin?Math.max(t,this.origin):t}}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});class PaletteSeries extends Series{constructor(t,i){super(t,i);this.palette.colors=Palette.RainbowPalette();this.rgb,this.numcolors;this._min=0;this._range=0}prepareColors(){var t,i=palette.colors;numcolors=i.length;rgb=new Array(numcolors);for(var s=0;s<numcolors;s++)if(7==(t=i[s].trim()).length)rgb[s]={r:parseInt(t.substr(1,2),16),g:parseInt(t.substr(3,2),16),b:parseInt(t.substr(5,2),16),a:0};else if("rgb("==t.substr(0,4)){var e=t.slice(4,t.length-1).split(",");rgb[s]={r:e[0],g:e[1],b:e[2],a:e[3]||0}}}getColor(t){var i=(numcolors-1)*((t-this._min)/this._range)|0;return rgb[palette.inverted?numcolors-1-i:i]}legendCount(){return this.palette.colors?this.palette.colors.length:0}legendColor(t){var i=this.palette,s=i.colors,e=i.inverted;this.chart.legend.inverted&&(e=!e);if(i.grayScale){var r=255*t/s.length|0;e&&(r=255-r);return"rgb("+r+","+r+","+r+")"}return s?s[e?t:this.legendCount()-t-1]:this.format.fill}legendText(t){t=-1+this.legendCount()-t;return(this._min+t*this._range/(this.palette.colors.length-1)).toFixed(this.decimals)}}var arrowtt,arrowStyleBefore,arrowStyleAfter,arrowBorderWidth,tip,previousIndex,previousNearestSeries,domStylesBorderColor,domStylesBackgroundColor,arrowBorderRadius,tt,ttstyle,h,animation,target,width,arrowWidth,followCursor,alpha,ie,DOMTip=(arrowWidth=8,followCursor=!1,alpha=0,ie=!("undefined"==typeof document||!document.all),{show:function(t,i,s,e,r){if(r){tip=r;if(!r.findPoint){arrowWidth=0;followCursor=!0}}if(!tt){arrowStyleAfter=document.createElement("style");arrowStyleBefore=document.createElement("style");domStylesBorderColor="";tt=document.createElement("div");arrowtt=document.createElement("div");tt.setAttribute("id","teetip1");arrowtt.setAttribute("id","teetiparrow1");tt.className="teetip";arrowtt.className="teetiparrow";tt.setAttribute("style",e);domStylesBorderColor=tt.style.getPropertyValue("border-color");domStylesBackgroundColor=tt.style.getPropertyValue("background-color");arrowBorderWidth=tt.style.getPropertyValue("border-width");arrowBorderRadius=(arrowBorderRadius=tt.style.getPropertyValue("border-radius")).substring(0,arrowBorderRadius.length-2);if(0==arrowBorderWidth.length)arrowBorderWidth=0;else{arrowBorderWidth=arrowBorderWidth.substring(0,arrowBorderWidth.length-2);arrowBorderWidth*=2}arrowStyleBefore.innerHTML=".teetiparrow{width:0;height:0;border: "+arrowWidth+"px solid;position: absolute;content: '';border-color: "+domStylesBorderColor+" transparent transparent transparent;bottom: -"+2*arrowWidth+"px;left: 25px;}";arrowStyleAfter.innerHTML=".teetiparrow:after{content: ' ';position: absolute;width: 0;height: 0;left: -"+(arrowWidth-arrowBorderWidth/2)+"px;bottom: "+(arrowBorderWidth-(arrowWidth-1))+"px; border: "+(arrowWidth-arrowBorderWidth/2)+"px solid;border-color: "+domStylesBackgroundColor+" transparent transparent transparent;}";document.head.appendChild(arrowStyleBefore);document.head.appendChild(arrowStyleAfter);document.body.appendChild(tt);tt.appendChild(arrowtt);(ttstyle=tt.style).opacity=0;ie&&(ttstyle.filter="alpha(opacity=0)")}target=s;ttstyle.display="block";ttstyle.position="absolute";tt.innerHTML=arrowtt.outerHTML+t;ttstyle.width=i?i+"px":"auto";!i&&ie&&(ttstyle.width=tt.offsetWidth);tt.offsetWidth>300&&(ttstyle.width="300px");width=tt.offsetWidth;h=parseInt(tt.offsetHeight,10)+3;tt.timer&&clearInterval(tt.timer);tt.timer=setInterval((function(){DOMTip.fade(1)}),10);document.onmousemove=this.pos},pos:function(t){if(tip){if(tip.findPoint){arrowWidth=8;followCursor=!1}else{arrowWidth=0;followCursor=!0}if(target)var i=target.chart,s=i.chartRect,e=!!i.axes.bottom.firstSeries&&!i.axes.bottom.firstSeries.yMandatory;if(i){i.draw();if(i.series.items[0]instanceof Pie||followCursor||!target){var r=document.documentElement,a=ie?t.clientY+r.scrollTop:t.pageY,o=ie?t.clientX+r.scrollLeft:t.pageX-width/2-10-arrowWidth;arrowStyleBefore.innerHTML=".teetiparrow{width:0;height:0;border: "+arrowWidth+"px solid;position: absolute;content: '';border-color: "+domStylesBorderColor+" "+domStylesBorderColor+" transparent transparent;bottom: -"+2*arrowWidth+"px;left: "+(tt.getBoundingClientRect().width-2*arrowWidth-arrowBorderWidth/2)+"px;}";arrowStyleAfter.innerHTML=".teetiparrow:after{content: ' ';position: absolute;width: 0;height: 0;left: -"+(arrowWidth-arrowBorderWidth/2)+"px;bottom: "+(arrowBorderWidth-(arrowWidth-1))+"px; border: "+(arrowWidth-arrowBorderWidth/2)+"px solid;border-color: "+domStylesBackgroundColor+" "+domStylesBackgroundColor+" transparent transparent;}"}else{var n;n=e?Math.round(i.axes.left.fromPos(t.layerY)):Math.round(i.axes.bottom.fromSizeCalcIndex(t.clientX-i.canvas.getBoundingClientRect().left-i.axes.bottom.startPos));var l,c,d=new Point;if(t.target==i.canvas)for(var u=0;u<i.series.items.length;u++){l=e?Math.abs(i.series.items[u].data.values[n]-i.axes.bottom.fromPos(t.layerX)):Math.abs(i.series.items[u].data.values[n]-i.axes.left.fromPos(t.layerY));if(0==u){c=l;i.series.items[u].calc(n,d)}else if(l<c){i.series.items[u].calc(n,d);c=l}}r=document.documentElement;var m=tt.style.marginTop.substring(0,tt.style.marginTop.length-2),f=tt.style.marginLeft.substring(0,tt.style.marginLeft.length-2);a=Math.round(d.y+window.scrollY+i.canvas.getBoundingClientRect().top-tt.getBoundingClientRect().height-arrowWidth-m+arrowBorderWidth/2);if((o=Math.round(d.x+window.scrollX+i.canvas.getBoundingClientRect().left-tt.getBoundingClientRect().width/2-f-arrowBorderWidth/2))+width/2-s.x>s.width){a=Math.round(d.y+window.scrollY+i.canvas.getBoundingClientRect().top-tt.getBoundingClientRect().height-2*arrowWidth-m+arrowBorderWidth/2);o=Math.round(d.x+window.scrollX+i.canvas.getBoundingClientRect().left-tt.getBoundingClientRect().width-f);ttstyle.borderRadius=arrowBorderRadius+"px "+arrowBorderRadius+"px 0px "+arrowBorderRadius+"px";arrowStyleBefore.innerHTML=".teetiparrow{width:0;height:0;border: "+arrowWidth+"px solid;position: absolute;content: '';border-color: "+domStylesBorderColor+" "+domStylesBorderColor+" transparent transparent;bottom: -"+2*arrowWidth+"px;left: "+(tt.getBoundingClientRect().width-2*arrowWidth-arrowBorderWidth/2)+"px;}";arrowStyleAfter.innerHTML=".teetiparrow:after{content: ' ';position: absolute;width: 0;height: 0;left: -"+(arrowWidth-arrowBorderWidth/2)+"px;bottom: "+(arrowBorderWidth-(arrowWidth-1))+"px; border: "+(arrowWidth-arrowBorderWidth/2)+"px solid;border-color: "+domStylesBackgroundColor+" "+domStylesBackgroundColor+" transparent transparent;}"}else if(o-width/2<s.x){o=Math.round(d.x+window.scrollX+i.canvas.getBoundingClientRect().left-f);a=Math.round(d.y+window.scrollY+i.canvas.getBoundingClientRect().top-tt.getBoundingClientRect().height-2*arrowWidth-m+arrowBorderWidth/2);ttstyle.borderRadius=arrowBorderRadius+"px "+arrowBorderRadius+"px "+arrowBorderRadius+"px 0px";arrowStyleBefore.innerHTML=".teetiparrow{width:0;height:0;border: "+arrowWidth+"px solid;position: absolute;content: '';border-color: "+domStylesBorderColor+" transparent transparent "+domStylesBorderColor+";bottom: -"+2*arrowWidth+"px;left: "+(0-arrowBorderWidth/2)+"px;}";arrowStyleAfter.innerHTML=".teetiparrow:after{content: ' ';position: absolute;width: 0;height: 0;left: -"+(arrowWidth-arrowBorderWidth/2)+"px;bottom: "+(arrowBorderWidth-(arrowWidth-1))+"px; border: "+(arrowWidth-arrowBorderWidth/2)+"px solid;border-color: "+domStylesBackgroundColor+" transparent transparent "+domStylesBackgroundColor+";}"}else if(o){ttstyle.borderRadius=arrowBorderRadius+"px "+arrowBorderRadius+"px "+arrowBorderRadius+"px "+arrowBorderRadius+"px";arrowStyleBefore.innerHTML=".teetiparrow{width:0;height:0;border: "+arrowWidth+"px solid;position: absolute;content: '';border-color: "+domStylesBorderColor+" transparent transparent transparent;bottom: -"+2*arrowWidth+"px;left: "+(tt.getBoundingClientRect().width/2-arrowWidth)+"px;}";arrowStyleAfter.innerHTML=".teetiparrow:after{content: ' ';position: absolute;width: 0;height: 0;left: -"+(arrowWidth-arrowBorderWidth/2)+"px;bottom: "+(arrowBorderWidth-(arrowWidth-1))+"px; border: "+(arrowWidth-arrowBorderWidth/2)+"px solid;border-color: "+domStylesBackgroundColor+" transparent transparent transparent;}"}}if(tip&&tip.pointer.visible){!function(){if(t.target.chart){t.target.chart.draw();var s,r,h,a,o=new Point,n=tip.pointer;tip.pointer.fill;s=e?Math.round(i.axes.left.fromPos(t.layerY)):Math.round(i.axes.bottom.fromSizeCalcIndex(t.clientX-i.canvas.getBoundingClientRect().left-i.axes.bottom.startPos));if(t.target==i.canvas)for(var l=0;l<i.series.items.length;l++){r=e?Math.abs(i.series.items[l].data.values[s]-i.axes.bottom.fromPos(t.layerX)):Math.abs(i.series.items[l].data.values[s]-i.axes.left.fromPos(t.layerY));if(0==l){h=r;i.series.items[l].calc(s,o);a=i.series.items[l]}else if(r<h){i.series.items[l].calc(s,o);h=r;a=i.series.items[l]}}var c=t.target.chart.ctx;if(previousNearestSeries){if(-1!=s&&previousNearestSeries!=a){previousNearestSeries=a;n.animationVisible&&x(o,c)}}else previousNearestSeries=a;if(-1!=s&&!previousIndex||-1==s)previousIndex=s;else if(-1!=s&&previousIndex!=s){previousIndex=s;n.animationVisible&&x(o,c)}p(o,n.secondCircleRadius,n.fill,n.secondCircleOpacity,c);p(o,n.firstCircleRadius,n.fill,n.firstCircleOpacity,c)}}();a-=tip.pointer.secondCircleRadius>tip.pointer.firstCircleRadius?tip.pointer.secondCircleRadius:tip.pointer.firstCircleRadius}}else r=document.documentElement,a=ie?t.clientY+r.scrollTop:t.pageY,o=ie?t.clientX+r.scrollLeft:t.pageX-width/2-10-arrowWidth}else{arrowWidth=0;followCursor=!0;r=document.documentElement,a=ie?t.clientY+r.scrollTop:t.pageY,o=ie?t.clientX+r.scrollLeft:t.pageX-width/2-10-arrowWidth;arrowStyleBefore.innerHTML=".teetiparrow{width:0;height:0;border: "+arrowWidth+"px solid;position: absolute;content: '';border-color: "+domStylesBorderColor+" "+domStylesBorderColor+" transparent transparent;bottom: -"+2*arrowWidth+"px;left: "+(tt.getBoundingClientRect().width-2*arrowWidth-arrowBorderWidth/2)+"px;}";arrowStyleAfter.innerHTML=".teetiparrow:after{content: ' ';position: absolute;width: 0;height: 0;left: -"+(arrowWidth-arrowBorderWidth/2)+"px;bottom: "+(arrowBorderWidth-(arrowWidth-1))+"px; border: "+(arrowWidth-arrowBorderWidth/2)+"px solid;border-color: "+domStylesBackgroundColor+" "+domStylesBackgroundColor+" transparent transparent;}"}a-h<0&&(a=h);o<0&&(o=0);if(target){for(var g=target.offsetLeft,v=target;null!=v.offsetParent;){g+=v.offsetLeft;v=v.offsetParent}o>g+target.clientWidth-tt.offsetWidth-25&&(o=g+target.clientWidth-tt.offsetWidth-25)}if(followCursor){ttstyle.top=a-h+"px";ttstyle.left=o+3+"px"}else{ttstyle.top=a+"px";ttstyle.left=o+"px"}function x(t,i){var s=tip.pointer;(animation=new Animation(tip,(function(e){if(e<1){tip.chart.draw();p(t,s.secondCircleRadius*e,s.fill,s.secondCircleOpacity,i);p(t,s.firstCircleRadius*e,s.fill,s.firstCircleOpacity,i)}}))).onstop=function(){tip.chart.draw();p(t,s.secondCircleRadius,s.fill,s.secondCircleOpacity,i);p(t,s.firstCircleRadius,s.fill,s.firstCircleOpacity,i)};animation.duration=s.animationDuration;animation.animate()}function p(t,i,s,e,r){r.strokeStyle=s;r.fillStyle=s;r.globalAlpha=e;r.lineWidth=i;r.beginPath();r.ellipse(t.x,t.y,i/2,i/2,0,0,7,!1);r.stroke()}},fade:function(t){if(97!==alpha&&1===t||0!==alpha&&-1===t){var i=10;97-alpha<10&&1==t?i=97-alpha:alpha<10&&-1==t&&(i=alpha);alpha+=i*t;ttstyle.opacity=.01*alpha;ie&&(ttstyle.filter="alpha(opacity="+alpha+")")}else{clearInterval(tt.timer);if(-1==t){ttstyle.display="none";document.onmousemove=null}}},hide:function(){if(tt){clearInterval(tt.timer);tt.timer=setInterval((function(){DOMTip.fade(-1)}),10);target&&target.chart&&target.chart.draw()}}});class Scroller extends Chart{constructor(t,i){super(t);this.target=i;this.aspect.clip=!1;this.panel.transparent=!0;this.title.visible=!1;var s=this.scroller=new Slider(this);s.useRange=!0;s.thumbSize=100;var e=s.thumb;e.shadow.height=0;e.transparency=.6;e.stroke.fill="black";e.shadow.visible=!1;s.horizontal=!0;this.b=s.bounds;this.b.x=0;this.b.y=0;this.b.width=this.bounds.width;this.b.height=this.bounds.height;s.margin=0;s.lock=!1;this.tools.add(s);var r=this;i.ondraw=function(){s.lock||r.draw()};i.onscroll=function(){var t=this.axes.bottom,i=this.series,s=i.minXValue(),e=i.maxXValue(),r=t.maximum-t.minimum;if(t.minimum<s){t.minimum=s;t.maximum=t.minimum+r}if(t.maximum>e){t.maximum=e;t.minimum=t.maximum-r}};s.onChanging=function(t,s){var e=t.thumbSize*(t.max-t.min)/t.bounds.width*.5,h=i.series,a=h.minXValue(),o=h.maxXValue();s-e<a?s=a+e:s+e>o&&(s=o-e);i.axes.bottom.setMinMax(s-e,s+e);this.lock=!0;window.requestAnimationFrame((function(){i.draw()}));i.draw();this.lock=!1;r.onChanging&&r.onChanging(r,s-e,s+e);return s};s.onDrawThumb=function(t){var e=i.chartRect,h=i.ctx;i.chartRect=s.bounds;i.ctx=s.chart.ctx;function a(t,i){var s={mi:t.minimum,ma:t.maximum,sp:t.startPos,ep:t.endPos};o(t,i);return s}function o(t,i){t.minimum=i.mi;t.maximum=i.ma;t.startPos=i.sp;t.endPos=i.ep;t.scale=(i.ep-i.sp)/(i.ma-i.mi)}var n,l,c=s.bounds,d=i,u=d.series;t.min=u.minXValue();t.max=u.maxXValue();n=a(d.axes.bottom,{sp:c.x,ep:c.x+c.width,mi:t.min,ma:t.max});l=a(d.axes.left,{sp:c.y,ep:c.y+c.height,mi:u.minYValue(),ma:u.maxYValue()});var m,f=.5*(n.mi+n.ma),g=n.ma-n.mi;if(t.position!=f){t.thumbSize=g*t.bounds.width/(t.max-t.min);m=.5*g;r.onChanging&&r.onChanging(r,f-m,f+m);t.position=f}d.series.each((function(t){t.visible&&t.useAxes&&t.draw()}));o(d.axes.bottom,n);o(d.axes.left,l);d.chartRect=e;d.ctx=h}}useRange(t){scroller.useRange=t;this.draw()}invertThumb(t){scroller.invertThumb=t;this.draw()}setBounds(t,i,s,e){this.bounds.x=t;this.bounds.y=i;this.bounds.width=s;this.bounds.height=e;this.b.x=t;this.b.y=i;this.b.width=s;this.b.height=e}}class CheckBox extends Annotation{constructor(t,i,s){super(t);this.transparent=!0;this.text=i;this.checked=s||!0;this.margins.left=10;this.cursor="pointer";this.check=new Format(t);this.check.fill="white";this.chart.canvas.addEventListener("touchstart",(function(){}))}draw(){super.draw(this);var t=this.chart.ctx,i=this.position.x+2,s=.6*this.bounds.height,e=this.position.y+.4*(this.bounds.height-s);this.check.rectangle(i,e,s,s);if(this.checked){t.beginPath();t.moveTo(i+3,e+5);t.lineTo(i+4,e+8);t.lineTo(i+7,e+2);this.check.stroke.prepare();t.stroke()}}onclick(){this.checked=!this.checked;this.onchange&&this.onchange(this);return!0}}class Slider extends Tool{constructor(t,i){super(t);var s=this.thumb=new Format(t);s.round={x:4,y:4};s.stroke.size=.5;s.gradient.visible=!1;s.gradient.direction="leftright";s.shadow.visible=!1;var e=this.back=new Format(t);e.fill="white";e.gradient.visible=!1;e.stroke.fill="darkgrey";e.round={x:4,y:4};var r=this.grip=new Format(t);r.round={x:4,y:4};r.stroke.fill="rgb(20,20,20,1.0)";this.gripSize=3;this.b=this.bounds={x:10,y:10,width:200,height:20};this.transparent=!1;this.margin=16;this.min=0;this.max=100;this.position=void 0===i?50:i;this.useRange=!1;this.thumbSize=8;this.horizontal=!0;this.cursor="pointer";this.delta=0;this.r={};this.chart.canvas.addEventListener("touchstart",(function(t){!0;t.preventDefault()}));this.chart.canvas.addEventListener("touchend",(function(t){!1;t.preventDefault()}))}contains(t,i){return i.x>=t.x&&i.x<=t.x+t.width&&i.y>=t.y&&i.y<=t.y+t.height}thumbRect(t){var i=this.max-this.min,s=i>0?(this.position-this.min)/i:0;if(this.horizontal){t.width=this.thumbSize;t.x=this.b.x+s*this.b.width-.5*t.width;t.y=this.b.y;t.height=this.b.height}else{t.height=this.thumbSize;t.y=this.b.y+s*this.b.height-.5*t.height;t.x=this.b.x;t.width=this.b.width}}gripRect(t){if(this.horizontal){var i=.2*t.height;return{x:t.x-this.gripSize,y:t.y+.5*t.height-i,width:2*this.gripSize,height:2*i}}var s=.2*t.width;return{x:t.x+.5*t.width-s,y:t.y-this.gripSize,width:2*s,height:2*this.gripSize}}draw(){var t=this.horizontal?this.b.height:this.b.width,i=t*this.margin*.01;this.transparent||(this.horizontal?this.back.rectangle(this.b.x,this.b.y+i,this.b.width,t-2*i):this.back.rectangle(this.b.x+i,this.b.y,t-2*i,this.b.height));this.onDrawThumb&&this.onDrawThumb(this);this.thumbRect(this.r);if(this.invertThumb){var s=this.thumb;if(this.horizontal){s.rectangle(this.b.x,this.b.y+i,r.x,this.b.height-2*i);s.rectangle(this.b.x+r.x+r.width,this.b.y+i,this.b.width,this.b.height-2*i)}else{s.rectangle(this.b.x+i,this.b.y,this.b.width-2*i,r.y);s.rectangle(this.b.x+i,this.b.y+r.y+r.height,this.b.width-2*i,this.b.height)}}else this.thumb.rectangle(this.r);if(this.useRange&&this.horizontal){var e=this.gripRect(this.r);this.grip.rectangle(e);e.x+=this.r.width;this.grip.rectangle(e)}}clickAt(t){var i,s=this.horizontal?this.b.x:this.b.y,e=this.horizontal?this.b.width:this.b.height,r=this.max-this.min;(i=this.min+Math.max(0,(t+this.delta-s)*r/e))>this.max&&(i=this.max);if(this.onChanging){var h=this.onChanging(this,i);void 0!==h&&(i=h)}i<this.min?i=this.min:i>this.max&&(i=this.max);this.chart.newCursor=this.cursor;if(this.position!=i){this.position=i;window.requestAnimationFrame((function(){this.chart.draw()}));this.chart.draw()}}resized(){this.onChanging&&this.onChanging(this,this.position);this.chart.draw();this.chart.newCursor="col-resize"}mousemove(t){var i=this.horizontal?this.b.width:this.b.height,s=this.horizontal?t.x:t.y,e=this.max-this.min;this.thumbRect(this.r);if(this.resizeBegin&&s<this.r.x+this.r.width){var r=this.thumbSize,h=this.r.x-s,a=h*e/i*.5;this.thumbSize+=h;this.position-=a;if(this.position<this.min){this.position=this.min;this.thumbSize=r}this.resized()}else if(this.resizeEnd&&s>this.r.x){var o=this.r.x+this.r.width-s,n=o*e/i*.5;this.thumbSize-=o;this.position-=n;this.resized()}else if(this.dragging||this.touchDragging)this.clickAt(s);else{var l=!1;if(this.useRange){var c=this.gripRect(this.r);if(!(l=this.contains(c,t))){c.x+=this.r.width;l=this.contains(c,t)}}l?this.chart.newCursor="col-resize":this.contains(this.r,t)&&(this.chart.newCursor=this.cursor)}}mousedown(t){var i=new Point;i.x=t.x;i.y=t.y;this.thumbRect(this.r);this.chart.calcMouse(t,i);var s=this.gripRect(this.r);this.resizeBegin=this.useRange&&this.contains(s,i);s.x+=this.r.width;this.resizeEnd=this.useRange&&!this.resizeBegin&&this.contains(s,i);this.dragging=!this.resizeBegin&&!this.resizeEnd&&this.contains(this.r,i);if(!this.resizeBegin&&!this.resizeEnd)if(this.dragging)this.delta=this.horizontal?this.r.x+.5*this.r.width-i.x:this.r.y+.5*this.r.height-i.y;else if(this.contains(this.b,i)){var e=this.horizontal?.5*this.r.width:.5*this.r.height;this.delta=-e;this.clickAt(e+(this.horizontal?i.x:i.y))}return this.dragging||this.resizeBegin||this.resizeEnd}clicked(){var t=this.dragging||this.resizeBegin||this.resizeEnd;this.resizeBegin=this.resizeEnd=this.dragging=!1;this.delta=0;return t}mouseout(){this.resizeBegin=this.resizeEnd=this.dragging=!1}}class SeriesAnimation extends Animation{constructor(t){super(t);if(t instanceof Series){this.series=t;this.chart=t.chart}else this.series=null;this.oldmin=0;this.oldmax=0;this.oldauto=!0;this.kind="axis"}static scaling;changeAxis(t,i){t.automatic=!1;var s=.5*(this.oldmin+this.oldmax),e=.5*(this.oldmax-this.oldmin);t.maximum=s+i*e;t.minimum=s-i*e}getAxis(){var t=this.series||this.chart.series.firstVisible();return t?t.mandatoryAxis:null}getOtherAxis(){var t=this.series||this.chart.series.firstVisible();if(!t)return null;if(t.yMandatory){if("both"===t.vertAxis)return this.chart.axes.right}else if("both"===t.horizAxis)return this.chart.axes.top}doStep(t){var i=this.getAxis(),s=this.getOtherAxis();i&&(i.automatic=!1);s&&(s.automatic=!1);if("axis"==this.kind){this.changeAxis(i,1+100*(1-t));s&&this.changeAxis(s,1+100*(1-t))}else this.chart.series.each((i=>{if(!this.series||this.series===i){var s,e=i.data.values,r=i.data._old,h=e.length;if(i instanceof ActivityGauge)i.maxDrawWidth=i.maxWidth*t;else if(i instanceof Pie){i.rotation=360*(1-t);SeriesAnimation.scaling=t}else if("each"==this.kind){var a=trunc(h*t);for(s=0;s<a;s++)e[s]=r[s];a<h&&(e[a]=r[a]*(h*t-a))}else if("all"==this.kind)for(s=0;s<h;s++)e[s]=r[s]*t;else"axis"!=this.kind&&(SeriesAnimation.scaling=t)}}))}stop(){this.doStep(1);var t=this.getAxis(),i=this.getOtherAxis();if(t){t.maximum=this.oldmax;t.minimum=this.oldmin;t.automatic=this.oldauto}if(i){i.maximum=this.oldmax;i.minimum=this.oldmin;i.automatic=this.oldauto}this.chart.series.each((t=>{t.transform&&(t.transform=null);if(("each"==this.kind||"all"==this.kind)&&t.data._old){t.data.values=t.data._old;t.data._old=null}}))}start(){let t,i,s=this.getAxis(),e=this.getOtherAxis(),r=this.chart,h=r.series.items,a=r.chartRect.width,o=r.chartRect.height,n=r.bounds.width,l=r.bounds.height;if(0===h.length)return!1;this.oldmin=s.minimum;this.oldmax=s.maximum;this.oldauto=s.automatic;for(t=0;t<h.length;t++){i=h[t];if(!this.series||this.series===i)if(i instanceof Pie)i.transform=function(){this.chart.ctx.scale(SeriesAnimation.scaling,SeriesAnimation.scaling)};else if("each"==this.kind||"all"==this.kind){var c,d=i.data.values,u=d.length;i.data._old=d.slice(0);for(c=0;c<u;c++)d[c]=0;s.automatic=!1;e&&(e.automatic=!1)}else"left"==this.kind?i.transform=function(){this.chart.ctx.translate(-a*(1-SeriesAnimation.scaling),0)}:"right"==this.kind?i.transform=function(){this.chart.ctx.translate(a*(1-SeriesAnimation.scaling),0)}:"x"==this.kind?i.transform=function(){this.chart.ctx.scale(SeriesAnimation.scaling,1)}:"y"==this.kind?i.transform=function(){this.chart.ctx.scale(1,SeriesAnimation.scaling)}:"top"==this.kind?i.transform=function(){this.chart.ctx.translate(0,-o*(1-SeriesAnimation.scaling))}:"bottom"==this.kind?i.transform=function(){this.chart.ctx.translate(0,o*(1-SeriesAnimation.scaling))}:"zoomin"==this.kind?i.transform=function(){var t=this.chart.ctx;t.translate(.5*n,.5*l);t.scale(SeriesAnimation.scaling,SeriesAnimation.scaling);t.translate(.5*-n,.5*-l)}:"zoomout"==this.kind&&(i.transform=function(){var t=this.chart.ctx;t.translate(.5*n,.5*l);t.scale(2-SeriesAnimation.scaling,2-SeriesAnimation.scaling);t.translate(.5*-n,.5*-l)})}if("axis"==this.kind){this.changeAxis(s,100);e&&this.changeAxis(e,100)}}}class FadeAnimation extends Animation{constructor(t){super(t);var i=this,s=this.fade;this.kind="in";this.fade={};this.setTransp=function(t){"out"==i.kind&&(t=1-t);s.legend&&(i.chart.legend.format.transparency=t);s.walls&&(i.chart.walls.transparency=t);s.series&&i.chart.series.each((function(i){i.format.transparency=t}));s.marks&&i.chart.series.each((function(i){i.marks.transparency=t}));s.title&&(i.chart.title.format.transparency=t);s.axes&&(i.chart.axes.transparency=t);s.panel&&(i.chart.panel.format.transparency=t)};this.start=function(){s=this.fade;this.setTransp(1)};this.stop=function(){this.setTransp(0)};this.doStep=function(t){i.setTransp(1-t)}}}class CircularGauge extends Series{constructor(t,i){super(t,i);this.useAxes=!1;this.min=0;this.max=100;this.step=0;this.value=0;this.angle=280;this.rotation=0;this.rotateText=!1;this.shape="circle";this.drag={enabled:!0};this.bevel=new Format(this.chart);this.bevel.gradient.visible=!0;this.bevel.gradient.colors=["white"];this.bevel.shadow.visible=!1;this.bevel.visible=!1;this.bevel.stroke.fill="";this.center=new Format(this.chart);this.center.stroke.fill="";this.center.gradient.visible=!0;this.center.size=10;this.center.visible=!1;this.center.shadow.visible=!0;this.center.gradient.offset={x:2,y:-2};this.center.location={x:0,y:0};this.center.top=new Format(this.chart);this.center.top.size=40;this.center.top.visible=!0;this.center.top.stroke.fill="";this.center.top.gradient.colors=["silver","white"];this.center.top.gradient.visible=!0;this.center.top.gradient.direction="topbottom";this.ticks=new Format(this.chart);this.ticks.length=6;this.ticks.stroke.fill="silver";this.ticks.visible=!0;this.ticks.outside=!0;this.ticks.triangle=!1;this.ticks.fill="white";this.ticksBack=new Format(this.chart);this.ticksBack.stroke.fill="";this.ticksBack.fill="black";this.ticksBack.gradient.visible=!0;this.ticksBack.gradient.colors=["red","yellow","green"];this.ticksBack.gradient.direction="rightleft";this.ticksBack.visible=!1;this.ticksBack.radius=0;this.minor=new Format(this.chart);this.minor.stroke.fill="silver";this.minor.visible=!0;this.minor.count=4;this.minor.shape="";this.minorBack=new Format(this.chart);this.minorBack.stroke.fill="";this.minorBack.visible=!1;this.minorBack.fill="white";this.minorBack.gradient.visible=!1;this.minorBack.gradient.direction="leftright";this.minorBack.gradient.colors=["green","yellow","red"];this.minorBack.radius=0;this.hands=[];this.hand=this.addHand();this.back=new Format(this.chart);this.back.fill="black";this.back.visible=!0;this.back.gradient.visible=!0;this.back.gradient.colors=["rgba(255,126,95,0.8)","rgba(254,180,123,0.8)"];this.back.stroke.fill="";this.pointer=new Format(this.chart);this.pointer.size=3;this.pointer.fill="black";this.pointer.stroke.fill="";this.pointer.visible=!1;this.marks.location={x:0,y:10};this.marks.visible=!0;this.marks.format.fill="black";this.marks.format.font.fill="black";this.marks.format.gradient.visible=!0;this.marks.format.gradient.colors=["rgba(255,126,95,0.6)","rgba(254,180,123,0.6)"];this.marks.format.shadow.visible=!0;this.marks.format.shadow.blur=8;this.marks.format.shadow.color="black";this.format.visible=!0;this.format.gradient.visible=!0;this.format.gradient.colors=["white"];this.format.shadow.visible=!0;this.format.font.style="12px Verdana";this.format.font.fill="black";this.format.font.visible=!0;this.format.size=2;this.format.round={x:6,y:6};this.format.padding=.5;this.units=new Annotation(this.chart);this.units.transparent=!0;this.units.format.font.fill="black";this.units.location={x:0,y:24};this.bounds=this.getRect();this.hover.enabled=!0;this.oldValue;this.newValue;this.animate=new Animation(this.chart,(function(t){this.value=this.oldValue+t*(this.newValue-this.oldValue);this.chart.draw()}));this.animate.duration=100;this.animate.onstop=function(){this.value=this.newValue;this.onchange&&this.onchange(this);this.chart.draw()};this.tick0=0;this.tick1=0;this.tickMin=0;this.tickText=0;this.initRot=0;this.endRot=0;this.cx=0;this.cy=0;this.cex=0;this.cey=0;this.p={x:0,y:0}}setChart(t,i){super.setChart(t,i);t.back.setChart(i);t.center.setChart(i);t.center.top.setChart(i);t.ticks.setChart(i);t.ticksBack.setChart(i);t.minor.setChart(i);t.minorBack.setChart(i);t.hand.setChart(i);t.units.setChart(i);t.pointer.setChart(i);t.bevel.setChart(i)}addHand(){var t=new Format(this.chart);t.size=6;t.length=60;t.back=20;t.gradient.visible=!0;t.gradient.colors[0]="orange";t.shadow.visible=!0;t.shadow.blur=12;t.shadow.color="black";t.stroke.fill="";t.pointer=!0;t.shape="needle";t.visible=!0;this.hands.push(t);return t}calcBounds(){return this.bounds.custom?this.bounds:this.cellRect(this.bounds,!0)}draw(){var t,i,s=.01745*this.angle,e=this.calcBounds();this.cx=e.x+.5*e.width;this.cy=e.y+.5*e.height;var r=this.cx,h=this.cy;if(this.bounds.custom){t=e.width;i=e.height}else i=t=Math.min(e.width,e.height);var a=this,o=a.chart.ctx,n=1.57,l=t;this.initRot=.01745*a.rotation+.5*(6.283-s);for(;this.initRot>=6.283;)this.initRot-=6.283;this.endRot=this.initRot+s;for(;this.endRot>=6.283;)this.endRot-=6.283;function c(t,i,s,e,r){t.radius>0&&(s=l*t.radius*.01);o.beginPath();o.arc(0,0,i,e,r,!1);o.arc(0,0,s,r,e,!0);t.draw(o,null,-s,-s,2*s,2*s)}this.drawHand=function(e){e.value=this.limitValue(e.value);var r=this.inverted?this.max-e.value+this.min:e.value,h=.01745*this.rotation+.5*(9.4248-s)+s*(r-this.min)/f;this.cex=this.cx+t*this.center.location.x*.005,this.cey=this.cy+i*this.center.location.y*.005;o.save();o.translate(this.cex,this.cey);o.rotate(h);var a=e.size,n=l*e.back*.5*.01,c=Math.min(a,6),d=l*e.length*.5*.01;o.beginPath();if(a>1){o.moveTo(-n+c,-a);if("needle"==e.shape){o.quadraticCurveTo(-n,-a,-n,-a+c);o.lineTo(-n,a-c);o.quadraticCurveTo(-n,a,-n+c,a);o.lineTo(d,0)}else{o.lineTo(-n+c,a);o.lineTo(d,a);o.lineTo(d,-a)}o.closePath()}else{o.moveTo(-n,0);o.lineTo(d,0)}if(a>1)e.draw(o,null,-n,-a,n+d,2*a);else{e.stroke.prepare();o.strokeStyle=e.fill;o.stroke()}this.ondrawHand&&this.ondrawHand(this,e);e.pointer&&this.pointer.visible&&this.pointer.ellipse(.5*(this.tickMin+this.tick1),0,this.pointer.size,this.pointer.size);o.restore()};this.tryBack=function(t,i,s){if(t.visible&&""!==t.fill)if(t.ranges&&t.ranges.length>0){var e,r=n,h=t.fill,o=t.gradient.visible,l=a.max-a.min,d=this.endRot-this.initRot;t.gradient.visible=!1;a.inverted&&(r+=d);for(var u=0;u<t.ranges.length;u++){var m=Math.min(a.max,t.ranges[u].value),f=0===u?m:m-t.ranges[u-1].value+a.min;e=a.inverted?r-d*(f-a.min)/l:r+d*(f-a.min)/l;t.fill=t.ranges[u].fill;""!==t.fill&&(a.inverted?c(t,i,s,e,r):c(t,i,s,r,e));r=e;if(m>=a.max)break}t.fill=h;t.gradient.visible=o}else c(t,i,s,n,n+(this.endRot-this.initRot))};function d(e,l){if(l.visible)if("circle"==a.shape)l.ellipse(r,h,t,i);else if("segment"==a.shape){o.beginPath();var c=a.units.visible?275:240,d=n+.01745*a.rotation+.5*(6.283-.01745*Math.max(c,a.angle)),u=.5*t,m=.5*i;o.arc(r,h,u,d,d+Math.max(.01745*c,s),!1);o.closePath();l.draw(o,null,r-u,h-m,t,i)}else l.rectangle(e.cx-.5*t,e.cy-.5*i,t,i);return l.visible}if(d(this,this.format)){t*=1-.01*this.format.size;i*=1-.01*this.format.size;this.bounds.custom||(l=i=t)}if(d(this,this.bevel)){t*=1-.002*this.format.size;i*=1-.002*this.format.size;this.bounds.custom||(l=i=t)}d(this,this.back);var u=this.ticks.outside,m=this.min,f=this.max-this.min,g=this.step;0===g&&(g=f/20);g=Math.max(.1,g);this.tick1=u?.48*l:.41*l,this.tick0=this.tick1-l*(.01*this.ticks.length),this.tickText=u?.39*l:this.rotateText?.46*l:.48*l,this.tickMin=u?.45*l:.38*l;this.format.font.prepare();function v(t){return 0|t}var x=this.format.textHeight("Wj"),p=f/g,w=Math.max(1,v(p/(l*s/6.283/x)));o.fillStyle=this.format.font.fill;o.save();var b=this.cx,y=this.cy;a.bounds.custom&&(t>i?y+=.75*i*i/t:b+=.75*t*t/i);o.translate(b,y);o.rotate(this.initRot);this.tryBack(this.ticksBack,this.tick0,this.tick1);this.tryBack(this.minorBack,this.tickMin,this.tick1);function k(t,i,s){return t.enabled&&t.valid&&Math.abs(i-t.value)<s?t:null}var S=g*s/f/this.minor.count,z=this.initRot,A=this.rotateText?0:.3*this.format.textHeight("Wj"),M=0;!this.ticks.visible&&u&&(this.tickText=.9*this.tickMin);for(;m<=this.max;){if(this.ticks.visible){var T=k(this.hover,m,.2*g)||this.ticks;o.beginPath();o.moveTo(0,this.tick0);if(this.ticks.triangle){o.lineTo(-3,this.tick1);o.lineTo(3,this.tick1);o.closePath();T.draw(o,-3,this.tick0,3,this.tick1)}else{o.lineTo(0,this.tick1);T.stroke.prepare();o.stroke()}}if(this.format.font.visible&&M%w==0&&(360!=this.angle||m+g<=this.max)){var P=this.tickText-this.format.textHeight()*this.format.padding;o.translate(0,P);var C=this.rotateText?3.1416:z;o.rotate(-C);this.format.font.prepare();o.fillStyle=this.format.font.fill;var B,R=a.inverted?this.max-m+this.min:m;B=a.ongetText?a.ongetText(R):v(R)==R?R.toFixed(0):R.toFixed(this.decimals);o.fillText(B,0,A);o.rotate(C);o.translate(0,-P)}if(this.minor.visible){if(m<this.max)for(var W=0;W<this.minor.count;W++){o.rotate(S);if(W<this.minor.count-1){var V=g/this.minor.count,_=m+(W+1)*V,D=k(this.hover,_,.2*V)||this.minor;if(_>this.max)break;if("ellipse"==this.minor.shape)this.minor.ellipse(0,.5*(this.tickMin+this.tick1),this.minor.size,this.minor.size);else{o.beginPath();o.moveTo(0,this.tickMin);o.lineTo(0,this.tick1);D.stroke.prepare();o.stroke()}}}}else o.rotate(S*this.minor.count);z+=S*this.minor.count;m+=g;M++}o.restore();if(this.marks.visible){this.marks.text=this.value.toFixed(this.decimals);this.marks.resize();this.marks.position.x=this.cx-.5*this.marks.bounds.width+this.marks.location.x*t*.01;this.marks.position.y=this.cy+this.marks.location.y*i*.01;this.marks.draw()}var L=this.units;if(L.visible){L.resize();L.position.x=this.cx-.5*L.bounds.width+L.location.x*t*.01;L.position.y=this.cy+L.location.y*i*.01;L.draw(o)}o.save();this.hand.value=this.value;for(var F=0;F<this.hands.length;F++)this.hands[F].visible&&this.drawHand(this.hands[F]);o.restore();if(this.center.visible){var O=l*this.center.size*.01;this.center.ellipse(this.cex,this.cey,O,O);if(this.center.top.visible){var H=O*this.center.top.size*.01;this.center.top.ellipse(this.cex,this.cey,H,H)}}}limitValue(t){return Math.min(this.max,Math.max(this.min,t))}setValue(t){t=this.limitValue(t);var i=this.value!=t;if(i)if(this.animate.active&&this.animate.duration>0){this.oldValue=this.value;this.newValue=t;this.animate.animate(this.chart)}else{this.value=t;this.onchange&&this.onchange(this)}return i}onclick(){}clicked(){this.dragging=!1;return-1}inValue(t,i){if(!i.contains(t))return!1;for(var s,e,r,h=t.x-this.cex,a=t.y-this.cey,o=Math.sqrt(h*h+a*a),n=Math.atan2(a,h)-.5*Math.PI;n<0;)n+=6.283;if(this.initRot>this.endRot){s=this.endRot;r=n>=(e=this.initRot)||n<=s}else{e=this.endRot;r=n>=(s=this.initRot)&&n<=e}if(r){var l;l=this.initRot>this.endRot?n>e?(n-e)/(6.283-e+s):(6.283-e+n)/(6.283-e+s):(n-s)/(e-s);var c=this.min+(this.max-this.min)*l;this.inverted&&(c=this.min+(this.max-this.min)*(1-l));t.value=c;t.inTicks=o>=Math.min(this.tick0,this.tickText)&&o<=this.tick1;return!0}t.inTicks=!1;return!1}#t(t,i){if(t.hover.value!=i){t.hover.value=i;t.hover.valid=null!==i;requestAnimationFrame((function(){t.chart.draw()}))}}mousemove(t){var i=this.calcBounds(),s=this.inValue(t,i);if(this.dragging||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&this.drag.enabled){s&&this.setValue(t.value)&&this.chart.draw();this.chart.newCursor="pointer"}else if(t.inTicks&&this.drag.enabled){this.#t(this,t.value);this.chart.newCursor="pointer"}else this.#t(this,null)}mousedown(t){if(this.drag.enabled){var i=this.calcBounds();this.chart.calcMouse(t,this.p);if(this.inValue(this.p,i)){this.dragging=!0;this.hover.value=null;this.hover.valid=!1;this.setValue(this.p.value)&&this.chart.draw()}else this.dragging=!1;return this.dragging}return!1}}class NumericGauge extends Series{constructor(t,i){super(t,i);this.useAxes=!1;this.legend.visible=!1;this.step=0;this.value=0;this.unit="Mhz";this.angle=280;this.rotation=0;this.rotateText=!1;this.shape="rectangle";this.drag={enabled:!0};this.bevel=new Format(this.chart);this.bevel.gradient.visible=!0;this.bevel.gradient.colors=["white"];this.bevel.shadow.visible=!1;this.bevel.visible=!1;this.bevel.stroke.fill="";this.center=new Format(this.chart);this.center.stroke.fill="";this.center.gradient.visible=!0;this.center.size=10;this.center.visible=!1;this.center.shadow.visible=!0;this.center.gradient.offset={x:2,y:-2};this.center.location={x:0,y:0};this.center.top=new Format(this.chart);this.center.top.size=40;this.center.top.visible=!0;this.center.top.stroke.fill="";this.center.top.gradient.colors=["silver","white"];this.center.top.gradient.visible=!0;this.center.top.gradient.direction="topbottom";this.ticks=new Format(this.chart);this.ticks.length=6;this.ticks.stroke.fill="silver";this.ticks.visible=!0;this.ticks.outside=!0;this.ticks.triangle=!1;this.ticks.fill="white";this.ticksBack=new Format(this.chart);this.ticksBack.stroke.fill="";this.ticksBack.fill="black";this.ticksBack.gradient.visible=!0;this.ticksBack.gradient.colors=["red","yellow","green"];this.ticksBack.gradient.direction="rightleft";this.ticksBack.visible=!1;this.ticksBack.radius=0;this.minor=new Format(this.chart);this.minor.stroke.fill="silver";this.minor.visible=!0;this.minor.count=4;this.minor.shape="";this.minorBack=new Format(this.chart);this.minorBack.stroke.fill="";this.minorBack.visible=!1;this.minorBack.fill="white";this.minorBack.gradient.visible=!1;this.minorBack.gradient.direction="leftright";this.minorBack.gradient.colors=["green","yellow","red"];this.minorBack.radius=0;this.back=new Format(this.chart);this.back.fill="white";this.back.visible=!0;this.back.gradient.visible=!1;this.back.gradient.colors=["rgba(255,126,95,0.8)","rgba(254,180,123,0.8)"];this.back.stroke.fill="black";this.back.stroke.visible=!0;this.pointer=new Format(this.chart);this.pointer.size=3;this.pointer.fill="black";this.pointer.stroke.fill="";this.pointer.visible=!1;this.marks.format.fill="black";this.marks.format.font.fill="black";this.marks.format.gradient.visible=!0;this.marks.format.gradient.colors=["rgba(255,126,95,0.6)","rgba(254,180,123,0.6)"];this.marks.format.shadow.visible=!0;this.marks.format.shadow.blur=8;this.marks.format.shadow.color="black";this.format.visible=!0;this.format.gradient.visible=!0;this.format.gradient.colors=["white"];this.format.shadow.visible=!0;this.format.font.style="12px Verdana";this.format.font.fill="black";this.format.font.visible=!0;this.format.size=2;this.format.round={x:6,y:6};this.format.padding=0;this.units=new Annotation(this.chart);this.units.transparent=!0;this.units.format.font.fill="black";this.units.location={x:0,y:24};this.bounds=this.getRect();this.markers=[];this.addValueMarker=function(t,i){let s=new Annotation(t);s.absPos=!1;s.format.fill="white";s.format.font.fill="black";s.format.font.style="60px Arial";s.format.stroke.color="white";s.text=i;s.position.x=50;s.position.y=50;s.visible=!0;this.markers.push(s);return s};this.valueMarker=this.addValueMarker(this.chart,this.value);this.addUnitsMarker=function(t,i){let s=new Annotation(t);s.absPos=!1;s.format.fill="white";s.format.font.fill="black";s.format.font.style="30px Arial";s.format.stroke.color="white";s.text=i;s.position.x=10;s.position.y=85;s.visible=!0;this.markers.push(s);return s};this.unitsMarker=this.addUnitsMarker(this.chart,this.unit);this.unitsMarker.format.font.textAlign="left";this.hover.enabled=!0;this.oldValue;this.newValue;this.animate=new Animation(this.chart,(function(t){this.value=this.oldValue+t*(this.newValue-this.oldValue);this.chart.draw()}));this.animate.duration=100;this.animate.onstop=function(){this.value=newValue;this.onchange&&this.onchange(this);this.chart.draw()};this.tick0;this.tick1;this.tickMin;this.tickText;this.initRot;this.endRot;this.cx;this.cy;this.cex;this.cey;this.p={x:0,y:0}}calcBounds(){return this.bounds.custom?this.bounds:this.cellRect(this.bounds,!0)}draw(){let t=this,i=t.chart.ctx;i.clearRect(0,0,t.chart.width,t.chart.height);this.calcBounds();this.getOffsetLeft=function(t){if(t){for(var i=t.offsetLeft,s=t;null!=s.offsetParent;){i+=s.offsetLeft;s=s.offsetParent}return i}};this.getOffsetTop=function(t){if(t){for(var i=t.offsetTop,s=t;null!=s.offsetParent;){i+=s.offsetTop;s=s.offsetParent}return i}};this.drawMarker=function(t){if(t.visible){t==this.valueMarker?t.text=this.value:t==this.unitsMarker&&(t.text=this.unit);var s;if(null!=this.chart){t.chart=this.chart;t.format.chart=this.chart}let e=0,r=0;s=t.absPos?{x:t.position.x,y:t.position.y}:{x:this.chart.bounds.width*t.position.x/100,y:this.chart.bounds.height*t.position.y/100};if(t==this.valueMarker||t==this.unitsMarker){i.save();i.font=t.format.font.style;if("center"==t.format.font.textAlign){e=t.format.textWidth(t.text)/3;r=t.format.textHeight("W")/3}i.fillStyle=t.format.font.fill;let h=s.x+this.getOffsetLeft(i.canvas)-e;i.fillText(t.text,h,s.y-r);i.restore()}else{i.save();i.font=t.format.font.style;i.fillStyle=t.format.font.fill;let e=t.position.x,r=t.position.y;if(!t.absPos){t.position.x=s.x;t.position.y=s.y}t.draw();if(!t.absPos){t.position.x=e;t.position.y=r}i.restore()}}};!function(t){if(t.back.visible){i.save();i.fillStyle=t.back.fill;i.fillRect(0,0,t.chart.bounds.width,t.chart.bounds.height);i.restore()}}(this);this.markers.forEach((t=>this.drawMarker(t)))}setValue(t){var i=this.value!=t;if(i)if(this.animate.active&&this.animate.duration>0){oldValue=this.value;newValue=t;this.animate.animate(this.chart)}else{this.value=t;this.onchange&&this.onchange(this)}this.valueMarker.text=t.toFixed();return i}onclick(){}clicked(){this.dragging=!1;return-1}inValue(t,i){if(!i.contains(t))return!1;for(var s,e,r,h=t.x-this.cex,a=t.y-this.cey,o=Math.sqrt(h*h+a*a),n=Math.atan2(a,h)-.5*Math.PI;n<0;)n+=6.283;if(this.initRot>this.endRot){s=this.endRot;r=n>=(e=this.initRot)||n<=s}else{e=this.endRot;r=n>=(s=this.initRot)&&n<=e}if(r){initRot>endRot?n>e?(n-e)/(6.283-e+s):(6.283-e+n)/(6.283-e+s):(n-s)/(e-s);t.value=v;t.inTicks=o>=Math.min(tick0,tickText)&&o<=tick1;return!0}t.inTicks=!1;return!1}changeHover(t,i){if(t.hover.value!=i){t.hover.value=i;t.hover.valid=null!==i;requestAnimationFrame((function(){t.chart.draw()}))}}mousemove(t){var i=this.calcBounds(),s=this.inValue(t,i);if(this.dragging||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&this.drag.enabled){s&&this.setValue(t.value)&&this.chart.draw();this.chart.newCursor="pointer"}else if(t.inTicks&&this.drag.enabled){changeHover(this,t.value);this.chart.newCursor="pointer"}else this.changeHover(this,null)}mousedown(t){if(this.drag.enabled){var i=this.calcBounds();this.chart.calcMouse(t,this.p);if(this.inValue(this.p,i)){this.dragging=!0;this.hover.value=null;this.hover.valid=!1;this.setValue(p.value)&&this.chart.draw()}else this.dragging=!1;return this.dragging}return!1}setChart(t,i){super.setChart(t,i);this.chart.panel.margins.bottom=0;this.chart.panel.margins.right=0;this.chart.panel.margins.top=0;this.chart.panel.margins.left=0;t.back.setChart(i);t.center.setChart(i);t.center.top.setChart(i);t.ticks.setChart(i);t.ticksBack.setChart(i);t.minor.setChart(i);t.minorBack.setChart(i);t.units.setChart(i);t.pointer.setChart(i);t.bevel.setChart(i)}}class Clock extends Chart{constructor(t,i){super(t);let s=this;s.panel.transparent=!0;s.title.visible=!1;let e=this.gauge=s.addSeries(new CircularGauge);e._romans=["","I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"];var r=e.minutes=e.addHand();r.size=4;r.value=4;r.length=75;r.pointer=!1;var h=e.seconds=e.addHand();h.size=0;h.value=9;h.length=80;e.drag.enabled=!1;e.center.visible=!1;e.hand.pointer=!1;e.min=0;e.max=12;e.step=1;e.rotation=180;e.angle=360;e.ticksBack.gradient.visible=!1;e.marks.visible=!1;e.units.location.y=10;e.minor.count=5;e.ongetText=function(t){0==t&&(t=12);return e.romans?e._romans[t]:t.toFixed(0)};this.setTime=function(){var t=new Date,i=t.getHours(),s=t.getMinutes(),r=t.getSeconds();e.seconds.value=.2*r;e.minutes.value=.2*s+r/300;var h=i>12?i-12:i;e.value=h+s/60;if(!e.units.custom){var a=(e.ampm?h:i)+":"+(s<10?"0"+s:s)+":"+(r<10?"0"+r:r)+" ";e.ampm&&(a+=i>11?"PM":"AM");e.units.text=a}};e.tick=function(){s.setTime();s.draw();window.setTimeout(e.tick,1e3,e)};switch(i){case 1:e.ticks.stroke.fill="black";e.minor.stroke.fill="gray";e.format.padding=.25;e.minor.shape="ellipse";e.minor.fill="blue";e.hand.length=50;break;case 2:e.format.size=10;e.back.gradient.colors=["silver","white","silver"];e.back.gradient.direction="radial";e.hand.gradient.colors=["white","silver"];e.hand.stroke.fill="silver";e.hand.shape="rect";e.hand.size=3;e.hand.length=50;e.format.padding=.2;e.format.font.fill="black";e.format.shadow.width=0;e.format.shadow.height=0;e.format.shadow.blur=10;e.minutes.shape="rect";e.minutes.size=2;e.minutes.gradient.colors=["white","silver"];e.minutes.stroke.fill="silver";e.minutes.length=60;e.center.visible=!0;e.center.size=4;e.center.top.visible=!1;e.center.gradient.colors=["black"];e.seconds.fill="black";e.bevel.gradient.colors=["white","gray","white"];e.ticksBack.visible=!1;e.ticks.stroke.fill="black";e.ticks.length=3;e.ticks.stroke.size=2;e.minor.stroke.fill="gray";e.units.custom=!0;e.units.text="Quartz";e.units.location.y=15;e.units.format.font.fill="black";break;case 3:s.panel.transparent=!1;s.panel.format.stroke.fill="#DBB887";s.panel.format.gradient.colors=["#EEDCC3","#B2936C"];e.back.gradient.colors=["#EEDCC3","#B2936C"];e.format.font.style="16px Impact";e.format.font.fill="#433728";e.format.padding=.2;e.format.visible=!1;e.bevel.visible=!1;e.units.format.font.fill="black";e.units.location.y=-20;e.units.visible=!1;e.seconds.visible=!1;e.seconds.fill="black";e.ticksBack.visible=!1;e.hand.size=3;e.hand.back=3;e.hand.gradient.colors=["#433728","#856E51"];e.minor.count=10;e.minutes.size=2;e.minutes.back=6;e.minutes.gradient.colors=["#433728","#856E51"]}}}export{Scroller,Slider,CheckBox,Point,Rectangle,Margins,Tool,Animation,AnimateHover,Gradient,Shadow,ChartImage,Stroke,Font,Format,Annotation,DragTool,CursorTool,ToolTip,Tools,Palette,Zoom,Scroll,AxisTitle,Panel,Wall,Labels,Grid,Ticks,ChartTitle,Axis,Symbol,Legend,Marks,Series,SeriesList,Axes,Chart,CustomBar,Bar,HorizBar,Bullet,Pointer,CustomSeries,Line,PointXY,Pie,Area,HorizArea,Donut,ActivityGauge,Gantt,Bubble,Volume,Candle,Polar,PaletteSeries,SeriesAnimation,FadeAnimation,CircularGauge,NumericGauge,Clock,DOMTip};
